TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

                                                                     PAGE    1

       1                            .FILE   "NARCPLAY.ASM"
       3                    
       4                    **************************************************************************
       5                    *                                                                        *
       6                    *       COPYRIGHT (C) 1988 WILLIAMS ELECTRONICS GAMES, INC.              *
       7                    *       ALL RIGHTS RESERVED.                                             *
       8                    *                                                                        *
       9                    **************************************************************************
      10                    
      11                            .WIDTH  132
      12                            .OPTION B,D,L
      13                            .MNOLIST        
      14                    
      15                    *       GET THE SYSTEM STUFF
      16                            .INCLUDE        "\video\MPROCEQU.ASM"   ;MPROC equates
      17                            .INCLUDE        "\video\DISPEQU.ASM"    ;Display processor equates
      18                            .INCLUDE        "\video\GSP.INC"        ;GSP assembler equates
      19                            .INCLUDE        "\video\SYS.INC"        ;Zunit system equates
      20                            .INCLUDE        "\video\MACROS.HDR"     ;Macros, Yeah!
      21                    *       LOCAL STUFF
      22                            .INCLUDE        "NARCEQU.ASM"           ;NARC Equates
      23                            .INCLUDE        "NARCAUDN.ASM"          ;NARC Audit Equates
      24                    
      25                    *
      26                    *GLOBALS IN THIS FILE
      27                            .GLOBAL STARTINVL,CKLXBND,CKLBADJ,P_INBNDS
      28                    *
      29                    *EXTERNALS
      30                            .GLOBAL jtdrive1,jtdrive4,jtdrive5,jtpassen1,jtpassen4,jtpassen5
      31                            .GLOBAL ylsw4,ytsstdrst,jlsw4,jtsstdrst,jrpilohit,jrhelphit
      32                            .GLOBAL jrpilot,jrhelpas
      33                            .GLOBAL HEADBUTT,PLEGON,PLEGOFF,PTORSON
      34                            .GLOBAL PPOSADDX,ESCAPEJ,INVINCO,INVINCNF,PXFERCRD
      35                            .GLOBAL PFLYNDIE,PFLASH2,PLAYERCON,PIJDECEL,PDELETE
      36                            .GLOBAL GET_ADJ,INIBTIME,DECBTIME,INIBMESS,CLRBTIME,CLRBMESS
      37                            .GLOBAL BUYINWIN,BUYINLP
      38                            
      39 00000000                   .EVEN
      40 00000000                   .TEXT                                                            
      41                    
      42 00000000           P1LLINIT
      43 00000000     098f          MMTM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13
         00000010     fffc  
      44 00000020     5600          CLR     A0
      45 00000030     0580          MOVE    A0,@P1CTRL,W
         00000040 00000000! 
      46 00000060     09e2          MOVI    P1DATA,A2
         00000070 00000000! 
      47 00000090     09e4          MOVI    P1SCRAD,A4
         000000a0 00070046  
      48 000000c0     09e6          MOVI    P1MAINTL,A6
         000000d0 00000000! 
      49 000000f0     09ee          MOVI    P1INITTL,A14
         00000100 000021b0' 
      50 00000120     c015          JRUC    PLLINTIN
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    2

      51                    **************************************************************************
      52                    *                                                                        *
      53                    * P2LLINIT - PLAYER 2 SPECIFIC INITIALIZATION                            *
      54                    *                                                                        *
      55                    **************************************************************************
      56 00000130           P2LLINIT
      57 00000130     098f          MMTM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13
         00000140     fffc  
      58 00000150     5600          CLR     A0
      59 00000160     0580          MOVE    A0,@P2CTRL,W
         00000170 00000000! 
      60 00000190     09e2          MOVI    P2DATA,A2
         000001a0 00000000! 
      61 000001c0     09e4          MOVI    P2SCRAD,A4
         000001d0 0007019b  
      62                    **      MOVI    P2MAINTL,A6
      63 000001f0     09e6          MOVI    P1MAINTL,A6
         00000200 00000000! 
      64 00000220     09ee          MOVI    P2INITT,A14
         00000230 00002430' 
      65 00000250     c002          JRUC    PLLINTIN
      66                    **************************************************************************
      67                    *                                                                        *
      68                    * PLLINIT - PLAYER INITIALIZATION W/LEGS SEPERATE                        *
      69                    * A1=BASE I.D. FOR PLAYER PROCESSES                                      *
      70                    * A2=PLAYER DATA STRUCTURE PTR                                           *
      71                    * A6=PLAYER MAIN ANIMATION TABLE                                         *
      72                    * A14=PLAYER OBJECT INIT TABLE                                           *
      73                    * RETURNS:                                                               *
      74                    * Z BIT SET = FAILURE                                                    *
      75                    * Z BIT CLR = SUCCESS                                                    *
      76                    *                                                                        *
      77                    **************************************************************************
      78 00000260           PLLINIT
      79                    *MAKE SURE A13 IS THE LAST REGISTER PUSHED HERE!
      80 00000260     098f          MMTM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13
         00000270     fffc  
      81 00000280           PLLINTIN
      82                    *PUT ADJUSTMENTS HERE
      83 00000280                   ADJUST  ADJLIVES
      84                    ****    MOVI    ILIVES,A0               ;GET INITIAL # OF LIVES
      85 000002d0     b002          MOVE    A0,*A2(PLIVES),W        
         000002e0     02b0  
      86 000002f0     09c1          MOVI    IENERGY,A1              ;GET THE INITIAL # OF PLAYER LIVES
         00000300     0023  
      87 00000310     2601          SLL     16,A1                   ;8 BIT INTEGER:8 BIT FRACTION
      88 00000320     b222          MOVE    A1,*A2(PENERGY),L       ;STORE IT       
         00000330     01c0  
      89 00000340     09c0          MOVI    NENERGY,A0              ;GET THE SCALE SIZE
         00000350     0064  
      90 00000360     5a01          DIVU    A0,A1                   ;GET THE UNIT SIZE
      91 00000370     b222          MOVE    A1,*A2(PENRGSIZ),L
         00000380     01f0  
      92                    
      93 00000390                   ADJUST  ADJROCKS
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    3

      94 000003e0     b441          MOVE    *A2(PROCKETS),A1,W
         000003f0     01e0  
      95 00000400     4001          ADD     A0,A1                   ;ADD MORE ROCKETS
      96 00000410     b022          MOVE    A1,*A2(PROCKETS),W      ;STORE INITIAL ROCKETS
         00000420     01e0  
      97                    
      98 00000430     b440          MOVE    *A2(PBULLETS),A0,W
         00000440     0250  
      99 00000450     0b00          ADDI    IBULLETS,A0             ;AND SOME BULLETS
         00000460     0064  
     100 00000470     b002          MOVE    A0,*A2(PBULLETS),W      ;STORE INITIAL BULLETS
         00000480     0250  
     101                    
     102                    ***** END OF ADJUSTMENTS
     103                    
     104 00000490     5600          CLR     A0
     105 000004a0     b002          MOVE    A0,*A2(PBULLONS),W      
         000004b0     0260  
     106 000004c0     b002          MOVE    A0,*A2(PROCKONS),W
         000004d0     0290  
     107                    ***     MOVE    A0,*A2(PSCORE),L        ;CLEAR THE SCORE
     108                    ***     MOVE    A0,*A2(PDRUGS),W        ;AND THE BONUSES
     109                    ***     MOVE    A0,*A2(PMONEY),W
     110                    ***     MOVE    A0,*A2(PBUSTS),W
     111                    ***     MOVE    A0,*A2(PCARDS),L
     112                    ***     MOVE    A0,*A2(PCARDS1),L
     113                    
     114                    *LOAD BASE WALKING VELOCITIES
     115 000004e0     09e0          MOVI    PWXVEL,A0
         000004f0 00010000  
     116 00000510     b202          MOVE    A0,*A2(PXVEL),L
         00000520     0350  
     117 00000530     09e0          MOVI    PWYVEL,A0
         00000540 00010000  
     118 00000560     b202          MOVE    A0,*A2(PYVEL),L
         00000570     0370  
     119                    
     120 00000580     1860          MOVK    STANDLEG,A0
     121 00000590     0d3f          CALLR   LOADLTAB                ;SET UP INITIAL ANIMATION TABLE
         000005a0     08df  
     122 000005b0     1880          MOVK    RESTORSO,A0
     123 000005c0     0d5f          CALLA   LOADATAB
         000005d0 00000000! 
     124                    
     125                    *INITIALIZE PLAYER PALETTE
     126 000005f0     0d5f          CALLA   GPALOBJ
         00000600 00000000! 
     127 00000620     4c08          MOVE    A0,A8                   ;PTR FOR INSERTION TO DATA BLOCK
     128 00000630     cb04          JRNZ    PLLTOROK
     129 00000640                   PULL    A13
     130 00000660     c000          JRUC    PLLINITX
         00000670     01af  
     131 00000680           PLLTOROK
     132 00000680     0d5f          CALLA   GETOBJ
         00000690 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    4

     133 000006b0     cb0f          JRNE    PLLEGCR                 ;LEGS O.K.
     134                    *ERROR'D ON LEGS HERE
     135 000006c0     05a0          MOVE    @CURPAL,A0,W
         000006d0 00000000! 
     136 000006f0     0d5f          CALLA   FREEPAL
         00000700 00000000! 
     137 00000720     4d00          MOVE    A8,A0
     138 00000730     0d5f          CALLA   FREEOBJ                 ;FREE ALL AND EXIT
         00000740 00000000! 
     139 00000760     5708          CLR     A8
     140 00000770                   PULL    A13
     141 00000790     c000          JRUC    PLLINITX
         000007a0     019c  
     142 000007b0           PLLEGCR
     143 000007b0     4c04          MOVE    A0,A4                   ;KEEP LEG OBJECT HERE
     144 000007c0     5663          CLR     A3                      ;CLEAR LEG TICKS
     145 000007d0     56a5          CLR     A5                      ;CLEAR TICKS
     146 000007e0     56e7          CLR     A7                      ;CLEAR SWITCHES
     147                    
     148 000007f0     09e9          MOVI    [MINVINC,0],A9          ;START INVINCIBLE INITIALLY
         00000800 00100000  
     149                    **      CLR     A9                      ;CLEAR FLAGS
     150                    
     151 00000820     578c          CLR     A12                     ;AND Y DECEL
     152 00000830     0b02          ADDI    PALDEND,A2              ;OFFSET TO END OF INITIALIZED DATA
         00000840     0160  
     153 00000850     0982          MMTM    A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13 ;STUFF THE DATA BLOCK
         00000860     1ffc  
     154 00000870                   PULL    A13                     ;GET THIS DUDE BACK
     155                    
     156                    *INITIALIZE THE PLAYERS OBJECT BLOCK
     157 00000890     0d5f          CALLA   STFOBJ                  ;SET UP THE LEGS
         000008a0 00000000! 
     158 000008c0     0d5f          CALLA   SETZPOS                 ;SET Z BASED ON THE FEET
         000008d0 00000000! 
     159 000008f0     4d00          MOVE    A8,A0
     160 00000900     0d5f          CALLA   STFOBJ                  ;STUFF THE TORSO OBJECT
         00000910 00000000! 
     161 00000930     b681          MOVE    *A4(OZVAL),A1,L         ;MATCH THE FOOT Z POSITION
         00000940     00c0  
     162 00000950     1021          INC     A1                      ;TORSO ALWAYS ON TOP
     163 00000960     b220          MOVE    A1,*A0(OZVAL),L
         00000970     00c0  
     164                    
     165 00000980     05a6          MOVE    @GAMSTATE,A6,W
         00000990 00000000! 
     166 000009b0     0b46          CMPI    ININTRO,A6
         000009c0     ffe7  
     167 000009d0     ca00          JREQ    PLLINI4                 ;BR = JUST INSERT AND DIE
         000009e0     0159  
     168 000009f0     0b46          CMPI    INAMODE,A6
         00000a00     ffcf  
     169 00000a10     ca00          JREQ    PLLINIST                ;BR = JUST PUT HIM OUT THERE
         00000a20     014a  
     170 00000a30     0b46          CMPI    INGAME,A6
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    5

         00000a40     ffef  
     171 00000a50     ca00          JREQ    PLLINITX                ;BR = SOMEONE ELSE WILL HANDLE INSERTION
         00000a60     0170  
     172 00000a70     0b46          CMPI    INMSU,A6
         00000a80     ffe5  
     173 00000a90     ca00          JREQ    PLLINITX                ;BR = SOMEONE ELSE WILL HANDLE INSERTION
         00000aa0     016c  
     174                    
     175 00000ab0     b500          MOVE    *A8(OID),A0,W
         00000ac0     01a0  
     176 00000ad0     0b00          ADDI    PLACEID,A0
         00000ae0     0010  
     177 00000af0     09e1          MOVI    ENEMIES,A1
         00000b00 00000000! 
     178 00000b20     4c2e          MOVE    A1,A14
     179 00000b30     0d5f          CALLA   ISSUPPID
         00000b40 00000000! 
     180 00000b60     cb08          JRNE    PLLCOUT                 ;BR = SITTING IN CAR. JUST JUMP OUT
     181 00000b70     09e1          MOVI    CARLIST,A1
         00000b80 00000000! 
     182 00000ba0     4c2e          MOVE    A1,A14
     183 00000bb0     0d5f          CALLA   ISSUPPID
         00000bc0 00000000! 
     184 00000be0     ca76          JREQ    PLLTRAN                 ;COME IN BY VEHICLE
     185                    *RELEASE PLAYER FROM INTRO VEHICLE HERE
     186 00000bf0           PLLCOUT
     187 00000bf0     4c2c          MOVE    A1,A12                  ;KEEP PLACEHOLDER OBJECT
     188 00000c00     4c20          MOVE    A1,A0
     189 00000c10     4dc1          MOVE    A14,A1
     190 00000c20     0d5f          CALLA   DELSUPP                 ;DELETE IT FROM THE CORRECT SUP LIST
         00000c30 00000000! 
     191 00000c50     b780          MOVE    *A12(OPLINK),A0,L       
         00000c60     01f0  
     192 00000c70     4c0b          MOVE    A0,A11
     193 00000c80     0d5f          CALLA   GETA10                  ;GET THE CAR PTR
         00000c90 00000000! 
     194                    
     195 00000cb0     05a6          MOVE    @PUPDATE,A6,W
         00000cc0 00000000! 
     196 00000ce0     1825          MOVK    1,A5
     197 00000cf0     0585          MOVE    A5,@PUPDATE,W
         00000d00 00000000! 
     198 00000d20     b445          MOVE    *A2(PIRQFLAG),A5,W
         00000d30     0080  
     199 00000d40     0ba5          ORI     MDRIVER,A5
         00000d50 00000800  
     200 00000d70     b0a2          MOVE    A5,*A2(PIRQFLAG),W
         00000d80     0080  
     201 00000d90     56a5          CLR     A5
     202 00000da0     0785          MOVE    A5,@PLAYCAR,L
         00000db0 00000000! 
     203 00000dd0     0586          MOVE    A6,@PUPDATE,W
         00000de0 00000000! 
     204                    
     205 00000e00     0b62          CMPI    P1DATA,A2
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    6

         00000e10 ffffffff! 
     206 00000e30     cb04          JRNE    PLLINIP2
     207 00000e40     09e9          MOVI    P1CTRL,A9
         00000e50 00000000! 
     208 00000e70     c003          JRUC    PLLINIPG
     209 00000e80           PLLINIP2
     210 00000e80     09e9          MOVI    P2CTRL,A9       
         00000e90 00000000! 
     211 00000eb0           PLLINIPG
     212 00000eb0     4c46          MOVE    A2,A6                   ;KEEP PDATA HERE
     213                    
     214 00000ec0                   SWAP    A10,A8
     215 00000ef0     0d5f          CALLA   GETANIXY
         00000f00 00000000! 
     216 00000f20                   SWAP    A10,A8
     217                    
     218 00000f50     4c45          MOVE    A2,A5
     219 00000f60     4c67          MOVE    A3,A7
     220                    
     221 00000f70     4d00          MOVE    A8,A0
     222 00000f80     4c8e          MOVE    A4,A14
     223 00000f90     09e4          MOVI    DMAWNZ,A4
         00000fa0 00008002  
     224 00000fc0     0d5f          CALLA   GANISAG                 ;ADJUST THE TORSO PORTION OF THE BOD
         00000fd0 00000000! 
     225 00000ff0     4ca2          MOVE    A5,A2
     226 00001000     4ce3          MOVE    A7,A3
     227 00001010     4dc0          MOVE    A14,A0
     228 00001020     0d5f          CALLA   GANISAG                 ;NOW THE LEGS
         00001030 00000000! 
     229 00001050     4dc4          MOVE    A14,A4                  ;RESTORE LEG POINTER TO THE PROPER REG
     230 00001060     bb48          MOVE    *A10(OXVEL),*A8(OXVEL),L
         00001070     0040  
         00001080     0040  
     231 00001090     bb44          MOVE    *A10(OXVEL),*A4(OXVEL),L
         000010a0     0040  
         000010b0     0040  
     232 000010c0     bb48          MOVE    *A10(OZVAL),*A8(OZVAL),L
         000010d0     00c0  
         000010e0     00c0  
     233 000010f0     bb44          MOVE    *A10(OZVAL),*A4(OZVAL),L
         00001100     00c0  
         00001110     00c0  
     234 00001120     4cc2          MOVE    A6,A2                   ;RESTORE PLINDX
     235                    
     236 00001130     09c7          MOVI    PJUMP|PRYTE,A7          ;START TO BAIL
         00001140     0048  
     237 00001150     80e9          MOVE    A7,*A9,W
     238                    
     239 00001160     56e7          CLR     A7
     240 00001170     b760          MOVE    *A11(PASSPTR),A0,L      ;DELETE PLACEHOLDER
         00001180     0260  
     241 00001190     480c          CMP     A0,A12
     242 000011a0     cb03          JRNE    PLLINID2
     243 000011b0     b2eb          MOVE    A7,*A11(PASSPTR),L
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    7

         000011c0     0260  
     244 000011d0     c008          JRUC    PLLINIDG
     245 000011e0           PLLINID2
     246 000011e0     4d05          MOVE    A8,A5   
     247 000011f0     4d60          MOVE    A11,A0
     248 00001200     5708          CLR     A8
     249 00001210     0d5f          CALLA   PUTA8
         00001220 00000000! 
     250 00001240     4ca8          MOVE    A5,A8
     251 00001250     4d80          MOVE    A12,A0
     252 00001260           PLLINIDG
     253 00001260     0d5f          CALLA   DELSOBJ
         00001270 00000000! 
     254                    
     255 00001290     4c4b          MOVE    A2,A11
     256 000012a0                   CREATE  INDPID,PIJDECEL
     257 00001320     4d00          MOVE    A8,A0
     258 00001330     c000          JRUC    PLLINI4
         00001340     00c3  
     259                    
     260                    *TRANSPORT THE NEW PLAYER ON THE SCREEN HERE
     261 00001350           PLLTRAN
     262 00001350     05a0          MOVE    @PSZMIN,A0,W
         00001360 00000000! 
     263 00001380     05a5          MOVE    @PSZMAX,A5,W
         00001390 00000000! 
     264 000013b0     4805          CMP     A0,A5
     265 000013c0     ca00          JREQ    PLLINIST                ;BR = NO STREET TO BE HAD, NO CAR
         000013d0     00af  
     266                    
     267 000013e0     0b62          CMPI    P1DATA,A2
         000013f0 ffffffff! 
     268 00001410     cb04          JRNE    PLLTRAN1
     269 00001420     07a0          MOVE    @P2DATA+PFLAGS,A0,L
         00001430 00000080! 
     270 00001450     c003          JRUC    PLLTRAN2
     271 00001460           PLLTRAN1
     272 00001460     07a0          MOVE    @P1DATA+PFLAGS,A0,L
         00001470 00000080! 
     273 00001490           PLLTRAN2
     274 00001490     1e80          BTST    BDRIVER,A0
     275 000014a0     ca7e          JREQ    PLLTRAN3                ;BR = THE OTHER PLAYER IS NOT DRIVING
     276                    
     277 000014b0     07aa          MOVE    @PLAYCAR,A10,L
         000014c0 00000000! 
     278 000014e0     ca00          JRZ     PLLINIST
         000014f0     009d  
     279 00001500     b740          MOVE    *A10(OPLINK),A0,L
         00001510     01f0  
     280 00001520     ca00          JRZ     PLLINIST                ;UH, SOMETHING'S WRONG
         00001530     0099  
     281 00001540           PLLTRN2A
     282 00001540     b300          MOVE    A8,*A0(PASSPTR),L               ;STUFF THIS GUY HERE
         00001550     0260  
     283 00001560     1820          MOVK    1,A0
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    8

     284 00001570     0580          MOVE    A0,@PUPDATE,W                   ;TURN OFF UPDATE
         00001580 00000000! 
     285 000015a0     b440          MOVE    *A2(PIRQFLAG),A0,W              ;FOR NIL FLAG FUCK
         000015b0     0080  
     286 000015c0     0ba0          ORI     MPASSEN,A0
         000015d0 00001000  
     287 000015f0     b002          MOVE    A0,*A2(PIRQFLAG),W
         00001600     0080  
     288 00001610     5600          CLR     A0
     289 00001620     0580          MOVE    A0,@PUPDATE,W                   ;RE-INSTATE THE UPDATE
         00001630 00000000! 
     290 00001650     098f          MMTM    SP,A2,A4                ;KEEP VITAL STUFF
         00001660     2800  
     291                    *WARP PLAYER TORSO TO THE PASSENGER SEAT 
     292 00001670     b546          MOVE    *A10(OID),A6,W  
         00001680     01a0  
     293 00001690     0b46          CMPI    TRAN2OID,A6
         000016a0     f3bf  
     294 000016b0     cb0a          JRNE    PLLPINC
     295 000016c0     1b20          MOVK    HELPASFRM,A0
     296 000016d0     bb48          MOVE    *A10(OZVEL),*A8(OZVEL),L
         000016e0     00e0  
         000016f0     00e0  
     297 00001700     b746          MOVE    *A10(OZVAL),A6,L
         00001710     00c0  
     298 00001720     1426          DEC     A6                      ;GET INSIDE THE HELICOPTER
     299 00001730     b2c8          MOVE    A6,*A8(OZVAL),L
         00001740     00c0  
     300 00001750     c009          JRUC    PLLPPASS
     301 00001760           PLLPINC
     302 00001760     1a40          MOVK    PASSTFRM,A0
     303 00001770     bb48          MOVE    *A10(OZVEL),*A8(OZVEL),L
         00001780     00e0  
         00001790     00e0  
     304 000017a0     b746          MOVE    *A10(OZVAL),A6,L
         000017b0     00c0  
     305 000017c0     1026          INC     A6                      ;OVERLAP THE CAR
     306 000017d0     b2c8          MOVE    A6,*A8(OZVAL),L
         000017e0     00c0  
     307 000017f0           PLLPPASS
     308 000017f0     bb48          MOVE    *A10(OXVEL),*A8(OXVEL),L
         00001800     0040  
         00001810     0040  
     309 00001820     bb48          MOVE    *A10(OYVEL),*A8(OYVEL),L
         00001830     0060  
         00001840     0060  
     310 00001850     b646          MOVE    *A2(PMAINT),A6,L        
         00001860     00e0  
     311 00001870     0d5f          CALLA   BASFRM                  ;GET PASSENGER SCRIPT
         00001880 00000000! 
     312 000018a0     86c6          MOVE    *A6,A6,L
     313 000018b0     b2c2          MOVE    A6,*A2(PFRM),L          ;FORCE PIRQ ROUTINE BLOW THIS OUT
         000018c0     0040  
     314 000018d0     86c1          MOVE    *A6,A1,L                ;GET THE FRAME 
     315 000018e0     b544          MOVE    *A10(OFLAGS),A4,W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE    9

         000018f0     0100  
     316 00001900     0d5f          CALLA   ANI                     ;ANIMATE IN THE NEW FRAME
         00001910 00000000! 
     317                    
     318 00001930     b741          MOVE    *A10(OIMG),A1,L
         00001940     0180  
     319 00001950     b742          MOVE    *A10(OSIZE),A2,L
         00001960     0140  
     320 00001970     0d5f          CALLA   GANIOF                          ;GET THE CAR ANIMATION PNT.
         00001980 00000000! 
     321 000019a0     b743          MOVE    *A10(OXVAL),A3,L
         000019b0     0080  
     322 000019c0     b745          MOVE    *A10(OYVAL),A5,L
         000019d0     00a0  
     323 000019e0     40c3          ADD     A6,A3
     324 000019f0     40e5          ADD     A7,A5                           ;SET THE PRECEDENT
     325 00001a00     b701          MOVE    *A8(OIMG),A1,L
         00001a10     0180  
     326 00001a20     b702          MOVE    *A8(OSIZE),A2,L
         00001a30     0140  
     327 00001a40     0d5f          CALLA   GANIOF
         00001a50 00000000! 
     328 00001a70     44c3          SUB     A6,A3   
     329 00001a80     44e5          SUB     A7,A5
     330 00001a90     b268          MOVE    A3,*A8(OXVAL),L
         00001aa0     0080  
     331 00001ab0     b2a8          MOVE    A5,*A8(OYVAL),L         ;STUFF NEW DRIVER COORDS.
         00001ac0     00a0  
     332 00001ad0     09af          MMFM    SP,A2,A4                ;GET BACK THE STUFF
         00001ae0     0014  
     333 00001af0     09e1          MOVI    PLAYERS,A1                                               
         00001b00 00000000! 
     334 00001b20     4d00          MOVE    A8,A0
     335 00001b30     0d5f          CALLA   INSOBJ                  ;INSERT TORSO                    
         00001b40 00000000! 
     336 00001b60     0d5f          CALLA   ADDSUPP                 ;ADD TO SUPPLEMENTAL LIST        
         00001b70 00000000! 
     337 00001b90     b480          MOVE    *A4(OFLAGS),A0,W
         00001ba0     0100  
     338 00001bb0     2f80          SRL     4,A0
     339 00001bc0     2480          SLL     4,A0
     340 00001bd0     b004          MOVE    A0,*A4(OFLAGS),W        ;LEGS AWAY
         00001be0     0100  
     341 00001bf0     4c80          MOVE    A4,A0                                                    
     342 00001c00     0d5f          CALLA   INSOBJ                  ;INSERT LEGS                     
         00001c10 00000000! 
     343 00001c30     0d5f          CALLA   ADDSUPP                 ;ADD TO SUPPLEMENTAL LIST        
         00001c40 00000000! 
     344 00001c60     0d3f          CALLR   STARTINVL
         00001c70     02c0  
     345 00001c80     c04e          JRUC    PLLINITX
     346 00001c90           PLLTRAN3
     347 00001c90     05a0          MOVE    @PORCNT,A0      
         00001ca0 00000000! 
     348 00001cc0     cb20          JRNE    PLLINIST                ;DON'T USE THE CAR IF ONE IS ON SCREEN
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   10

     349                    
     350 00001cd0     4c89          MOVE    A4,A9
     351 00001ce0     4c4b          MOVE    A2,A11
     352 00001cf0                   CREATE  PORSTPID,PORTRANS
     353 00001d70     cb3f          JRNZ    PLLINITX                ;BR = O.K.
     354 00001d80     4c80          MOVE    A4,A0                   ;FAILURE MODE!
     355 00001d90     0d5f          CALLA   FREEOBJ
         00001da0 00000000! 
     356 00001dc0     5600          CLR     A0
     357 00001dd0     b202          MOVE    A0,*A2(POBJ),L
         00001de0     00a0  
     358 00001df0     b202          MOVE    A0,*A2(PLOBJ),L
         00001e00     0120  
     359 00001e10     05a0          MOVE    @CURPAL,A0,W
         00001e20 00000000! 
     360 00001e40     0d5f          CALLA   FREEPAL
         00001e50 00000000! 
     361 00001e70     4d00          MOVE    A8,A0
     362 00001e80     0d5f          CALLA   FREEOBJ                 ;FREE ALL AND EXIT
         00001e90 00000000! 
     363 00001eb0     5708          CLR     A8
     364 00001ec0     c02a          JRUC    PLLINITX
     365 00001ed0           PLLINIST
     366 00001ed0     4c80          MOVE    A4,A0
     367 00001ee0     0d5f          CALLA   ADJSTWTL
         00001ef0 00000000! 
     368 00001f10     4d00          MOVE    A8,A0
     369 00001f20     0d5f          CALLA   ADJSTWTL
         00001f30 00000000! 
     370 00001f50     0d3f          CALLR   STARTINVL
         00001f60     0291  
     371 00001f70     c007          JRUC    PLLINI4A
     372 00001f80           PLLINI4
     373 00001f80     b440          MOVE    *A2(PEXEFLAG),A0,W
         00001f90     0090  
     374 00001fa0     0b80          ANDNI   MINVINC,A0              ;TURN INVINCIBILITY FLAG
         00001fb0 00000010  
     375 00001fd0     b002          MOVE    A0,*A2(PEXEFLAG),W
         00001fe0     0090  
     376 00001ff0           PLLINI4A
     377 00001ff0     09e1          MOVI    PLAYERS,A1                                               
         00002000 00000000! 
     378 00002020     4d00          MOVE    A8,A0                   ;MAKE SURE TORSO POINTER IS CORRECT
     379 00002030     0d5f          CALLA   INSOBJ                  ;INSERT TORSO                    
         00002040 00000000! 
     380 00002060     0d5f          CALLA   ADDSUPP                 ;ADD TO SUPPLEMENTAL LIST        
         00002070 00000000! 
     381 00002090     4c80          MOVE    A4,A0                                                    
     382 000020a0     0d5f          CALLA   INSOBJ                  ;INSERT LEGS                     
         000020b0 00000000! 
     383 000020d0     0d5f          CALLA   ADDSUPP                 ;ADD TO SUPPLEMENTAL LIST        
         000020e0 00000000! 
     384 00002100     0d5f          CALLA   SHADST2                 ;START SHADOW FOR PLAYER TORSO   
         00002110 00000000! 
     385 00002130     4c88          MOVE    A4,A8                                                    
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   11

     386 00002140     0d5f          CALLA   SHADST                  ;START SHADOW FOR PLAYER LEGS    
         00002150 00000000! 
     387 00002170           PLLINITX
     388 00002170     4d08          MOVE    A8,A8                   ;NO ZERO FLAG
     389 00002180     09af          MMFM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12
         00002190     1fff  
     390 000021a0     0960          RETS
     391                    
     392                    *PLAYER ONE INITIALIZATION TABLE
     393 000021b0           P1INITTL
     394                    *
     395                    *LEG INIT
     396 000021b0 00000000          .LONG   0,0,(220*10000H),(235*Y)
     397 00002230     0000          .WORD   0,0
     398 00002250 00000000!         .LONG   jlsw4,PZSIZ,P1COLL
     399 000022b0     8002          .WORD   DMAWNZ,P1OID
     400 000022d0 00000000          .LONG   0
     401                    *
     402                    *TORSO INIT
     403 000022f0 00000000          .LONG   0,0,(220*10000H),(235*Y)
     404 00002370     0000          .WORD   0,0
     405 00002390 00000000!         .LONG   jtsstdrst,PZSIZ,P1COLL
     406 000023f0     8002          .WORD   DMAWNZ,P1OID
     407 00002410 00000000!         .LONG   P1BLIP
     408                    *
     409                    *PLAYER TWO INITIALIZATION TABLE
     410 00002430           P2INITT
     411                    *
     412                    *LEG INIT
     413 00002430 00000000          .LONG   0,0,(310*10000H),(220*Y)
     414 000024b0     0000          .WORD   0,0
     415 000024d0 00000000!         .LONG   ylsw4,PZSIZ,P2COLL
     416 00002530     8002          .WORD   DMAWNZ,P2OID
     417 00002550 00000000          .LONG   0
     418                    *
     419                    *TORSO INIT
     420 00002570 00000000          .LONG   0,0,(310*10000H),(220*Y)
     421 000025f0     0000          .WORD   0,0
     422 00002610 00000000!         .LONG   ytsstdrst,PZSIZ,P2COLL
     423 00002670     8002          .WORD   DMAWNZ,P2OID
     424 00002690 00000000!         .LONG   P2BLIP
     425                    
     426                    *PLAYER COLLISION LISTS
     427 000026b0           P1COLL
     428 000026b0     0be0          .WORD   BEOID|BULLETID
     429 000026c0 00013d70'         .LONG   P1COLL0
     430 000026e0     0be5          .WORD   BEOID|HYPOD
     431 000026f0 000142f0'         .LONG   P1COLLHY
     432 00002710     0be2          .WORD   BEOID|EXPLODID
     433 00002720 00014480'         .LONG   PEXPL1
     434 00002740     0beb          .WORD   BEOID|BASEID
     435 00002750 00014480'         .LONG   PEXPL1
     436 00002770     0be4          .WORD   BEOID|ROCKETID
     437 00002780 000145e0'         .LONG   PROCK1
     438 000027a0     0b24          .WORD   B2OID|ROCKETID
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   12

     439 000027b0 000145e0'         .LONG   PROCK1
     440                    
     441 000027d0     0c00          .WORD   C1OID|CBODYID
     442 000027e0 00014740'         .LONG   PCARHIT1
     443                    
     444 00002800     0bc4          .WORD   BGGID
     445 00002810 000148a0'         .LONG   PGARBAGE1
     446                    
     447 00002830     0bcb          .WORD   BGTELEID
     448 00002840 000148a0'         .LONG   PGARBAGE1
     449                    
     450 00002860     0800          .WORD   WEEDOID
     451 00002870 000148a0'         .LONG   PGARBAGE1
     452                    
     453 00002890     0bc9          .WORD   BGDMPID
     454 000028a0 00014a00'         .LONG   PDUMP1
     455                    
     456 000028c0     0000          .WORD   0
     457 000028d0 00000000!         .LONG   DUMRTSG
     458                    
     459 000028f0           P2COLL
     460 000028f0     0be0          .WORD   BEOID|BULLETID
     461 00002900 00013db0'         .LONG   P2COLL0
     462 00002920     0be5          .WORD   BEOID|HYPOD
     463 00002930 00014330'         .LONG   P2COLLHY
     464 00002950     0be2          .WORD   BEOID|EXPLODID
     465 00002960 00014530'         .LONG   PEXPL2
     466 00002980     0beb          .WORD   BEOID|BASEID
     467 00002990 00014530'         .LONG   PEXPL2
     468 000029b0     0be4          .WORD   BEOID|ROCKETID
     469 000029c0 00014690'         .LONG   PROCK2
     470 000029e0     0b14          .WORD   B1OID|ROCKETID
     471 000029f0 00014690'         .LONG   PROCK2
     472                    
     473 00002a10     0c00          .WORD   C1OID|CBODYID
     474 00002a20 000147f0'         .LONG   PCARHIT2
     475                    
     476 00002a40     0bc4          .WORD   BGGID
     477 00002a50 00014950'         .LONG   PGARBAGE2
     478                    
     479 00002a70     0bcb          .WORD   BGTELEID
     480 00002a80 00014950'         .LONG   PGARBAGE2
     481                    
     482 00002aa0     0800          .WORD   WEEDOID
     483 00002ab0 00014950'         .LONG   PGARBAGE2
     484                    
     485 00002ad0     0bc9          .WORD   BGDMPID
     486 00002ae0 00014ab0'         .LONG   PDUMP2
     487                    
     488 00002b00     0000          .WORD   0
     489 00002b10 00000000!         .LONG   DUMRTSG
     490                    *
     491                    *RE-INITIALIZE A PLAYER ON BUY-IN(I.E. PLAYER OBJECT ACTIVE)
     492                    *A2 = PTR TO PLAYER DATA BLOCK
     493 00002b30           PLREINIT
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   13

     494                    *MAKE SURE A13 IS THE LAST REGISTER PUSHED HERE!
     495 00002b30     098f          MMTM    SP,A0,A1,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13
         00002b40     dffc  
     496                    *PUT ADJUSTMENTS HERE
     497 00002b50                   ADJUST  ADJLIVES
     498                    ***     MOVI    ILIVES,A0
     499 00002ba0     b002          MOVE    A0,*A2(PLIVES),W        ;YES MORE LIFE
         00002bb0     02b0  
     500 00002bc0     09c0          MOVI    IENERGY,A0,W            ;GET THE INITIAL # OF PLAYER LIVES
         00002bd0     0023  
     501 00002be0     2600          SLL     16,A0
     502 00002bf0     b202          MOVE    A0,*A2(PENERGY),L       ;STORE IT       
         00002c00     01c0  
     503                    
     504 00002c10                   ADJUST  ADJROCKS
     505 00002c60     b441          MOVE    *A2(PROCKETS),A1,W
         00002c70     01e0  
     506 00002c80     4001          ADD     A0,A1                   ;ADD MORE ROCKETS
     507 00002c90     b022          MOVE    A1,*A2(PROCKETS),W      ;STORE INITIAL ROCKETS
         00002ca0     01e0  
     508                    
     509 00002cb0     b440          MOVE    *A2(PBULLETS),A0,W      ;AND SOME MORE BULLETS
         00002cc0     0250  
     510 00002cd0     0b00          ADDI    IBULLETS,A0
         00002ce0     0064  
     511 00002cf0     b002          MOVE    A0,*A2(PBULLETS),W
         00002d00     0250  
     512                    
     513 00002d10     09a2          MMFM    A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13
         00002d20     3ff8  
     514 00002d30     1da9          BTST    BDEAD,A9
     515 00002d40     ca1c          JREQ    PREIN1                  ;HE'S STILL ON THE MOVE
     516 00002d50     1860          MOVK    STANDLEG,A0
     517 00002d60     0d3f          CALLR   LOADLTAB                ;SET UP INITIAL ANIMATION TABLE
         00002d70     0662  
     518 00002d80     1880          MOVK    RESTORSO,A0
     519 00002d90     0d5f          CALLA   LOADATAB
         00002da0 00000000! 
     520 00002dc0     5663          CLR     A3                      ;CLEAR LEG TICKS
     521 00002dd0     56a5          CLR     A5                      ;CLEAR TICKS
     522 00002de0     56e7          CLR     A7                      ;CLEAR SWITCHES
     523                    
     524 00002df0     09e9          MOVI    [MINVINC,0],A9          ;BE INVINCIBLE UPON REINITIALIZATION
         00002e00 00100000  
     525                    **      CLR     A9                      ;CLEAR FLAGS
     526                    
     527 00002e20     4c80          MOVE    A4,A0
     528 00002e30     09e1          MOVI    PLAYERS,A1
         00002e40 00000000! 
     529 00002e60     0d5f          CALLA   ISSUPP
         00002e70 00000000! 
     530 00002e90     cb0a          JRNZ    PREIN2                  ;HE'S STILL ON THE LIST, DON'T RE-ADD
     531 00002ea0     0d5f          CALLA   ADDSUPP
         00002eb0 00000000! 
     532 00002ed0     0d5f          CALLA   PLEGON
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   14

         00002ee0 00000000! 
     533 00002f00     c003          JRUC    PREIN2
     534 00002f10           PREIN1
     535 00002f10     0b89          ANDNI   ((MDYING|MBUYIN)*10000H),A9 ;TURN OFF THIS BUY-IN GARBAGE
         00002f20 000a0000  
     536 00002f40           PREIN2
     537 00002f40     0982          MMTM    A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13 ;STUFF THE DATA BLOCK
         00002f50     1ffc  
     538 00002f60                   PULL    A13                     ;GET US A CURPROC PTR
     539                    
     540 00002f80     0d3f          CALLR   PLAYERON                ;TURN THE PLAYER ON
         00002f90     070f  
     541                    
     542 00002fa0     4d20          MOVE    A9,A0
     543 00002fb0     0b80          ANDI    MPASSEN|MDRIVER,A0
         00002fc0 ffffe7ff  
     544 00002fe0     cb04          JRNE    PREIN3                  ;BR = DON'T RE-ALIGN WHILE IN CAR
     545 00002ff0     0d3f          CALLR   PLALIGN                 ;ALIGN THE BODACIOUS BODY PARTS
         00003000     05eb  
     546 00003010     0d3f          CALLR   CKLBADJ                 ;RE-ALIGN IN BOUNDS PLEASE
         00003020     0836  
     547 00003030           PREIN3
     548 00003030     0d3f          CALLR   STARTINVL
         00003040     0183  
     549                    ***     JRNZ    PREINX
     550                    ***     MOVE    *A2(PEXEFLAG),A0,W
     551                    ***     ANDNI   MINVINC,A0              ;MAKE SURE IT'S OFF JUST IN CASE
     552                    ***     MOVE    A0,*A2(PEXEFLAG),W
     553                    ***PREINX
     554 00003050     09af          MMFM    SP,A0,A1,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12
         00003060     1ffb  
     555 00003070     0960          RETS
     556                    
     557                    **************************************************************************
     558                    *                                                                        *
     559                    * PLWAVEST - START A PLAYER AT THE BEGINNING OF A WAVE, THE PLAYER DATA  *
     560                    *          STRUCTURE IS KEPT EXACTLY THE SAME, EXCEPT FOR POBJ           *
     561                    *          AND PLOBJ. THE PLAYER OBJECTS AND SHADOWS ARE RE-CREATED.     *
     562                    *          IF THE PLAYER DID NOT EXIST, THEN HE WILL BE SKIPPED.         *
     563                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
     564                    * A14 = PTR TO PLAYER OBJECT INITIALIZATION TABLES                       *
     565                    *                                                                        *
     566                    **************************************************************************
     567 00003080           PLWAVEST
     568 00003080     098f          MMTM    SP,A0,A1,A3,A4,A5,A6,A7,A8,A9,A10,A11
         00003090     dff0  
     569 000030a0     b640          MOVE    *A2(PLOBJ),A0,L
         000030b0     0120  
     570 000030c0     cb0e          JRNE    PLWSTGO                 ;BR = PLAYER EXISTED IN PREVIOUS WAVE
     571 000030d0     4c4b          MOVE    A2,A11
     572 000030e0     b441          MOVE    *A2(PPID),A1
         000030f0     0240  
     573 00003100     0ba1          ORI     PMPID,A1
         00003110 00000020  
     574 00003130     09e7          MOVI    PRESCONT,A7
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   15

         00003140 00000000! 
     575 00003160     0d5f          CALLA   GETPRC                  ;FLASH THE BUY-IN MESSAGE
         00003170 00000000! 
     576 00003190     c000          JRUC    PLWVSTX
         000031a0     00a2  
     577 000031b0           PLWSTGO
     578 000031b0     b640          MOVE    *A2(PFLAGS),A0,L
         000031c0     0080  
     579 000031d0     1d80          BTST    BBUYIN,A0
     580 000031e0     ca21          JREQ    PLWVST3                 ;BR = THE GUY WASN'T READY FOR BUYIN
     581 000031f0     b441          MOVE    *A2(PLIVES),A1,W
         00003200     02b0  
     582 00003210     cb03          JRNZ    PLWSTKBY                ;BR = HE GOT MORE LIFE DURING BONUS
     583 00003220     b641          MOVE    *A2(PENERGY),A1,L
         00003230     01c0  
     584 00003240     ca08          JRZ     PLWVST0                 ;BR = NO ENERGY, NO LIFE, BUY-IN DUDE
     585 00003250           PLWSTKBY
     586 00003250     b441          MOVE    *A2(PEXEFLAG),A1,W
         00003260     0090  
     587 00003270     0b81          ANDNI   MBUYIN,A1               ;CLEAR BUY-IN
         00003280 00000008  
     588 000032a0     b022          MOVE    A1,*A2(PEXEFLAG),W
         000032b0     0090  
     589 000032c0     c013          JRUC    PLWVST3
     590 000032d0           PLWVST0
     591 000032d0     b441          MOVE    *A2(PPID),A1,W
         000032e0     0240  
     592 000032f0     0b01          ADDI    PDPID,A1                ;GET THE I.D.
         00003300     00d0  
     593 00003310     0b62          CMPI    P1DATA,A2
         00003320 ffffffff! 
     594 00003340     ca04          JREQ    PLWVST1                 ;BR = PLAYER ONE IS THE ONE
     595 00003350     09e7          MOVI    P2BUYINT,A7
         00003360 000115c0' 
     596 00003380     c003          JRUC    PLWVST4                 ;SKIP THE ENERGY START, HE'S OUT
     597 00003390           PLWVST1
     598 00003390     09e7          MOVI    P1BUYINT,A7             ;PLAYER ONE IS THE ONE
         000033a0 00011500' 
     599 000033c0           PLWVST4
     600 000033c0     0d5f          CALLA   GETPRC                  ;START THE SELECETED PROCESS
         000033d0 00000000! 
     601 000033f0     c01a          JRUC    PLWVST3C                ;SKIP THE ENERGY START
     602 00003400           PLWVST3
     603 00003400     1da0          BTST    BDEAD,A0
     604 00003410     ca0d          JREQ    PLWVST3A                ;BR = THE GUY WAS SOMEHOW DEAD
     605 00003420     b440          MOVE    *A2(PLIVES),A0,W
         00003430     02b0  
     606 00003440     1420          DEC     A0
     607 00003450     c614          JRLE    PLWVST3C                ;BR = NO MORE LIVES             
     608 00003460     0d5f          CALLA   SUBLIFE                 ;TAKE THIS AWAY...
         00003470 00000000! 
     609 00003490     09c0          MOVI    IENERGY,A0
         000034a0     0023  
     610 000034b0     2600          SLL     16,A0
     611 000034c0     b202          MOVE    A0,*A2(PENERGY),L
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   16

         000034d0     01c0  
     612 000034e0     c008          JRUC    PLWVST3B
     613 000034f0           PLWVST3A
     614 000034f0     b441          MOVE    *A2(PENERGY+16),A1,W
         00003500     01d0  
     615 00003510     0b41          CMPI    2,A1
         00003520     fffd  
     616 00003530     c706          JRGT    PLWVST3C
     617 00003540     1841          MOVK    2,A1
     618 00003550     b022          MOVE    A1,*A2(PENERGY+16),W
         00003560     01d0  
     619 00003570           PLWVST3B
     620 00003570     0d5f          CALLA   OUTENRGY
         00003580 00000000! 
     621 000035a0           PLWVST3C
     622 000035a0     1860          MOVK    STANDLEG,A0             ;WE ARE STANDING
     623 000035b0     b646          MOVE    *A2(PMAINT),A6,L
         000035c0     00e0  
     624 000035d0     0d5f          CALLA   BASFRM                  ;GET THE LEG SCRIPT POINTER     
         000035e0 00000000! 
     625 00003600     96c7          MOVE    *A6+,A7,L
     626 00003610     b2e2          MOVE    A7,*A2(PLFRM),L
         00003620     0000  
     627 00003630     b2e2          MOVE    A7,*A2(PLEGAS),L        ;STORE HERE FOR A RESET
         00003640     0160  
     628 00003650     86c7          MOVE    *A6,A7,L                ;NOW THE TORSO
     629 00003660     b2e2          MOVE    A7,*A2(PFRM),L
         00003670     0040  
     630                    
     631 00003680     5600          CLR     A0
     632 00003690     b202          MOVE    A0,*A2(PTICKS),L
         000036a0     0100  
     633 000036b0     b202          MOVE    A0,*A2(PLTICKS),L       ;RESET ANIMATION COUNTERS
         000036c0     0140  
     634 000036d0     b002          MOVE    A0,*A2(PBULLONS),W
         000036e0     0260  
     635 000036f0     b002          MOVE    A0,*A2(PROCKONS),W
         00003700     0290  
     636                    
     637 00003710     09c0          MOVI    MIDLE,A0
         00003720     0001  
     638 00003730     b002          MOVE    A0,*A2(PIRQFLAG),W      ;RESET THE PLAYER FLAGS
         00003740     0080  
     639 00003750     5600          CLR     A0
     640 00003760     b202          MOVE    A0,*A2(PEXEFLAG),L      ;RESET THE PLAYER FLAGS
         00003770     0090  
     641                    
     642                    *LOAD BASE WALKING VELOCITIES
     643 00003780     09e0          MOVI    PWXVEL,A0
         00003790 00010000  
     644 000037b0     b202          MOVE    A0,*A2(PXVEL),L
         000037c0     0350  
     645 000037d0     09e0          MOVI    PWYVEL,A0
         000037e0 00010000  
     646 00003800     b202          MOVE    A0,*A2(PYVEL),L
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   17

         00003810     0370  
     647                    
     648 00003820     09e1          MOVI    PLAYERS,A1              ;ADD PLAYERS TO THIS LIST
         00003830 00000000! 
     649                    
     650 00003850     0d5f          CALLA   INITPAL
         00003860 00000000! 
     651                    
     652 00003880     0d5f          CALLA   GETOBJ
         00003890 00000000! 
     653 000038b0     0d5f          CALLA   STFOBJ          ;RESET THE LEGS
         000038c0 00000000! 
     654 000038e0     0d5f          CALLA   ADJSTWTL        ;ADJUST TO THE WORLD TOP LEFT
         000038f0 00000000! 
     655 00003910     0d5f          CALLA   SETZPOS         ;SET Z BASED ON THE FEET
         00003920 00000000! 
     656 00003940     0d5f          CALLA   INSOBJ
         00003950 00000000! 
     657 00003970     0d5f          CALLA   ADDSUPP
         00003980 00000000! 
     658 000039a0     b202          MOVE    A0,*A2(PLOBJ),L
         000039b0     0120  
     659 000039c0     4c04          MOVE    A0,A4           ;SAVE FOR MATCHING PURPOSES
     660                    
     661 000039d0     0d5f          CALLA   GETOBJ
         000039e0 00000000! 
     662 00003a00     0d5f          CALLA   STFOBJ          ;AND THE TORSO
         00003a10 00000000! 
     663 00003a30     b685          MOVE    *A4(OZVAL),A5,L         ;MATCH THE FOOT Z POSITION
         00003a40     00c0  
     664 00003a50     1025          INC     A5                      ;TORSO ALWAYS ON TOP
     665 00003a60     b2a0          MOVE    A5,*A0(OZVAL),L
         00003a70     00c0  
     666 00003a80     0d5f          CALLA   ADJSTWTL
         00003a90 00000000! 
     667 00003ab0     0d5f          CALLA   INSOBJ
         00003ac0 00000000! 
     668 00003ae0     0d5f          CALLA   ADDSUPP
         00003af0 00000000! 
     669 00003b10     b202          MOVE    A0,*A2(POBJ),L
         00003b20     00a0  
     670                    
     671 00003b30     4c08          MOVE    A0,A8
     672 00003b40     0d5f          CALLA   SHADST2                 ;START THE TORSO SHADOW
         00003b50 00000000! 
     673                    
     674 00003b70     0d3f          CALLR   STARTINV1               ;START INVINCIBILITY
         00003b80     00d7  
     675                    
     676 00003b90     4c88          MOVE    A4,A8
     677 00003ba0     0d5f          CALLA   SHADST                  ;AND THE LEG SHADOW
         00003bb0 00000000! 
     678                    
     679 00003bd0           PLWVSTX
     680 00003bd0     09af          MMFM    SP,A0,A1,A3,A4,A5,A6,A7,A8,A9,A10,A11
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   18

         00003be0     0ffb  
     681 00003bf0     0960          RETS
     682                    
     683                    **************************************************************************
     684                    *                                                                        *
     685                    * PLROOMST - START A PLAYER AT THE BEGINNING OF A ROOM, THE PLAYER DATA  *
     686                    *          STRUCTURE IS KEPT EXACTLY THE SAME, EXCEPT FOR POBJ           *
     687                    *          AND PLOBJ.                                                    *
     688                    *               THE OBJECTS ARE NOT INSERTED OR SHADOWED!                *
     689                    *          IF THE PLAYER DID NOT EXIST, THEN HE WILL BE SKIPPED.         *
     690                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
     691                    * A8 = PTR TO DOOR THAT THE PLAYER IS EMERGING FROM                      *
     692                    * A14 = PTR TO PLAYER OBJECT INITIALIZATION TABLES                       *
     693                    *                                                                        *
     694                    **************************************************************************
     695 00003c00           PLROOMST
     696 00003c00     098f          MMTM    SP,A0,A1,A3,A4,A5,A6,A7,A8,A11
         00003c10     df90  
     697 00003c20     b640          MOVE    *A2(POBJ),A0,L
         00003c30     00a0  
     698 00003c40     ca00          JREQ    PLRMSTX         ;BR = PLAYER DID NOT EXIST
         00003c50     00b7  
     699                    
     700 00003c60     b640          MOVE    *A2(PFLAGS),A0,L
         00003c70     0080  
     701 00003c80     1d80          BTST    BBUYIN,A0
     702 00003c90     ca13          JREQ    PLRMST3                 ;BR = THE GUY WASN'T READY FOR BUYIN
     703                    
     704 00003ca0     b441          MOVE    *A2(PPID),A1,W
         00003cb0     0240  
     705 00003cc0     0b01          ADDI    PDPID,A1                ;GET THE I.D.
         00003cd0     00d0  
     706 00003ce0     0b62          CMPI    P1DATA,A2
         00003cf0 ffffffff! 
     707 00003d10     ca04          JREQ    PLRMST1                 ;BR = PLAYER ONE IS THE ONE
     708 00003d20     09e7          MOVI    P2BUYINT,A7
         00003d30 000115c0' 
     709 00003d50     c003          JRUC    PLRMST4                 ;SKIP THE ENERGY START, HE'S OUT
     710 00003d60           PLRMST1
     711 00003d60     09e7          MOVI    P1BUYINT,A7             ;PLAYER TWO IS THE ONE
         00003d70 00011500' 
     712 00003d90           PLRMST4
     713 00003d90     0d5f          CALLA   GETPRC                  ;START THE SELECETED PROCESS
         00003da0 00000000! 
     714 00003dc0     c01a          JRUC    PLRMST3C
     715 00003dd0           PLRMST3
     716 00003dd0     1da0          BTST    BDEAD,A0
     717 00003de0     ca0d          JREQ    PLRMST3A                ;BR = THE GUY WAS SOMEHOW DEAD
     718 00003df0     b440          MOVE    *A2(PLIVES),A0,W
         00003e00     02b0  
     719 00003e10     1420          DEC     A0
     720 00003e20     c614          JRLE    PLRMST3C                ;BR = NO MORE LIVES             
     721 00003e30     0d5f          CALLA   SUBLIFE                 ;TAKE THIS AWAY...
         00003e40 00000000! 
     722 00003e60     09c0          MOVI    IENERGY,A0
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   19

         00003e70     0023  
     723 00003e80     2600          SLL     16,A0
     724 00003e90     b202          MOVE    A0,*A2(PENERGY),L
         00003ea0     01c0  
     725 00003eb0     c008          JRUC    PLRMST3B
     726 00003ec0           PLRMST3A
     727 00003ec0     b441          MOVE    *A2(PENERGY+16),A1,W
         00003ed0     01d0  
     728 00003ee0     0b41          CMPI    2,A1
         00003ef0     fffd  
     729 00003f00     c706          JRGT    PLRMST3C
     730 00003f10     1841          MOVK    2,A1
     731 00003f20     b022          MOVE    A1,*A2(PENERGY+16),W
         00003f30     01d0  
     732 00003f40           PLRMST3B
     733 00003f40     0d5f          CALLA   OUTENRGY
         00003f50 00000000! 
     734 00003f70           PLRMST3C
     735 00003f70     09e0          MOVI    WALKFRM,A0              ;WE ARE STANDING
         00003f80 00000000  
     736 00003fa0     b646          MOVE    *A2(PMAINT),A6,L
         00003fb0     00e0  
     737 00003fc0     0d5f          CALLA   BASFRM                  ;GET THE LEG SCRIPT POINTER     
         00003fd0 00000000! 
     738 00003ff0     1880          MOVK    DNFRAME,A0
     739 00004000     24a0          SLL     5,A0
     740 00004010     4006          ADD     A0,A6
     741 00004020     86c7          MOVE    *A6,A7,L
     742 00004030     b2e2          MOVE    A7,*A2(PLFRM),L
         00004040     0000  
     743 00004050     b2e2          MOVE    A7,*A2(PLEGAS),L        ;STORE HERE FOR A RESET
         00004060     0160  
     744 00004070     18a0          MOVK    TOFFSET,A0
     745 00004080     24a0          SLL     5,A0
     746 00004090     4006          ADD     A0,A6
     747 000040a0     86c7          MOVE    *A6,A7,L                ;NOW THE TORSO
     748 000040b0     b2e2          MOVE    A7,*A2(PFRM),L
         000040c0     0040  
     749                    
     750 000040d0     5600          CLR     A0
     751 000040e0     b202          MOVE    A0,*A2(PTICKS),L
         000040f0     0100  
     752 00004100     b202          MOVE    A0,*A2(PLTICKS),L       ;RESET ANIMATION COUNTERS
         00004110     0140  
     753 00004120     b002          MOVE    A0,*A2(PBULLONS),W
         00004130     0260  
     754 00004140     b002          MOVE    A0,*A2(PROCKONS),W
         00004150     0290  
     755                    
     756 00004160     09c0          MOVI    MIDLE,A0
         00004170     0001  
     757 00004180     b002          MOVE    A0,*A2(PIRQFLAG),W      ;RESET PLAYER IRQ FLAGS
         00004190     0080  
     758 000041a0     5600          CLR     A0
     759 000041b0     b002          MOVE    A0,*A2(PEXEFLAG),W      ;RESET PLAYER PROCESS FLAGS
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   20

         000041c0     0090  
     760                    
     761                    *LOAD BASE WALKING VELOCITIES
     762 000041d0     09e0          MOVI    PWXVEL,A0
         000041e0 00010000  
     763 00004200     b202          MOVE    A0,*A2(PXVEL),L
         00004210     0350  
     764 00004220     09e0          MOVI    PWYVEL,A0
         00004230 00010000  
     765 00004250     b202          MOVE    A0,*A2(PYVEL),L
         00004260     0370  
     766                    
     767 00004270     0d5f          CALLA   INITPAL
         00004280 00000000! 
     768 000042a0     0d5f          CALLA   GETOBJ
         000042b0 00000000! 
     769 000042d0     0d5f          CALLA   STFOBJ          ;RESET THE LEGS
         000042e0 00000000! 
     770 00004300     0d5f          CALLA   ADJSTWTL        ;ADJUST TO THE WORLD TOP LEFT
         00004310 00000000! 
     771 00004330     b202          MOVE    A0,*A2(PLOBJ),L
         00004340     0120  
     772 00004350     4c04          MOVE    A0,A4           ;SAVE FOR MATCHING PURPOSES
     773                    
     774 00004360     0d5f          CALLA   GETOBJ
         00004370 00000000! 
     775 00004390     0d5f          CALLA   STFOBJ          ;AND THE TORSO
         000043a0 00000000! 
     776 000043c0     0d5f          CALLA   ADJSTWTL
         000043d0 00000000! 
     777 000043f0     b202          MOVE    A0,*A2(POBJ),L
         00004400     00a0  
     778                    
     779 00004410                   SWAP    A0,A8
     780 00004440     0d3f          CALLR   STARTINV1       ;I'M THE INVINCIBLE MAN
         00004450     004a  
     781 00004460                   SWAP    A0,A8
     782                    
     783 00004490     b401          MOVE    *A0(OXPOS),A1,W
         000044a0     0090  
     784 000044b0     b403          MOVE    *A0(OYPOS),A3,W
         000044c0     00b0  
     785 000044d0     2603          SLL     16,A3
     786 000044e0     ee61          MOVY    A3,A1
     787 000044f0     b483          MOVE    *A4(OXPOS),A3,W
         00004500     0090  
     788 00004510     b485          MOVE    *A4(OYPOS),A5,W
         00004520     00b0  
     789 00004530     2605          SLL     16,A5
     790 00004540     eea3          MOVY    A5,A3
     791 00004550     e261          SUBXY   A3,A1
     792                    
     793 00004560     b503          MOVE    *A8(OXPOS),A3,W
         00004570     0090  
     794 00004580     b505          MOVE    *A8(OYPOS),A5,W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   21

         00004590     00b0  
     795 000045a0     2605          SLL     16,A5
     796 000045b0     eea3          MOVY    A5,A3
     797                    
     798 000045c0     0b23          ADDI    P1DOOROF,A3
         000045d0 0028000a  
     799 000045f0     4c66          MOVE    A3,A6   
     800                    
     801 00004600     56a5          CLR     A5
     802 00004610     ee65          MOVY    A3,A5
     803 00004620     2603          SLL     16,A3
     804 00004630     b2a4          MOVE    A5,*A4(OYVAL),L
         00004640     00a0  
     805 00004650     b264          MOVE    A3,*A4(OXVAL),L
         00004660     0080  
     806                            
     807 00004670     e026          ADDXY   A1,A6
     808                    
     809 00004680     56a5          CLR     A5
     810 00004690     eec5          MOVY    A6,A5
     811 000046a0     2606          SLL     16,A6
     812 000046b0     b2a0          MOVE    A5,*A0(OYVAL),L
         000046c0     00a0  
     813 000046d0     b2c0          MOVE    A6,*A0(OXVAL),L
         000046e0     0080  
     814                    
     815 000046f0                   SWAP    A0,A4   
     816 00004720     0d5f          CALLA   SETZPOS
         00004730 00000000! 
     817 00004750                   SWAP    A0,A4
     818                    
     819 00004780     b685          MOVE    *A4(OZVAL),A5,L         ;MATCH THE FOOT Z POSITION
         00004790     00c0  
     820 000047a0     1025          INC     A5                      ;TORSO ALWAYS ON TOP
     821 000047b0     b2a0          MOVE    A5,*A0(OZVAL),L
         000047c0     00c0  
     822                    
     823 000047d0           PLRMSTX
     824 000047d0     09af          MMFM    SP,A0,A1,A3,A4,A5,A6,A7,A8,A11
         000047e0     09fb  
     825 000047f0     0960          RETS
     826                    
     827                    **************************************************************************
     828                    *                                                                        *
     829                    * STARTINV - START INVINCIBILITY FOR A PLAYER                            *
     830                    * A2 = PLINDX                                                            *
     831                    * A4 = PTR LEG OBJECT                                                    *
     832                    * A8 = PTR TORSO OBJECT                                                  *
     833                    * RETURNS:                                                               *
     834                    *       Z BIT SET = FAILURE                                              *
     835                    *       Z BIT CLR = SUCCESS                                              *
     836                    *                                                                        *
     837                    **************************************************************************
     838 00004800           STARTINV
     839 00004800     098f          MMTM    SP,A0,A1,A7,A9,A10,A11
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   22

         00004810     c170  
     840 00004820     09e7          MOVI    INVINCO,A7
         00004830 00000000! 
     841 00004850     09ca          MOVI    PINVTIM,A10
         00004860     001c  
     842 00004870     c00f          JRUC    STARTINVG
     843                    *START A DOUBLY LONG INVINICIBILITY FOR BUY-INS AND SUCH
     844 00004880           STARTINVL
     845 00004880     098f          MMTM    SP,A0,A1,A7,A9,A10,A11
         00004890     c170  
     846 000048a0     09e7          MOVI    INVINCO,A7
         000048b0 00000000! 
     847 000048d0     09ca          MOVI    PINVTIM*2,A10
         000048e0     0038  
     848 000048f0     c007          JRUC    STARTINVG
     849                    *NO FLASH ENTRY POINT
     850 00004900           STARTINV1
     851 00004900     098f          MMTM    SP,A0,A1,A7,A9,A10,A11
         00004910     c170  
     852 00004920     09ca          MOVI    PINVTIM,A10
         00004930     001c  
     853 00004940     09e7          MOVI    INVINCNF,A7
         00004950 00000000! 
     854 00004970           STARTINVG
     855 00004970     05a0          MOVE    @GAMSTATE,A0,W
         00004980 00000000! 
     856 000049a0     0b40          CMPI    INPLAY,A0
         000049b0     ffdf  
     857 000049c0     ca0c          JREQ    STARTINP
     858 000049d0     0b40          CMPI    INGAME,A0
         000049e0     ffef  
     859 000049f0     ca09          JREQ    STARTINP
     860 00004a00           STARTIFL
     861 00004a00     b440          MOVE    *A2(PEXEFLAG),A0,W
         00004a10     0090  
     862 00004a20     0b80          ANDNI   MINVINC,A0              ;MAKE SURE IT'S OFF JUST IN CASE
         00004a30 00000010  
     863 00004a50     b002          MOVE    A0,*A2(PEXEFLAG),W
         00004a60     0090  
     864 00004a70     5600          CLR     A0
     865 00004a80     c00a          JRUC    STARTINX
     866 00004a90           STARTINP
     867 00004a90     4c49          MOVE    A2,A9
     868 00004aa0     b441          MOVE    *A2(PPID),A1,W
         00004ab0     0240  
     869 00004ac0     0b01          ADDI    PIPID,A1
         00004ad0     0030  
     870 00004ae0     4c8b          MOVE    A4,A11
     871 00004af0     0d5f          CALLA   GETPRC                  ;DO THE INVICIBLE THING
         00004b00 00000000! 
     872 00004b20     caed          JRZ     STARTIFL                ;THE GET PROC FAILED, TURN OFF INV
     873 00004b30           STARTINX
     874 00004b30     09af          MMFM    SP,A0,A1,A7,A9,A10,A11
         00004b40     0e83  
     875 00004b50     0960          RETS
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   23

     876                    
     877                    **************************************************************************
     878                    *                                                                        *
     879                    * PLAYER JOYSTICK ROUTINE, CALLED FROM IRQ.                              *
     880                    * A0 = POINTER TO PLAYERS DATA BLOCK                                     *
     881                    * IF THE OBLOCK PTR(A8) IS NULL, THEN THE UPDATE IS SKIPPED              *
     882                    *                                                                        *
     883                    **************************************************************************
     884 00004b60           PLLAYER
     885 00004b60     4c02          MOVE    A0,A2                   ;COPY HERE FOR REFERENCE
     886 00004b70     09a0          MMFM    A0,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13 ;LOAD UP THE DATA
         00004b80     3ff8  
     887 00004b90     4e01          MOVE    A0,B1                   ;STORE
     888                    
     889 00004ba0     4d08          MOVE    A8,A8                           
     890 00004bb0     ca00          JREQ    PLAYXXX                 ;PLAYER IS INACTIVE DO ABSOLUTELY NADA
         00004bc0     0339  
     891                    
     892 00004bd0     56b5          CLR     B5
     893 00004be0     1fa9          BTST    BJUMP2,A9               ;IN JUMP MODE?
     894 00004bf0     ca54          JREQ    PLAYERNV                ;BR = NO
     895                    
     896                    *DO GRAVITY STUFF EVERY FRAME / IF NEEDED
     897 00004c00     b700          MOVE    *A8(OYVEL),A0,L ;GRAB THE Y-VELOCITY
         00004c10     0060  
     898 00004c20     c419          JRLT    PLAYERVA        ;BR = ON THE WAY UP
     899                    
     900 00004c30     0d3f          CALLR   DLLINE                  ;GET DISTANCE FROM LANDING LINE
         00004c40     046a  
     901 00004c50     c716          JRGT    PLAYERVA                ;BR = O.K. TO SUB VELOCITY
     902                    *PLAYER IS ON THE GROUND
     903 00004c60     0d3f          CALLR   PLSTOPYZ
         00004c70     050e  
     904                    
     905 00004c80     4f80          MOVE    A12,B0
     906 00004c90     b700          MOVE    *A8(OIMG),A0,L
         00004ca0     0180  
     907 00004cb0     b400          MOVE    *A0(IANIOFF+16),A0,W
         00004cc0     0030  
     908 00004cd0     2600          SLL     16,A0
     909 00004ce0     440c          SUB     A0,A12                  ;RE-ADJUST THE POSITION
     910 00004cf0     b388          MOVE    A12,*A8(OYVAL),L        ;MAKE SURE TORSO LANDS CORRECTLY
         00004d00     00a0  
     911 00004d10     4e1c          MOVE    B0,A12
     912 00004d20     b680          MOVE    *A4(OIMG),A0,L
         00004d30     0180  
     913 00004d40     b400          MOVE    *A0(IANIOFF+16),A0,W
         00004d50     0030  
     914 00004d60     2600          SLL     16,A0
     915 00004d70     440c          SUB     A0,A12                  ;RE-ADJUST THE POSITION
     916 00004d80     b384          MOVE    A12,*A4(OYVAL),L        ;MAKE SURE LEGS LAND CORRECTLY
         00004d90     00a0  
     917 00004da0     4e1c          MOVE    B0,A12                  ;RESTORE OLD LANDING LINE
     918 00004db0     c038          JRUC    PLAYERNV
     919                    
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   24

     920 00004dc0           PLAYERVA
     921 00004dc0     b700          MOVE    *A8(OYVEL),A0,L ;GET THE Y VELOCITY
         00004dd0     0060  
     922 00004de0     b701          MOVE    *A8(OXVEL),A1,L ;GET THE X VELOCITY
         00004df0     0040  
     923 00004e00     b70e          MOVE    *A8(OZVEL),A14,L ;GET THE Z VELOCITY
         00004e10     00e0  
     924 00004e20     1d29          BTST    BDHOLD,A9
     925 00004e30     cb20          JRNE    PLAYERV5
     926 00004e40     1fe7          BTST    BPUP,A7
     927 00004e50     ca04          JREQ    PLAYERV1
     928 00004e60     0bee          SUBI    00C00H,A14      ;PUSHING UP, SUBTRACT FROM THE Z VEL.
         00004e70     f3ff  
     929 00004e80     0be0          SUBI    00C00H,A0       ;SUBTRACT FROM DOWNWARD VELOCITY
         00004e90     f3ff  
     930 00004ea0           PLAYERV1
     931 00004ea0     1fc7          BTST    BPDOWN,A7
     932 00004eb0     ca04          JREQ    PLAYERV2
     933 00004ec0     0b0e          ADDI    00C00H,A14      ;PULLING DOWN, ADD MORE Z VELOCITY
         00004ed0     0c00  
     934 00004ee0     0b00          ADDI    00C00H,A0       ;SUBTRACT FROM DOWNWARD VELOCITY
         00004ef0     0c00  
     935 00004f00           PLAYERV2
     936 00004f00     1f87          BTST    BPRYTE,A7
     937 00004f10     ca06          JREQ    PLAYERV3
     938 00004f20     0b01          ADDI    000C00H,A1      ;PUSHING RYTE, ADD MORE X VELOCITY
         00004f30     0c00  
     939 00004f40     0d3f          CALLR   NOY2FLIP
         00004f50     0504  
     940 00004f60     0d3f          CALLR   NOYLFLIP
         00004f70     04ea  
     941 00004f80           PLAYERV3
     942 00004f80     1fa7          BTST    BPLEFT,A7
     943 00004f90     ca06          JREQ    PLAYERV4
     944 00004fa0     0be1          SUBI    000C00H,A1      ;PUSHING LEFT, SUBRACT X VELOCITY
         00004fb0     f3ff  
     945 00004fc0     0d3f          CALLR   Y2FLIP
         00004fd0     04f4  
     946 00004fe0     0d3f          CALLR   YLFLIP
         00004ff0     04d9  
     947 00005000           PLAYERV4
     948 00005000     1f27          BTST    BPJUMP,A7
     949 00005010     ca02          JREQ    PLAYERV5
     950 00005020     0be0          SUBI    005000H,A0      ;SUBTRACT FROM DOWNWARD VELOCITY
         00005030     afff  
     951 00005040           PLAYERV5
     952 00005040     0b20          ADDI    00A000H,A0      ;SUBTRACT GRAVITY CONSTANT
         00005050 0000a000  
     953 00005070     b208          MOVE    A0,*A8(OYVEL),L
         00005080     0060  
     954 00005090     b204          MOVE    A0,*A4(OYVEL),L
         000050a0     0060  
     955 000050b0     b228          MOVE    A1,*A8(OXVEL),L
         000050c0     0040  
     956 000050d0     b224          MOVE    A1,*A4(OXVEL),L
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   25

         000050e0     0040  
     957 000050f0     b3c8          MOVE    A14,*A8(OZVEL),L
         00005100     00e0  
     958 00005110     b3c4          MOVE    A14,*A4(OZVEL),L
         00005120     00e0  
     959 00005130     4fc5          MOVE    A14,B5          ;KEEP HERE TO ADD
     960                    
     961 00005140           PLAYERNV
     962 00005140     4ca5          MOVE    A5,A5           ;DONE ANIMATING THIS FRAME
     963 00005150     ca03          JREQ    PLAYER2         ;YES
     964 00005160     1425          DEC     A5              ;CLICK ANOTHER TICK
     965 00005170     c000          JRUC    PLAYERE         ;NOW DO THE LEGS                 
         00005180     02aa  
     966                    
     967 00005190           PLAYER2 
     968                    *CHECK FOR INITIAL JUMP
     969 00005190     1fa9          BTST    BJUMP2,A9       ;JUMPING?
     970 000051a0     ca08          JREQ    PLAYER2A        ;YES, CONTINUE WITH IT
     971                    
     972 000051b0     1da9          BTST    BDEAD,A9
     973 000051c0     cb00          JRNE    PLAYX           ;DON'T FUCK WITH ANYTHING
         000051d0     02a7  
     974 000051e0     0d3f          CALLR   P2FRAME         ;LOAD NEXT FRAME NORMALLY               
         000051f0     0440  
     975 00005200     c817          JRC     PLAYER1A        ;BR = END OF LIST
     976 00005210     c000          JRUC    PLAYERE
         00005220     02a0  
     977 00005230           PLAYER2A
     978 00005230     1fc9          BTST    BJUMP1,A9       ;JUST FINISHED INITIAL JUMP FRAMES?
     979 00005240     ca4c          JREQ    PLAYER3         ;NO     
     980                    
     981 00005250     1da9          BTST    BDEAD,A9
     982 00005260     cb00          JRNE    PLAYX
         00005270     029d  
     983 00005280     0d3f          CALLR   P2FRAME         ;LOAD NEXT FRAME NORMALLY               
         00005290     0436  
     984 000052a0     c900          JRNC    PLAYERE         ;BR = END OF LIST
         000052b0     0297  
     985                    
     986 000052c0     0bc9          XORI    (MJUMP1+MJUMP2),A9      ;SET VELOCITY JUMP FLAG, CLEAR INITIAL FLAG
         000052d0 00000006  
     987 000052f0     09e0          MOVI    0FFF80000H,A0
         00005300 fff80000  
     988 00005320     b208          MOVE    A0,*A8(OYVEL),L
         00005330     0060  
     989 00005340     b204          MOVE    A0,*A4(OYVEL),L
         00005350     0060  
     990 00005360     182e          MOVK    1,A14                   ;SELECT JUMPING CORRECT FRAME
     991 00005370     c01e          JRUC    PLAYER1F                ;STUFF IT BABY
     992                    
     993                    *
     994                    *PLAYER JUMPING, TIME TO DOKTOR THE Y VELOCITY. IF THE JOYSTICK
     995                    *IS NOT UP OR DOWN, THE JUST ADD A GRAVITY CONSTANT. IF THE STICK IS
     996                    *UP, THEN SUBTRACT FROM THE DECEL. IF IT IS DOWN, THEN ADD TO THE DECEL. 
     997                    *THE Y LANDING LINE IS STORED IN A12.
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   26

     998 00005380           PLAYER1A:
     999 00005380     0d3f          CALLR   DLLINE          ;GET THE DISTANCE FROM LANDING LINE
         00005390     03f5  
    1000                    
    1001 000053a0     b700          MOVE    *A8(OYVEL),A0,L ;GRAB THE Y-VELOCITY
         000053b0     0060  
    1002 000053c0     c413          JRLT    PLAYER1B        ;BR = ON THE WAY UP
    1003                    
    1004 000053d0     184e          MOVK    2,A14           ;LOAD DEFAULT FRAME
    1005                    
    1006                    * PLAYER COMING DOWN
    1007 000053e0     0b61          CMPI    0180000H,A1
         000053f0 ffe7ffff  
    1008 00005410     c714          JRGT    PLAYER1F        ;BR = STILL WAY ABOVE LINE, LET HIM FIRE
    1009 00005420     5694          CLR     B4
    1010 00005430     0b61          CMPI    0120000H,A1
         00005440 ffedffff  
    1011 00005460     c713          JRGT    PLAYER1G        ;BR = STILL ABOVE LINE, BUT DON'T FIRE AGAIN
    1012                    
    1013 00005470     102e          INC     A14
    1014 00005480     5694          CLR     B4
    1015 00005490                   TEST    A1
    1016 000054a0     c70f          JRGT    PLAYER1G        ;BR = PLAYER BETWEEN LINE AND LANDING SPOT
    1017                    
    1018                    * PLAYER HIT THE GROUND
    1019 000054b0     102e          INC     A14
    1020 000054c0     0b89          ANDNI   MJUMP2,A9       ;CLEAR LAST JUMP FLAG
         000054d0 00000004  
    1021 000054f0     c00a          JRUC    PLAYER1G        ;EXIT, END OF JUMP 
    1022                    
    1023                    * PLAYER ON THE WAY UP
    1024 00005500           PLAYER1B
    1025 00005500     182e          MOVK    1,A14           ;DEFAULT UPWARD FRAMES
    1026 00005510     0b61          CMPI    0120000H,A1
         00005520 ffedffff  
    1027 00005540     c601          JRLE    PLAYER1F        ;BR = STILL BELOW LINE, KEEP SAME FRAME
    1028 00005550     102e          INC     A14             ;INCREMENT FOR NEXT FRAME
    1029 00005560           PLAYER1F
    1030 00005560     0d3f          CALLR   FYRCHEK                 ;CHECK FOR FIRING
         00005570     02e9  
    1031 00005580     c901          JRNC    PLAYER1G                ;DON'T FIRE THIS TIME
    1032 00005590     10b4          ADDK    JFOFFSET,B4             ;FEED THE OFFSET
    1033 000055a0           PLAYER1G
    1034 000055a0     1d29          BTST    BDHOLD,A9
    1035 000055b0     cb00          JRNE    PLAYX           ;DON'T STUFF NEW FRAMES ON HOLD
         000055c0     0268  
    1036 000055d0     24ae          SLL     5,A14           ;INDEX INTO JUMPING FRAMES               
    1037 000055e0     1840          MOVK    JUMPFRM,A0      ;JUMPING FRAME OFFSET                    
    1038 000055f0     4ec0          MOVE    A6,B0                                                    
    1039 00005600     0d5f          CALLA   BASFRM                                                   
         00005610 00000000! 
    1040 00005630     41c6          ADD     A14,A6                                                   
    1041 00005640     86cd          MOVE    *A6,A13,L               ;LOAD PROPER LEG FRAME                   
    1042 00005650     b3a2          MOVE    A13,*A2(PLEGAS),L       ;HOLD
         00005660     0160  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   27

    1043 00005670     18b3          MOVK    JTOFFSET,B3
    1044 00005680     4093          ADD     B4,B3           ;ADD INCASE OF FIRING
    1045 00005690     4e70          MOVE    B3,A0
    1046 000056a0     24a0          SLL     5,A0
    1047 000056b0     4006          ADD     A0,A6
    1048 000056c0     86cb          MOVE    *A6,A11,L       ;LOAD PROPER TORSO FRAME        
    1049 000056d0     4e16          MOVE    B0,A6                                                    
    1050 000056e0     5663          CLR     A3
    1051 000056f0     c000          JRUC    PLAYX           ;AND GET OUT
         00005700     0254  
    1052                    
    1053                    *PROCESS NEXT FRAME ON THE CURRENT ANIMATION LIST
    1054 00005710           PLAYER3
    1055 00005710     4d20          MOVE    A9,A0
    1056 00005720     2e00          SRL     16,A0           ;SLIDE FOR SEPERATION
    1057 00005730     0b80          ANDI    (MDEAD|MFHOLD|MDHOLD),A0
         00005740 ffffff3b  
    1058 00005760     cb00          JRNE    PLAYX           ;SOMETHING'S GOING ON, HOLD ON
         00005770     024d  
    1059                    
    1060 00005780     4d20          MOVE    A9,A0
    1061 00005790     0b80          ANDI    MDRIVER|MPASSEN,A0
         000057a0 ffffe7ff  
    1062 000057c0     cb04          JRNE    PLAYER3A        ;SKIP Z RESET IF IN THE CAR
    1063 000057d0     0d3f          CALLR   PIRQZRST        ;RESET THAT BADDOG
         000057e0     0330  
    1064 000057f0     0d3f          CALLR   PFLIPCK         ;MAKE SURE THE FLIP OF THE PLAYER IS CORRECT
         00005800     035d  
    1065 00005810           PLAYER3A
    1066 00005810     0d3f          CALLR   P2FRAME         ;LOAD NEXT FRAME NORMALLY               
         00005820     03dd  
    1067 00005830     c900          JRNC    PLAYERE         ;BR = NOT, IN FACT, END OF LIST
         00005840     023e  
    1068                    *CHECK TO SEE IF HE'S A DRIVER
    1069 00005850           PLAYER4
    1070 00005850     1e89          BTST    BDRIVER,A9
    1071 00005860     ca00          JREQ    PLAYER5
         00005870     00a6  
    1072 00005880     07a1          MOVE    @PLAYCAR,A1,L   
         00005890 00000000! 
    1073 000058b0     cb02          JRNZ    PLAYER4IC
    1074 000058c0     5600          CLR     A0
    1075 000058d0     c002          JRUC    PLAYER4NP
    1076 000058e0           PLAYER4IC
    1077 000058e0     b620          MOVE    *A1(OPLINK),A0,L
         000058f0     01f0  
    1078 00005900           PLAYER4NP
    1079 00005900     1f27          BTST    BPJUMP,A7               ;JUMP BUTTON ONLY?
    1080 00005910     ca03          JREQ    PLAYER4NJ               ;BR = NO JUMP BUTTON
    1081 00005920     1ee9          BTST    BJHOLD,A9               ;CURRENTLY HOLDING LAST ONE?    
    1082 00005930     cb04          JRNE    PLAYER400               ;BR = YES, JUST DO NORMAL STUFF
    1083 00005940     c044          JRUC    PLAYER4B                ;JUMP OUT OF CAR S.V.P.
    1084 00005950           PLAYER4NJ
    1085 00005950     0b89          ANDNI   MJHOLD,A9               ;CLEAR JUMP ONESHOT
         00005960 00000100  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   28

    1086 00005980           PLAYER400
    1087 00005980     4c00          MOVE    A0,A0
    1088 00005990     ca02          JRZ     PLAYER4NS
    1089 000059a0     b0e0          MOVE    A7,*A0(ESWTCH),W        ;STUFF SWITCHES TO THE CAR
         000059b0     00e0  
    1090 000059c0           PLAYER4NS
    1091 000059c0     0d3f          CALLR   FYRCHEK
         000059d0     02a3  
    1092 000059e0     c92f          JRNC    PLAYER4A                ;BR = NO DRIVER FIRING
    1093 000059f0     1f69          BTST    BROCKET,A9
    1094 00005a00     cb0f          JRNE    PLAYR4A3                ;ALWAYS FIRE THE ROCKET FROM THIS SIDE
    1095 00005a10     b44e          MOVE    *A2(PFIRENXT),A14,W
         00005a20     02f0  
    1096 00005a30     ca06          JRZ     PLAYR4A1
    1097 00005a40     57ce          CLR     A14
    1098 00005a50     b1c2          MOVE    A14,*A2(PFIRENXT),W
         00005a60     02f0  
    1099 00005a70     b60a          MOVE    *A0(EDRIVXY),A10,L
         00005a80     00a0  
    1100 00005a90     c013          JRUC    PLAYR4A2
    1101 00005aa0           PLAYR4A1
    1102 00005aa0     182e          MOVK    1,A14
    1103 00005ab0     b1c2          MOVE    A14,*A2(PFIRENXT),W
         00005ac0     02f0  
    1104 00005ad0     b60a          MOVE    *A0(EPASSXY),A10,L      ;GET THE OFFSET
         00005ae0     00c0  
    1105 00005af0     c00d          JRUC    PLAYR4A2
    1106 00005b00           PLAYR4A3
    1107 00005b00     b60a          MOVE    *A0(EDRIVRB),A10,L
         00005b10     0140  
    1108 00005b20     b420          MOVE    *A1(OID),A0,W
         00005b30     01a0  
    1109 00005b40     0b40          CMPI    TRAN2OID,A0
         00005b50     f3bf  
    1110 00005b60     cb06          JRNE    PLAYR4A2
    1111 00005b70     09c0          MOVI    46,A0                   ;DROP A BOMB
         00005b80     002e  
    1112 00005b90     0d3f          CALLR   INCFP2
         00005ba0     0263  
    1113 00005bb0     0d3f          CALLR   PSTAKP
         00005bc0     0267  
    1114 00005bd0           PLAYR4A2
    1115 00005bd0     09c0          MOVI    34,A0
         00005be0     0022  
    1116 00005bf0     0d3f          CALLR   INCFP2
         00005c00     025d  
    1117 00005c10     0d3f          CALLR   PSTAKP
         00005c20     0261  
    1118                    *SELECT CORRECT VEHICLE DRIVER FIRING FRAME
    1119 00005c30     b420          MOVE    *A1(OID),A0,W
         00005c40     01a0  
    1120 00005c50     0b40          CMPI    TRAN2OID,A0
         00005c60     f3bf  
    1121 00005c70     cb03          JRNE    PLAYER4A20
    1122 00005c80     1b40          MOVK    PILOTFIRE,A0
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   29

    1123 00005c90     c000          JRUC    PLAYER5C
         00005ca0     00bd  
    1124 00005cb0           PLAYER4A20
    1125 00005cb0     1aa0          MOVK    DRIVFIRE,A0
    1126 00005cc0     c000          JRUC    PLAYER5C
         00005cd0     00ba  
    1127                    *SELECT CORRECT VEHICLE DRIVING FRAME
    1128 00005ce0           PLAYER4A
    1129 00005ce0     b420          MOVE    *A1(OID),A0,W
         00005cf0     01a0  
    1130 00005d00     0b40          CMPI    TRAN2OID,A0
         00005d10     f3bf  
    1131 00005d20     cb03          JRNE    PLAYER4A0
    1132 00005d30     1b00          MOVK    PILOTFRM,A0
    1133 00005d40     c000          JRUC    PLAYER5C
         00005d50     00b2  
    1134 00005d60           PLAYER4A0
    1135 00005d60     19e0          MOVK    DRIVLFRM,A0
    1136 00005d70     c000          JRUC    PLAYER5C
         00005d80     00af  
    1137                    *DRIVER JUMP OUT OF VEHICLE
    1138 00005d90           PLAYER4B
    1139 00005d90     4c21          MOVE    A1,A1
    1140 00005da0     ca13          JRZ     PLAYER4C
    1141 00005db0     4f00          MOVE    A8,B0
    1142 00005dc0     5708          CLR     A8
    1143 00005dd0     0d5f          CALLA   PUTA8
         00005de0 00000000! 
    1144 00005e00     4e18          MOVE    B0,A8
    1145 00005e10           PLAYER40
    1146 00005e10     b420          MOVE    *A1(OZMINUS),A0,W
         00005e20     01b0  
    1147 00005e30     b42e          MOVE    *A1(OZPOS),A14,W
         00005e40     00d0  
    1148 00005e50     440e          SUB     A0,A14
    1149 00005e60     168e          SUBK    20,A14
    1150 00005e70     05a0          MOVE    @PLZMIN,A0,W
         00005e80 00000000! 
    1151 00005ea0     480e          CMP     A0,A14
    1152 00005eb0     c458          JRLT    PLAYER50
    1153 00005ec0     b1c8          MOVE    A14,*A8(OZPOS),W
         00005ed0     00d0  
    1154                    *
    1155                    *PLAYER EXIT FROM CAR BY JUMPING
    1156 00005ee0           PLAYER4C
    1157 00005ee0     0d3f          CALLR   PLALIGN                 ;RE-ALIGN THE LEGS, AND LITE THEM
         00005ef0     02fc  
    1158 00005f00     0d5f          CALLA   PTORSON
         00005f10 00000000! 
    1159 00005f30     0d5f          CALLA   PLEGON
         00005f40 00000000! 
    1160 00005f60     09c0          MOVI    36,A0
         00005f70     0024  
    1161 00005f80     0d3f          CALLR   INCFP2
         00005f90     0224  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   30

    1162 00005fa0     0d3f          CALLR   PSTAKP                  ;CREATE TSHADST
         00005fb0     0228  
    1163 00005fc0     09c0          MOVI    40,A0
         00005fd0     0028  
    1164 00005fe0     0d3f          CALLR   INCFP2
         00005ff0     021e  
    1165 00006000     0d3f          CALLR   PSTAKP                  ;CREATE LSHADST
         00006010     0222  
    1166                    
    1167 00006020     0ba9          ORI     MJUMP1|MJHOLD,A9        ;FLAG INITIAL JUMP
         00006030 00000102  
    1168 00006050     0b89          ANDNI   MDRIVER|MPASSEN,A9      ;KILL THE DRIVER AND PASSENGER FLAGS
         00006060 00001800  
    1169 00006080     0d3f          CALLR   PLSTOPYZ                ;WE'LL ADD OUR OWN
         00006090     03cc  
    1170 000060a0     4ec0          MOVE    A6,B0                                                    
    1171 000060b0     1840          MOVK    JUMPFRM,A0
    1172 000060c0     0d5f          CALLA   BASFRM                                                   
         000060d0 00000000! 
    1173 000060f0     86cd          MOVE    *A6,A13,L               ;LOAD PROPER LEG FRAME                   
    1174 00006100     b3a2          MOVE    A13,*A2(PLEGAS),L       ;HOLD FOR WRAP
         00006110     0160  
    1175 00006120     18a0          MOVK    JTOFFSET,A0
    1176 00006130     24a0          SLL     5,A0
    1177 00006140     4006          ADD     A0,A6
    1178 00006150     86cb          MOVE    *A6,A11,L       ;LOAD PROPER TORSO FRAME        
    1179 00006160     4e16          MOVE    B0,A6                                                    
    1180 00006170     5663          CLR     A3              ;CLR LEG TICKS FOR SYNC.
    1181 00006180     0d3f          CALLR   P2FRAME
         00006190     0346  
    1182 000061a0     0d3f          CALLR   PLAYLEG
         000061b0     0216  
    1183 000061c0     b70c          MOVE    *A8(OYVAL),A12,L        ;KEEP OUR LANDING LINE
         000061d0     00a0  
    1184 000061e0     b700          MOVE    *A8(OIMG),A0,L
         000061f0     0180  
    1185 00006200     b400          MOVE    *A0(IANIOFF+16),A0,W
         00006210     0030  
    1186 00006220     2600          SLL     16,A0
    1187 00006230     400c          ADD     A0,A12                  ;ADJUST FOR ANIMATION POINT
    1188                    ***     ADD     A14,A12                 ;THROW IN SOME FUDGE
    1189 00006240     4d00          MOVE    A8,A0
    1190 00006250     4c88          MOVE    A4,A8
    1191 00006260     0d5f          CALLA   DFRMGRND
         00006270 00000000! 
    1192 00006290     4c08          MOVE    A0,A8
    1193 000062a0     2601          SLL     16,A1
    1194 000062b0     402c          ADD     A1,A12                  ;ADD IN A HEIGHT FACTOR
    1195 000062c0     c000          JRUC    PLAYX
         000062d0     0197  
    1196                    *CHECK TO SEE IF HE'S A PASSENGER
    1197 000062e0           PLAYER5
    1198 000062e0     1e69          BTST    BPASSEN,A9
    1199 000062f0     ca00          JREQ    PLAYER5E                ;NO HE'S NOT A PASSENGER EITHER
         00006300     0092  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   31

    1200 00006310     07a1          MOVE    @PLAYCAR,A1,L   
         00006320 00000000! 
    1201 00006340     cb02          JRNZ    PLAYER5IC
    1202 00006350     5600          CLR     A0
    1203 00006360     c002          JRUC    PLAYER5NP
    1204 00006370           PLAYER5IC
    1205 00006370     b620          MOVE    *A1(OPLINK),A0,L
         00006380     01f0  
    1206 00006390           PLAYER5NP
    1207 00006390     1f27          BTST    BPJUMP,A7               ;JUMP BUTTON ONLY?
    1208 000063a0     ca12          JREQ    PLAYER5A                ;BR = NO BUTTON, CONTINUE IN THE CAR
    1209 000063b0     1ee9          BTST    BJHOLD,A9
    1210 000063c0     cb13          JRNE    PLAYER5A0               ;STILL HOLDING THE LAST JUMP
    1211 000063d0     4c21          MOVE    A1,A1
    1212 000063e0     caaf          JRZ     PLAYER4C                ;BR = NO CAR PROCESS IS LEFT, FUCK IT   
    1213 000063f0     4f00          MOVE    A8,B0
    1214 00006400     5708          CLR     A8
    1215 00006410     b300          MOVE    A8,*A0(PASSPTR),L       ;TEAR HIM AWAY FROM THE CAR
         00006420     0260  
    1216 00006430     4e18          MOVE    B0,A8
    1217 00006440           PLAYER50
    1218 00006440     b420          MOVE    *A1(OZPLUS),A0,W
         00006450     01c0  
    1219 00006460     b42e          MOVE    *A1(OZPOS),A14,W
         00006470     00d0  
    1220 00006480     400e          ADD     A0,A14
    1221 00006490     10ae          ADDK    5,A14
    1222 000064a0     b1c8          MOVE    A14,*A8(OZPOS),W
         000064b0     00d0  
    1223 000064c0     c0a1          JRUC    PLAYER4C
    1224                    
    1225 000064d0           PLAYER5A
    1226 000064d0     0b89          ANDNI   MJHOLD,A9
         000064e0 00000100  
    1227 00006500           PLAYER5A0
    1228 00006500     0d3f          CALLR   FYRCHEK
         00006510     01ef  
    1229 00006520     c92d          JRNC    PLAYER5B                ;BR = NO PASSENGER FIRING
    1230 00006530     1f69          BTST    BROCKET,A9
    1231 00006540     cb0f          JRNE    PLAYR5A3                ;ALWAYS FIRE THE ROCKET FROM THIS SIDE
    1232 00006550     b44e          MOVE    *A2(PFIRENXT),A14,W
         00006560     02f0  
    1233 00006570     ca06          JRZ     PLAYR5A1
    1234 00006580     57ce          CLR     A14
    1235 00006590     b1c2          MOVE    A14,*A2(PFIRENXT),W
         000065a0     02f0  
    1236 000065b0     b60a          MOVE    *A0(EDRIVXY),A10,L
         000065c0     00a0  
    1237 000065d0     c013          JRUC    PLAYR5A2
    1238 000065e0           PLAYR5A1
    1239 000065e0     182e          MOVK    1,A14
    1240 000065f0     b1c2          MOVE    A14,*A2(PFIRENXT),W
         00006600     02f0  
    1241 00006610     b60a          MOVE    *A0(EPASSXY),A10,L      ;GET THE OFFSET
         00006620     00c0  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   32

    1242 00006630     c00d          JRUC    PLAYR5A2
    1243 00006640           PLAYR5A3
    1244 00006640     b60a          MOVE    *A0(EPASSRB),A10,L      ;GET THE OFFSET
         00006650     0160  
    1245 00006660     b420          MOVE    *A1(OID),A0,W
         00006670     01a0  
    1246 00006680     0b40          CMPI    TRAN2OID,A0
         00006690     f3bf  
    1247 000066a0     cb06          JRNE    PLAYR5A2
    1248 000066b0     09c0          MOVI    46,A0                   ;DROP A BOMB
         000066c0     002e  
    1249 000066d0     0d3f          CALLR   INCFP2
         000066e0     01af  
    1250 000066f0     0d3f          CALLR   PSTAKP
         00006700     01b3  
    1251 00006710           PLAYR5A2
    1252 00006710     09c0          MOVI    34,A0
         00006720     0022  
    1253 00006730     0d3f          CALLR   INCFP2
         00006740     01a9  
    1254 00006750     0d3f          CALLR   PSTAKP
         00006760     01ad  
    1255                    *SELECT CORRECT PASSENGER FIRING FRAME
    1256 00006770     b420          MOVE    *A1(OID),A0,W
         00006780     01a0  
    1257 00006790     0b40          CMPI    TRAN2OID,A0
         000067a0     f3bf  
    1258 000067b0     cb02          JRNE    PLAYER5A20
    1259 000067c0     1b60          MOVK    HELPFIRE,A0
    1260 000067d0     c00a          JRUC    PLAYER5C
    1261 000067e0           PLAYER5A20
    1262 000067e0     1ac0          MOVK    PASSFIRE,A0
    1263 000067f0     c008          JRUC    PLAYER5C
    1264                    *SELECT CORRECT PASSENGER FRAME
    1265 00006800           PLAYER5B
    1266 00006800     b420          MOVE    *A1(OID),A0,W
         00006810     01a0  
    1267 00006820     0b40          CMPI    TRAN2OID,A0
         00006830     f3bf  
    1268 00006840     cb02          JRNE    PLAYER5B0
    1269 00006850     1b20          MOVK    HELPASFRM,A0
    1270 00006860     c001          JRUC    PLAYER5C
    1271 00006870           PLAYER5B0
    1272 00006870     1a20          MOVK    PASSLFRM,A0
    1273                    *CHECK TO SEE IF WE SHOULD RE-ADJUST FOR CAR
    1274 00006880           PLAYER5C
    1275 00006880     1e49          BTST    BSITIN,A9
    1276 00006890     ca48          JREQ    PDEFAULT2
    1277 000068a0     0b89          ANDNI   MSITIN,A9               ;NO MORE SITTING BULL
         000068b0 00002000  
    1278 000068d0     098f          MMTM    SP,A0,A2,A3,A4
         000068e0     b800  
    1279                    
    1280 000068f0     b704          MOVE    *A8(OYVAL),A4,L         ;GET Y PLAYER Y ANIMATION PNT
         00006900     00a0  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   33

    1281 00006910     b700          MOVE    *A8(OIMG),A0,L
         00006920     0180  
    1282 00006930     b400          MOVE    *A0(IANIOFF+16),A0,W
         00006940     0030  
    1283 00006950     2600          SLL     16,A0
    1284 00006960     4004          ADD     A0,A4                   ;ADJUST FOR ANIMATION POINT
    1285 00006970     4f00          MOVE    A8,B0
    1286 00006980     07a8          MOVE    @PLAYCAR,A8,L
         00006990 00000000! 
    1287 000069b0     cb04          JRNZ    PLAYER5CG
    1288 000069c0     4e18          MOVE    B0,A8
    1289 000069d0     09af          MMFM    SP,A0,A2,A3,A4
         000069e0     001d  
    1290 000069f0     c01f          JRUC    PLAYER5CX
    1291 00006a00           PLAYER5CG
    1292 00006a00     0d5f          CALLA   GETANIXY                ;GET THE VEHICLE ANIMATION PNT.
         00006a10 00000000! 
    1293 00006a30     4444          SUB     A2,A4                   ;FORM OFFSET FOR RESTORE
    1294 00006a40     4e10          MOVE    B0,A0
    1295 00006a50     4e80          MOVE    A4,B0
    1296 00006a60     b504          MOVE    *A8(OFLAGS),A4,W        ;GET THE FLAGS FROM THE CAR
         00006a70     0100  
    1297 00006a80     0d5f          CALLA   GANISAG                 ;AND RE-ADJUST
         00006a90 00000000! 
    1298 00006ab0     b702          MOVE    *A8(OZVAL),A2,L
         00006ac0     00c0  
    1299 00006ad0     b503          MOVE    *A8(OID),A3,W
         00006ae0     01a0  
    1300 00006af0     0b43          CMPI    TRAN2OID,A3
         00006b00     f3bf  
    1301 00006b10     cb02          JRNE    PLAYER5C0
    1302 00006b20     1422          DEC     A2
    1303 00006b30     c001          JRUC    PLAYER5C1
    1304 00006b40           PLAYER5C0
    1305 00006b40     1022          INC     A2                      ;RE-POSITION PROPERLY
    1306 00006b50           PLAYER5C1
    1307 00006b50     b240          MOVE    A2,*A0(OZVAL),L
         00006b60     00c0  
    1308 00006b70     4c08          MOVE    A0,A8
    1309 00006b80     09af          MMFM    SP,A2,A3,A4
         00006b90     001c  
    1310 00006ba0     4e10          MOVE    B0,A0
    1311 00006bb0     b202          MOVE    A0,*A2(PCAROFFY),L      ;SHOVE THE OFFSET FOR CAR EXIT
         00006bc0     02d0  
    1312 00006bd0                   PULL    A0
    1313 00006bf0           PLAYER5CX
    1314 00006bf0     0d5f          CALLA   PLEGOFF
         00006c00 00000000! 
    1315 00006c20     c00f          JRUC    PDEFAULT2
    1316                    
    1317                    *CHECK THE PLAYER SWITCHES
    1318 00006c30           PLAYER5E
    1319 00006c30     0b89          ANDNI   MUNLIMIT,A9             ;TURN OFF UNLIMITED ROCKETS FOR CHOPPER
         00006c40 00004000  
    1320 00006c60     0b47          CMPI    0,A7                    ;ANY SWITCHES?
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   34

         00006c70     ffff  
    1321 00006c80     cb15          JRNE    PLAYER6                 ;THERE BE DATA
    1322 00006c90     0b89          ANDNI   MRUN|MSWALK|MRHOLD|MCHOLD|MJHOLD,A9     ;CLEAR 1 SHOT FLAGS
         00006ca0 000003e0  
    1323 00006cc0           PDEFAULT
    1324 00006cc0     0ba9          ORI     MIDLE,A9                ;SET THE IDLE FLAG
         00006cd0 00000001  
    1325 00006cf0     1860          MOVK    STANDLEG,A0             ;WE ARE STANDING
    1326 00006d00           PDEFAULT1
    1327 00006d00     0d3f          CALLR   PLSTOP                  ;STOP THE GUY
         00006d10     02ac  
    1328 00006d20           PDEFAULT2
    1329 00006d20     4ec0          MOVE    A6,B0
    1330 00006d30     0d5f          CALLA   BASFRM                  ;GET THE LEG SCRIPT POINTER     
         00006d40 00000000! 
    1331 00006d60     96cd          MOVE    *A6+,A13,L
    1332 00006d70     b3a2          MOVE    A13,*A2(PLEGAS),L       ;STORE HERE FOR A RESET
         00006d80     0160  
    1333 00006d90     5663          CLR     A3                      ;CLEAR LEG TICKS FOR SURE
    1334 00006da0     86cb          MOVE    *A6,A11,L               ;NOW THE TORSO
    1335 00006db0     4e16          MOVE    B0,A6
    1336 00006dc0     c000          JRUC    PLAYX                   ;AND GET OUT
         00006dd0     00e7  
    1337                    
    1338 00006de0     0b89  PLAYER6 ANDNI   MIDLE,A9                ;CLEAR THE IDLE FLAG
         00006df0 00000001  
    1339                    *CHECK FOR GUN ACTION
    1340 00006e10     0d3f          CALLR   FYRCHEK                 ;CHECK FOR FIRING
         00006e20     015e  
    1341 00006e30     c901          JRNC    PLAYERA                 ;DON'T FIRE THIS TIME
    1342 00006e40     10b4          ADDK    FOFFSET,B4              ;FEED THE OFFSET
    1343                    
    1344                    *JOYSTICK MOVEMENT PROCESSING
    1345 00006e50     09e1  PLAYERA MOVI    STIKTAB,A1              ;USE A JUMP TABLE
         00006e60 00007fe0' 
    1346 00006e80     4ce0          MOVE    A7,A0
    1347 00006e90     2780          SLL     28,A0                   ;MASK OFF THE BUTTONS
    1348 00006ea0     2d20          SRL     23,A0                   ;MULTIPLY BY 32
    1349 00006eb0     4001          ADD     A0,A1                   
    1350 00006ec0     8620          MOVE    *A1,A0,L
    1351 00006ed0     0160          JUMP    A0                      ;DO THE RIGHT STUFF
    1352                    
    1353                    *CASE:  JOYSTICK UP
    1354 00006ee0           PLAYERUP
    1355 00006ee0     b641          MOVE    *A2(PYVEL),A1,L
         00006ef0     0370  
    1356 00006f00     03a1          NEG     A1
    1357 00006f10     5600          CLR     A0
    1358 00006f20     1832          MOVK    UPFRAME,B2
    1359 00006f30     c02b          JRUC    PLAYERB
    1360                    *CASE:  JOYSTICK DOWN
    1361 00006f40           PLAYERDN
    1362 00006f40     b641          MOVE    *A2(PYVEL),A1,L
         00006f50     0370  
    1363 00006f60     5600          CLR     A0
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   35

    1364 00006f70     1892          MOVK    DNFRAME,B2
    1365 00006f80     c026          JRUC    PLAYERB
    1366                    *CASE:  JOYSTICK LEFT
    1367 00006f90           PLAYERLF
    1368 00006f90     5621          CLR     A1
    1369 00006fa0     b640          MOVE    *A2(PXVEL),A0,L
         00006fb0     0350  
    1370 00006fc0     03a0          NEG     A0
    1371                    ***     CALLR   Y2FLIP
    1372                    ***     CALLR   YLFLIP                  ;FLIP LEGS
    1373 00006fd0     5652          CLR     B2                      ;MOVK   LRFRAME,B2
    1374 00006fe0     c020          JRUC    PLAYERB
    1375                    *CASE:  JOYSTICK RIGHT
    1376 00006ff0           PLAYERRT
    1377 00006ff0     5621          CLR     A1
    1378 00007000     b640          MOVE    *A2(PXVEL),A0,L
         00007010     0350  
    1379                    ***     CALLR   NOY2FLIP
    1380                    ***     CALLR   NOYLFLIP                        ;LEGS
    1381 00007020     5652          CLR     B2                      ;MOVK   LRFRAME,B2
    1382 00007030     c01b          JRUC    PLAYERB
    1383                    *CASE:  JOYSTICK UP & LEFT
    1384 00007040           PLAYERUL
    1385 00007040     b641          MOVE    *A2(PYVEL),A1,L
         00007050     0370  
    1386 00007060     03a1          NEG     A1
    1387 00007070     b640          MOVE    *A2(PXVEL),A0,L
         00007080     0350  
    1388 00007090     03a0          NEG     A0
    1389                    ***     CALLR   Y2FLIP
    1390                    ***     CALLR   YLFLIP                  
    1391 000070a0     1852          MOVK    UPQFRAME,B2     
    1392 000070b0     c013          JRUC    PLAYERB
    1393                    *CASE:  JOYSTICK UP & RIGHT
    1394 000070c0           PLAYERUR
    1395 000070c0     b641          MOVE    *A2(PYVEL),A1,L
         000070d0     0370  
    1396 000070e0     03a1          NEG     A1
    1397 000070f0     b640          MOVE    *A2(PXVEL),A0,L
         00007100     0350  
    1398                    ***     CALLR   NOY2FLIP
    1399                    ***     CALLR   NOYLFLIP
    1400 00007110     1852          MOVK    UPQFRAME,B2
    1401 00007120     c00c          JRUC    PLAYERB 
    1402                    *CASE:  JOYSTICK DOWN & LEFT
    1403 00007130           PLAYERDL
    1404 00007130     b641          MOVE    *A2(PYVEL),A1,L
         00007140     0370  
    1405 00007150     b640          MOVE    *A2(PXVEL),A0,L
         00007160     0350  
    1406 00007170     03a0          NEG     A0
    1407                    ***     CALLR   Y2FLIP
    1408                    ***     CALLR   YLFLIP
    1409 00007180     1872          MOVK    DNQFRAME,B2
    1410 00007190     c005          JRUC    PLAYERB
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   36

    1411                    *CASE:  JOYSTICK DOWN & RIGHT
    1412 000071a0           PLAYERDR
    1413 000071a0     b641          MOVE    *A2(PYVEL),A1,L
         000071b0     0370  
    1414 000071c0     b640          MOVE    *A2(PXVEL),A0,L
         000071d0     0350  
    1415                    ***     CALLR   NOY2FLIP
    1416                    ***     CALLR   NOYLFLIP
    1417 000071e0     1872          MOVK    DNQFRAME,B2
    1418                    
    1419                    *STUFF VELOCITIES FROM THE JOYSTICK PROCESSOR
    1420 000071f0           PLAYERB
    1421 000071f0     0d3f          CALLR   STUFLVEL                ;STUFF ALL VELOCITIES
         00007200     016a  
    1422 00007210     5600          CLR     A0                      ;MOVK   WALKFRM,A0 ;OFFSET FOR LEGS
    1423 00007220     18b3          MOVK    TOFFSET,B3              ;OFFSET FOR TORSO
    1424                    *
    1425                    *CHECK JUMP BUTTON, THIS TEST IS INITIATED AFTER JOYSTICK PROCESSING
    1426 00007230     1f27          BTST    BPJUMP,A7               ;IS THE JUMP BUTTON PRESSED
    1427 00007240     ca03          JREQ    PLAYERNJ                ;BR = NO, TRY SQUAT
    1428 00007250     1ee9          BTST    BJHOLD,A9               ;CURRENTLY IN ONE SHOT MODE
    1429 00007260     ca45          JREQ    PLAYERC6                ;BR = NO, GO AHEAD AND JUMP
    1430 00007270     c003          JRUC    PLAYRCCK
    1431 00007280           PLAYERNJ
    1432 00007280     0b89          ANDNI   MJHOLD,A9               ;TURN OFF JUMP 1 SHOT
         00007290 00000100  
    1433                    *
    1434                    *CHECK CROUCH BUTTON AFTER JOYSTICK PROCESSING
    1435 000072b0           PLAYRCCK
    1436 000072b0     1f67          BTST    BPCROUCH,A7             ;CROUCH BUTTON?
    1437 000072c0     cb04          JRNE    PLAYERCR
    1438 000072d0     0b89          ANDNI   MCHOLD|MSWALK|MRUN,A9   ;TURN OFF WALK AND RUN FLAGS
         000072e0 000000e0  
    1439 00007300     c00e          JRUC    PLAYRB2A                ;NOW TRY TO WALK
    1440 00007310           PLAYERCR
    1441 00007310     1f09          BTST    BCHOLD,A9
    1442 00007320     ca04          JREQ    PLAYRB1B                ;BR = VIRGIN BUTTON
    1443                    ****>   BTST    BRUN,A9
    1444                    ****>   JRNE    PLAYRB2A                ;BR = PLAYER IN RUN MODE
    1445 00007330           PLAYRB1A
    1446 00007330     1f29          BTST    BSWALK,A9
    1447 00007340     ca64          JREQ    PLAYERD                 ;BR = NOT SQUAT WALKING
    1448                    
    1449 00007350     1820          MOVK    SQTWFRM,A0              ;SQUAT THIS GUY
    1450 00007360     c062          JRUC    PLAYERD                 ;ATTEMPT TO WALK
    1451                    *
    1452                    *VIRGIN JUMP, DETERMINE WHAT TYPE
    1453 00007370           PLAYRB1B
    1454 00007370     0ba9          ORI     MCHOLD,A9               ;POP THAT SUCKER
         00007380 00000080  
    1455                    ****>   BTST    BPDOWN,A7               ;HOLDING DOWN?
    1456                    ****>   JREQ    PLAYERB2                ;BR = NO!
    1457 000073a0     0ba9          ORI     MSWALK,A9               ;SET US INTO SQUAT WALK MODE
         000073b0 00000040  
    1458 000073d0           PLAYRB1C
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   37

    1459 000073d0     1820          MOVK    SQTWFRM,A0              ;SQUAT THIS GUY
    1460 000073e0     c05a          JRUC    PLAYERD                 ;ATTEMPT TO WALK
    1461 000073f0           PLAYERB2
    1462                    ****>   ORI     MRUN,A9
    1463 000073f0           PLAYRB2A
    1464 000073f0     4e00          MOVE    A0,B0
    1465 00007400     b700          MOVE    *A8(OXVEL),A0,L         ;SPEED THE GUY UP
         00007410     0040  
    1466 00007420     b701          MOVE    *A8(OYVEL),A1,L
         00007430     0060  
    1467 00007440     2020          SLA     1,A0
    1468 00007450     2021          SLA     1,A1                    ;VELS X TWO
    1469 00007460     0d3f          CALLR   STUFLVEL
         00007470     0143  
    1470 00007480     4e10          MOVE    B0,A0
    1471 00007490     c04f          JRUC    PLAYERD
    1472                    
    1473                    *CHECK CROUCH BUTTON, JUMPS TO BE PDEFAULT ON FAIL
    1474 000074a0           PLAYERC
    1475 000074a0     1f67          BTST    BPCROUCH,A7
    1476 000074b0     ca0a          JREQ    PLAYERJP
    1477                    
    1478                    ****>   BTST    BRUN,A9
    1479                    ****>   JRNE    PLAYERJ1
    1480 000074c0     0ba9          ORI     MCHOLD|MSWALK,A9        ;TURN ON ONE SHOT, AND SQUAT WALK
         000074d0 000000c0  
    1481 000074f0     18a0          MOVK    SQUATLEG,A0
    1482 00007500     1f27          BTST    BPJUMP,A7
    1483 00007510     cb18          JRNE    PLAYERC5
    1484 00007520     0b89          ANDNI   MJHOLD,A9
         00007530 00000100  
    1485 00007550     c009          JRUC    PLAYRC1C
    1486                    *CHECK JUMP BUTTON, LAST HOPE FOR ANY BUTTON, JUMPS TO BE PDEFAULT ON FAIL
    1487 00007560           PLAYERJP
    1488 00007560     0b89          ANDNI   MCHOLD|MSWALK|MRUN,A9   ;TURN OFF RUN AND SQUAT WALK STUFF      
         00007570 000000e0  
    1489 00007590           PLAYERJ1
    1490 00007590     1f27          BTST    BPJUMP,A7       ;JUMP BUTTON ONLY?
    1491 000075a0     cb0d          JRNE    PLAYERC3        ;BR = YES, JUMP AWAY
    1492 000075b0     0b89          ANDNI   MJHOLD,A9
         000075c0 00000100  
    1493                    *THERE WAS A BUTTON PRESSED, LET'S EFFECT THE FIRING FRAME CHANGES
    1494 000075e0           PLAYRC1B
    1495 000075e0     1860          MOVK    STANDLEG,A0     ;START HERE
    1496 000075f0           PLAYRC1C
    1497 000075f0                   TEST    B4              ;FIRE?
    1498 00007600     ca00          JREQ    PDEFAULT1       ;BR = NO
         00007610     ff6e  
    1499 00007620     14b4          SUBK    RBOFFSET,B4
    1500 00007630     c601          JRLE    PLAYRC1D
    1501 00007640     1080          ADDK    4,A0            ;ADD OFFSET FOR ROCKET BOMB FIRING
    1502 00007650           PLAYRC1D
    1503 00007650     1080          ADDK    4,A0
    1504 00007660     c000          JRUC    PDEFAULT1       ;LOAD ALL THIS SHIT.
         00007670     ff68  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   38

    1505                    
    1506                    *JUMP ENTRY WHEN STANDING STILL
    1507 00007680           PLAYERC3
    1508 00007680     1ee9          BTST    BJHOLD,A9
    1509 00007690     cbf4          JRNE    PLAYRC1B
    1510                    *JUMP ENTRY WHEN CROUCH BUTTON PRESSED
    1511 000076a0           PLAYERC5
    1512 000076a0     1ee9          BTST    BJHOLD,A9
    1513 000076b0     cbf3          JRNE    PLAYRC1C
    1514 000076c0           PLAYERC6
    1515 000076c0     0ba9          ORI     MJUMP1|MJHOLD,A9        ;FLAG INITIAL JUMP
         000076d0 00000102  
    1516 000076f0     0b89          ANDNI   MDRIVER|MPASSEN,A9      ;KILL THE DRIVER AND PASSENGER FLAGS
         00007700 00001800  
    1517 00007720     0d3f          CALLR   PLSTOPYZ                ;WE'LL ADD OUR OWN
         00007730     0262  
    1518 00007740     4ec0          MOVE    A6,B0                                                    
    1519 00007750     1840          MOVK    JUMPFRM,A0
    1520 00007760     0d5f          CALLA   BASFRM                                                   
         00007770 00000000! 
    1521 00007790     86cd          MOVE    *A6,A13,L               ;LOAD PROPER LEG FRAME                   
    1522 000077a0     b3a2          MOVE    A13,*A2(PLEGAS),L       ;HOLD FOR WRAP
         000077b0     0160  
    1523 000077c0     18a0          MOVK    JTOFFSET,A0
    1524 000077d0     24a0          SLL     5,A0
    1525 000077e0     4006          ADD     A0,A6
    1526 000077f0     86cb          MOVE    *A6,A11,L       ;LOAD PROPER TORSO FRAME        
    1527 00007800     4e16          MOVE    B0,A6                                                    
    1528 00007810     5663          CLR     A3              ;CLR LEG TICKS FOR SYNC.
    1529                    
    1530 00007820     b70c          MOVE    *A8(OYVAL),A12,L        ;KEEP OUR LANDING LINE
         00007830     00a0  
    1531 00007840     b700          MOVE    *A8(OIMG),A0,L
         00007850     0180  
    1532 00007860     b400          MOVE    *A0(IANIOFF+16),A0,W
         00007870     0030  
    1533 00007880     2600          SLL     16,A0
    1534 00007890     400c          ADD     A0,A12          ;ADJUST FOR ANIMATION POINT
    1535 000078a0     4d00          MOVE    A8,A0
    1536 000078b0     4c88          MOVE    A4,A8
    1537 000078c0     0d5f          CALLA   DFRMGRND
         000078d0 00000000! 
    1538 000078f0     4c08          MOVE    A0,A8
    1539 00007900     2201          SLA     16,A1
    1540 00007910     ce02          JRN     PLAYERC6A
    1541 00007920     ca01          JRZ     PLAYERC6A
    1542 00007930     402c          ADD     A1,A12          ;ADD IN A HEIGHT FACTOR
    1543 00007940           PLAYERC6A
    1544 00007940     0d3f          CALLR   P2FRAME
         00007950     01ca  
    1545 00007960     0d3f          CALLR   PLAYLEG
         00007970     009a  
    1546                    
    1547 00007980     c02c          JRUC    PLAYX
    1548                    
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   39

    1549                    *STUFF FRAMES
    1550 00007990           PLAYERD
    1551 00007990     4ec0          MOVE    A6,B0
    1552 000079a0     0d5f          CALLA   BASFRM  
         000079b0 00000000! 
    1553 000079d0     24b2          SLL     5,B2
    1554 000079e0     4e50          MOVE    B2,A0
    1555 000079f0     4006          ADD     A0,A6   
    1556 00007a00     86c0          MOVE    *A6,A0,L
    1557 00007a10     b641          MOVE    *A2(PLEGAS),A1,L        ;SAME WALKING FRAMES?
         00007a20     0160  
    1558 00007a30     4801          CMP     A0,A1
    1559 00007a40     ca05          JREQ    PLAYERD1                ;BR = YES, DON'T LOAD AGAIN
    1560                    
    1561 00007a50     4c0d          MOVE    A0,A13
    1562 00007a60     b3a2          MOVE    A13,*A2(PLEGAS),L       ;LOAD NEW SCRIPT
         00007a70     0160  
    1563 00007a80     4da1          MOVE    A13,A1                  ;FOR TORSO MATCH
    1564 00007a90     5663          CLR     A3                      ;BLOW OUT THE OLD
    1565                    *A1 = HEAD OF LEG ANIMATION SCRIPT, THIS IS A MUST HERE
    1566 00007aa0           PLAYERD1
    1567 00007aa0     0d3f          CALLR   PLAYLEG                 ;UPDATE THE LEGS
         00007ab0     0086  
    1568                    
    1569 00007ac0     4093          ADD     B4,B3                   ;LOAD THE NEW TORSO
    1570 00007ad0     4e70          MOVE    B3,A0
    1571 00007ae0     24a0          SLL     5,A0
    1572 00007af0     4006          ADD     A0,A6
    1573 00007b00     86cb          MOVE    *A6,A11,L               ;TORSO SCRIPT
    1574                    
    1575 00007b10                   TEST    B4
    1576 00007b20     cb0c          JRNE    PLAYERD3                ;HE'S FIRING, LEAVE ASYNC TORSO FRAMES
    1577                    
    1578 00007b30     4dae          MOVE    A13,A14
    1579 00007b40     0bee          SUBI    48,A14                  ;BACKUP TO WHAT WAS
         00007b50     ffcf  
    1580 00007b60     442e          SUB     A1,A14                  ;A0 = OFFSET TO CURRENT LEG FRAME
    1581 00007b70     ca07          JREQ    PLAYERD3                ;WE'RE THERE
    1582                    
    1583 00007b80     09c0          MOVI    48,A0
         00007b90     0030  
    1584 00007ba0     09c1          MOVI    80,A1
         00007bb0     0050  
    1585 00007bc0           PLAYERD2                                
    1586 00007bc0     402b          ADD     A1,A11                  ;UP/DOWN WE GO
    1587 00007bd0     440e          SUB     A0,A14
    1588 00007be0     cbfd          JRNE    PLAYERD2
    1589                            
    1590 00007bf0           PLAYERD3
    1591 00007bf0     4e16          MOVE    B0,A6                   ;RESTORE ANIMATION TABLE
    1592 00007c00     0d3f          CALLR   P2FRAME                 ;STUFF TO KEEP WITH CURRENT LEGS
         00007c10     019e  
    1593 00007c20     c002          JRUC    PLAYX
    1594 00007c30           PLAYERE
    1595 00007c30     0d3f          CALLR   PLAYLEG                 ;JUST DO THE LEGS
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   40

         00007c40     006d  
    1596                    *
    1597                    *PLAYER UPDATE END, ALWAYS COME HERE IF PLAYER IS ACTIVE
    1598 00007c50           PLAYX
    1599 00007c50     4d20          MOVE    A9,A0
    1600 00007c60     0b80          ANDI    MJUMP1|MJUMP2,A0
         00007c70 fffffff9  
    1601 00007c90     ca0d          JREQ    PLXNOSHD                ;BR = NOT JUMPING, NO SHADOW SCREW
    1602 00007ca0     b680          MOVE    *A4(OSHAD),A0,L
         00007cb0     0240  
    1603 00007cc0     ca0a          JREQ    PLXNOSHD                ;BR = WE'RE FUCKED, NO SHADOW
    1604 00007cd0     b600          MOVE    *A0(OYVAL),A0,L
         00007ce0     00a0  
    1605 00007cf0     b701          MOVE    *A8(OSHAD),A1,L
         00007d00     0240  
    1606 00007d10     b42e          MOVE    *A1(OSIZEY),A14,W
         00007d20     0150  
    1607 00007d30     260e          SLL     16,A14
    1608 00007d40     45c0          SUB     A14,A0
    1609 00007d50     b201          MOVE    A0,*A1(OYVAL),L         ;MAKE SURE SHADOWS ARE TOGETHER
         00007d60     00a0  
    1610 00007d70           PLXNOSHD
    1611 00007d70     bb04          MOVE    *A8(OXVEL),*A4(OXVEL),L ;XFER TORSO VELOCITIES TO THE LEGGIES
         00007d80     0040  
         00007d90     0040  
    1612 00007da0     bb04          MOVE    *A8(OYVEL),*A4(OYVEL),L
         00007db0     0060  
         00007dc0     0060  
    1613 00007dd0     bb04          MOVE    *A8(OZVEL),*A4(OZVEL),L 
         00007de0     00e0  
         00007df0     00e0  
    1614 00007e00     b440          MOVE    *A2(PALIGNCT),A0,W
         00007e10     0390  
    1615 00007e20     1420          DEC     A0
    1616 00007e30     cf04          JRNN    PLXNALGN
    1617 00007e40     0d3f          CALLR   PLALIGNSP               ;SPECIAL PLAYER ALIGN, CHECKS LEGS OFF
         00007e50     012f  
    1618 00007e60     09c0          MOVI    PALGNTIM,A0
         00007e70     0008  
    1619 00007e80           PLXNALGN
    1620 00007e80     b002          MOVE    A0,*A2(PALIGNCT),W      ;RESET THE COUNTER
         00007e90     0390  
    1621 00007ea0     0d3f          CALLR   CKLBOUND                ;DO A QUICK CHECK BOUNDRY CHECK
         00007eb0     0282  
    1622 00007ec0     4d20          MOVE    A9,A0
    1623 00007ed0     0b80          ANDI    MPASSEN|MDRIVER,A0
         00007ee0 ffffe7ff  
    1624 00007f00     cb02          JRNE    PLNODRIV                ;BR = DRIVING, DON'T CHECK BOUNDRIES
    1625 00007f10     0d3f          CALLR   CKABGND                 ;CHECK AGAINST BACKGROUND OBJECTS
         00007f20     03c7  
    1626 00007f30           PLNODRIV
    1627 00007f30     b700          MOVE    *A8(OZVEL),A0,L
         00007f40     00e0  
    1628 00007f50     400c          ADD     A0,A12                  ;UPDATE LANDING LINE
    1629 00007f60           PLAYXXX
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   41

    1630 00007f60     4e30          MOVE    B1,A0
    1631 00007f70     0980          MMTM    A0,A3,A4,A5,A6,A7,A8
         00007f80     1f80  
    1632 00007f90     1400          SUBK    32,A0
    1633 00007fa0     8120          MOVE    A9,*A0,W                ;KLUDGE TO PRESERVE PEXEFLAG
    1634 00007fb0     0980          MMTM    A0,A10,A11,A12,A13      ;NOW SAVE THE REST
         00007fc0     003c  
    1635 00007fd0     0960          RETS
    1636                    
    1637 00007fe0           STIKTAB
    1638 00007fe0 000074a0'         .LONG   PLAYERC,PLAYERUP,PLAYERDN,PLAYERUP,PLAYERLF,PLAYERUL
    1639 000080a0 00007130'         .LONG   PLAYERDL,PLAYERUL,PLAYERRT,PLAYERUR,PLAYERDR,PLAYERUR
    1640 00008160 00006ff0'         .LONG   PLAYERRT,PLAYERUR,PLAYERDR,PDEFAULT
    1641                    
    1642                    **************************************************************************
    1643                    *                                                                        *
    1644                    * INCFP2 - INCREMENT A0 IF THIS IS PLAYER TWO.                           *
    1645                    *               USED FOR PROCESS TRIGGERING.                             *
    1646                    * A2 = PLINDX                                                            *
    1647                    *                                                                        *
    1648                    **************************************************************************
    1649 000081e0           INCFP2
    1650 000081e0     0b62          CMPI    P1DATA,A2
         000081f0 ffffffff! 
    1651 00008210     ca01          JREQ    INCFP2X
    1652 00008220     1020          INC     A0
    1653 00008230           INCFP2X
    1654 00008230     0960          RETS
    1655                    
    1656                    *
    1657                    *FIRE A PROCESS VIA THE SWITCH STACK, USED FOR IRQ
    1658                    *A0 -- SWITCH NUMBER 
    1659 00008240     a22f  PSTAKP  MOVE    A1,-*SP,L
    1660 00008250     07a1          MOVE    @SWSTACK,A1,L           ;GET THE STACK
         00008260 00000000! 
    1661 00008280     0b61          CMPI    SWSTMN,A1               ;SWITCH STACK OVERFLOW?
         00008290 ffffffff! 
    1662 000082b0     ca04          JREQ    PSTAKX                  ;YEP, NO FIRE PROCESS
    1663 000082c0     a001          MOVE    A0,-*A1                 ;PUSH SWITCH NUMBER ON STACK
    1664 000082d0     0781          MOVE    A1,@SWSTACK,L           ;RESTORE SWITCH STACK
         000082e0 00000000! 
    1665 00008300     97e1  PSTAKX  MOVE    *SP+,A1,L
    1666 00008310     0960          RETS
    1667                    
    1668                    **************************************************************************
    1669                    *                                                                        *
    1670                    * PLAYLEG - PROCESS ANIMATION FOR PLAYERS LEGS                           *
    1671                    * CALL THIS ONLY FROM THE PLAYER JOYSTICK PROCESSOR                      *
    1672                    *                                                                        *
    1673                    **************************************************************************
    1674 00008320           PLAYLEG
    1675 00008320     098f          MMTM    SP,A0,A1
         00008330     c000  
    1676 00008340     4c63          MOVE    A3,A3
    1677 00008350     ca02          JREQ    PLAYLEG1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   42

    1678 00008360     1423          DEC     A3                      ;CLICK A LEGGY TICK
    1679 00008370     c006          JRUC    PLAYLEG2
    1680 00008380           PLAYLEG1
    1681 00008380     0d3f          CALLR   PLFRAME                 ;PUT IN SOME NEW LEGS                   
         00008390     0107  
    1682 000083a0     c903          JRNC    PLAYLEG2                ;BR = MORE FRAMES
    1683 000083b0     b64d          MOVE    *A2(PLEGAS),A13,L       ;RESET THE CURRENT SCRIPT
         000083c0     0160  
    1684 000083d0     c0fa          JRUC    PLAYLEG1                ;AND SET UP THAT FRAME
    1685 000083e0           PLAYLEG2
    1686 000083e0     09af          MMFM    SP,A0,A1
         000083f0     0003  
    1687 00008400     0960          RETS
    1688                    
    1689                    **************************************************************************
    1690                    *                                                                        *
    1691                    * FYRCHEK - CHECK TO SEE IF THE PLAYER WANTS TO FIRE                     *
    1692                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    1693                    * A7 = PLAYER JOYSTICK BITS                                              *
    1694                    * A9 = PLAYER FLAGS                                                      *
    1695                    * RETURNS                                                                *
    1696                    * A9 = NEW FLAGS IF NECESSARY                                            *
    1697                    * CARRY SET = FIRE, B4 RETURNS WITH THE CORRECT OFFSET TO THE FIRE FRAMES*
    1698                    * CARRY CLEAR = NO FIRE,ALSO B4 RETURNS 0 IN THIS CASE                   *
    1699                    *                                                                        *
    1700                    **************************************************************************
    1701 00008410           FYRCHEK
    1702 00008410     098f          MMTM    SP,A0,A1
         00008420     c000  
    1703                    
    1704 00008430     1f07          BTST    BPFROCK,A7        ;ROCKET LAUNCH BUTTON?
    1705 00008440     ca21          JREQ    FYRCHEK1          ;NOPE, CLEAR LAUNCH HOLD FLAG AND CHECK FIRE BUTTON
    1706                    
    1707 00008450     1ec9          BTST    BRHOLD,A9         ;HOLDING FROM PREVIOUS ROCKET LAUNCH?
    1708 00008460     cb22          JRNE    FYRCHEK2          ;YES, CHECK THE FIRE BUTTON 
    1709                    
    1710                    *CHECK FOR # OF ROCKET BOMBS, MAKE AN EMPTY SOUND IF THERE ARE NONE
    1711 00008470     1e29          BTST    BUNLIMIT,A9
    1712 00008480     cb0b          JRNE    FYRCHEK0                ;ROCKET YOUR LIFE AWAY
    1713                    
    1714 00008490     b440          MOVE    *A2(PROCKETS),A0,W      ;CHECK ROCKETS
         000084a0     01e0  
    1715 000084b0     cb08          JRNE    FYRCHEK0                ;BR = ROCKETS TO BE HAD BY HIM
    1716                    
    1717 000084c0     0ba9          ORI     MRHOLD,A9               ;HOLD THE ROCKET BUTTON
         000084d0 00000200  
    1718 000084f0     09c0          MOVI    44,A0
         00008500     002c  
    1719 00008510     0d3f          CALLR   PSTAKP                  ;FIRE OFF THE LIMP SOUND PROCESS
         00008520     ffd1  
    1720 00008530     c015          JRUC    FYRCHEK2                ;AND GET OUT            
    1721                    
    1722                    *ROCKET LIMITER TO REDUCE OVERLOAD
    1723 00008540           FYRCHEK0
    1724 00008540     b440          MOVE    *A2(PROCKONS),A0,W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   43

         00008550     0290  
    1725 00008560     cb12          JRNZ    FYRCHEK2                ;THERE IS/ARE ROCKET(S) ON SCREEN
    1726                    
    1727                    ***     INC     A0
    1728                    ***     MOVE    A0,*A2(PROCKONS),W      ;INDICATE A ROCKET ON SCREEN
    1729                    
    1730 00008570     0ba9          ORI     (MROCKET+MRHOLD),A9     ;FLAG A ROCKET, AND TURN ROCKET ONE SHOT FLAG
         00008580 00000210  
    1731 000085a0     0b89          ANDNI   MGUN,A9                 ;3-2-1 BLAST AWAY!
         000085b0 00000008  
    1732                    
    1733 000085d0     18b4          MOVK    RBOFFSET,B4             ;OFFSET FROM FIRE TO ROCKET BOMB
    1734                    
    1735 000085e0     4d20          MOVE    A9,A0
    1736 000085f0     0b80          ANDI    MJUMP2|MPASSEN|MDRIVER,A0
         00008600 ffffe7fb  
    1737 00008620     cb1f          JRNE    FYRCHEK3                ;BR = DON'T STOP FOR THESE CASES
    1738 00008630     0d3f          CALLR   PLSTOP                  ;STOP ON ROCKET LAUNCH           
         00008640     0119  
    1739 00008650     c01c          JRUC    FYRCHEK3
    1740 00008660           FYRCHEK1
    1741 00008660     0b89          ANDNI   MRHOLD,A9               ;CLEAR ROCKET ONE SHOT, SWITCH OPEN             
         00008670 00000200  
    1742                    
    1743 00008690           FYRCHEK2
    1744 00008690     1f47          BTST    BPFIRE,A7               ;BULLET TIME?
    1745 000086a0     ca1b          JREQ    FYRCHEK4                ;NO
    1746                    
    1747 000086b0     b440          MOVE    *A2(PBULLETS),A0,W      ;GET THE BULLETS COUNT
         000086c0     0250  
    1748 000086d0     1420          DEC     A0
    1749 000086e0     c105          JRP     FYRCHEK2A               ;IT'S GOOD TO HAVE AMMO
    1750 000086f0     b441          MOVE    *A2(PBULLONS),A1,W      ;GET THE # OF ON SCREEN BULLETS
         00008700     0260  
    1751 00008710     cb14          JRNZ    FYRCHEK4                ;BR = ONLY ONE/SCREEN NOW
    1752 00008720     1820          MOVK    1,A0
    1753 00008730     c005          JRUC    FYRCHEK2B       
    1754 00008740           FYRCHEK2A
    1755 00008740     b441          MOVE    *A2(PBULLONS),A1,W
         00008750     0260  
    1756 00008760     0b41          CMPI    PBULLMAX,A1
         00008770     fffa  
    1757 00008780     c50d          JRGE    FYRCHEK4                ;BR = CAN ONLY ALLOW SO MANY ON SCREEN
    1758 00008790           FYRCHEK2B
    1759 00008790     0ba9          ORI     MGUN,A9
         000087a0 00000008  
    1760 000087c0     0b89          ANDNI   MROCKET,A9              ;FIRE!
         000087d0 00000010  
    1761 000087f0     5694          CLR     B4                      ;OFFSET TO NORMAL FIRING FRAMES
    1762 00008800     b002          MOVE    A0,*A2(PBULLETS),W      ;NEW # OF BULLETS
         00008810     0250  
    1763                    *INDICATE FIRING NECESSARY
    1764 00008820           FYRCHEK3
    1765 00008820     0de0          SETC
    1766 00008830     09af          MMFM    SP,A0,A1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   44

         00008840     0003  
    1767 00008850     0960          RETS
    1768                    *NO FIRING THIS TIME AROUND
    1769 00008860           FYRCHEK4
    1770 00008860     5694          CLR     B4
    1771 00008870     0320          CLRC
    1772 00008880     09af          MMFM    SP,A0,A1
         00008890     0003  
    1773 000088a0     0960          RETS
    1774                    
    1775                    **************************************************************************
    1776                    *                                                                        *
    1777                    * STUFLVEL - STUFF X,Y & Z VELOCITIES INTO A PLAYER TORSO AND LEGS.      *
    1778                    * A0 = X VEL(32 BITS)                                                    *
    1779                    * A1 = Y&Z VEL(32 BITS)                                                  *
    1780                    * A4 = PTR TO LEGS                                                       *
    1781                    * A8 = PTR TO TORSO                                                      *
    1782                    *                                                                        *
    1783                    **************************************************************************
    1784 000088b0           STUFLVEL
    1785 000088b0     b208          MOVE    A0,*A8(OXVEL),L         ;X
         000088c0     0040  
    1786                    ***     MOVE    A0,*A4(OXVEL),L         ;X FOR LEGS
    1787 000088d0     b228          MOVE    A1,*A8(OYVEL),L         ;Y
         000088e0     0060  
    1788                    ***     MOVE    A1,*A4(OYVEL),L         ;Y FOR LEGS
    1789 000088f0     b228          MOVE    A1,*A8(OZVEL),L         ;Z
         00008900     00e0  
    1790                    ***     MOVE    A1,*A4(OZVEL),L         ;Z FOR LEGS
    1791 00008910     0960          RETS
    1792                    
    1793                    *
    1794                    *SVELCPY2 - COPY TORSO AND LEG VELOCITIES TO SHADOW (IF ANY)
    1795                    *A4=LEGS
    1796                    *A8=TORSO
    1797                    *
    1798 00008920           SVELCPY2: 
    1799 00008920     098f          MMTM    SP,A0,A1
         00008930     c000  
    1800 00008940     b700          MOVE    *A8(OSHAD),A0,L
         00008950     0240  
    1801 00008960     ca09          JREQ    SVLCP2
    1802 00008970     bb00          MOVE    *A8(OXVEL),*A0(OXVEL),L
         00008980     0040  
         00008990     0040  
    1803 000089a0     b701          MOVE    *A8(OZVEL),A1,L
         000089b0     00e0  
    1804 000089c0     b220          MOVE    A1,*A0(OZVEL),L
         000089d0     00e0  
    1805 000089e0     b220          MOVE    A1,*A0(OYVEL),L
         000089f0     0060  
    1806 00008a00           SVLCP2:
    1807 00008a00     b680          MOVE    *A4(OSHAD),A0,L
         00008a10     0240  
    1808 00008a20     ca09          JREQ    SHVLCPX
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   45

    1809 00008a30     ba80          MOVE    *A4(OXVEL),*A0(OXVEL),L
         00008a40     0040  
         00008a50     0040  
    1810 00008a60     b681          MOVE    *A4(OZVEL),A1,L
         00008a70     00e0  
    1811 00008a80     b220          MOVE    A1,*A0(OZVEL),L
         00008a90     00e0  
    1812 00008aa0     b220          MOVE    A1,*A0(OYVEL),L
         00008ab0     0060  
    1813 00008ac0           SHVLCPX:
    1814 00008ac0     09af          MMFM    SP,A0,A1
         00008ad0     0003  
    1815 00008ae0     0960          RETS
    1816                    
    1817                    **************************************************************************
    1818                    *                                                                        *
    1819                    * PIRQZRST - PLAYER IRQ Z RESET, RESET PLAYER Z ACCORDING TO THE         *
    1820                    *          INIT. TABLE                                                   *
    1821                    * A2 = PTR TO PLAYER DATA BLOCK                                          *
    1822                    * A4 = PTR TO LEG OBJ                                                    *
    1823                    * A8 = PTR TO TORSO OBJ                                                  *
    1824                    *                                                                        *
    1825                    **************************************************************************
    1826 00008af0           PIRQZRST
    1827 00008af0     098f          MMTM    SP,A0,A1,A4,A8,A9,A10,A14
         00008b00     c8e2  
    1828 00008b10     4d0a          MOVE    A8,A10
    1829 00008b20     4c88          MOVE    A4,A8
    1830 00008b30     0d5f          CALLA   DFRMGRND
         00008b40 00000000! 
    1831 00008b60     ce03          JRN     PIRQYES
    1832 00008b70     0b41          CMPI    2,A1
         00008b80     fffd  
    1833 00008b90     c421          JRLT    PIRQX
    1834 00008ba0           PIRQYES
    1835 00008ba0     0b62          CMPI    P1DATA,A2
         00008bb0 ffffffff! 
    1836 00008bd0     cb04          JRNE    P2IRQ
    1837 00008be0     09ee          MOVI    P1INITTL,A14
         00008bf0 000021b0' 
    1838 00008c10     c003          JRUC    PIRQZ1
    1839 00008c20           P2IRQ
    1840 00008c20     09ee          MOVI    P2INITT,A14
         00008c30 00002430' 
    1841 00008c50           PIRQZ1
    1842 00008c50     b709          MOVE    *A8(OIMG),A9,L
         00008c60     0180  
    1843 00008c70     b504          MOVE    *A8(OFLAGS),A4,W
         00008c80     0100  
    1844 00008c90     b7c1          MOVE    *A14(INITIMG),A1,L
         00008ca0     00a0  
    1845 00008cb0     0d5f          CALLA   ANI                     ;GET INIT. IMG
         00008cc0 00000000! 
    1846 00008ce0     4d00          MOVE    A8,A0
    1847 00008cf0     0d5f          CALLA   SETZPOS
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   46

         00008d00 00000000! 
    1848 00008d20     4d21          MOVE    A9,A1
    1849 00008d30     0d5f          CALLA   ANI                     ;RESTORE CURRENT
         00008d40 00000000! 
    1850 00008d60     b700          MOVE    *A8(OZVAL),A0,L
         00008d70     00c0  
    1851 00008d80     1020          INC     A0
    1852 00008d90     b20a          MOVE    A0,*A10(OZVAL),L
         00008da0     00c0  
    1853 00008db0           PIRQX
    1854 00008db0     09af          MMFM    SP,A0,A1,A4,A8,A9,A10,A14
         00008dc0     4713  
    1855 00008dd0     0960          RETS
    1856                    
    1857                    **************************************************************************
    1858                    *                                                                        *
    1859                    * PFLIPCK - SET THE PLAYER HORIZONTAL FLIP ACCORDING TO THE JOYSTICK     *
    1860                    * A2 = PLAYER DATA STRUCTURE                                             *
    1861                    * A4 = PLAYER LEG OBJ                                                    *
    1862                    * A7 = PLAYER JOYSTICK/SWITCH BITS                                       *
    1863                    * A8 = PLAYER TORSO OBJ                                                  *
    1864                    *                                                                        *
    1865                    **************************************************************************
    1866 00008de0           PFLIPCK
    1867 00008de0     1f87          BTST    BPRYTE,A7
    1868 00008df0     ca05          JREQ    PFLIPCKL
    1869 00008e00     0d3f          CALLR   NOY2FLIP
         00008e10     0118  
    1870 00008e20     0d3f          CALLR   NOYLFLIP
         00008e30     00fe  
    1871 00008e40     c006          JRUC    PFLIPCKX
    1872 00008e50           PFLIPCKL
    1873 00008e50     1fa7          BTST    BPLEFT,A7
    1874 00008e60     ca04          JREQ    PFLIPCKX
    1875 00008e70     0d3f          CALLR   Y2FLIP
         00008e80     0109  
    1876 00008e90     0d3f          CALLR   YLFLIP
         00008ea0     00ee  
    1877 00008eb0           PFLIPCKX
    1878 00008eb0     0960          RETS
    1879                    **************************************************************************
    1880                    *                                                                        *
    1881                    * PLALIGN - RE-ALIGN THE PLAYER LEGS WITH THE CURRENT TORSO.             *
    1882                    * A4 = PTR TO PLAYER LEGS                                                *
    1883                    * A8 = PTR TO PLAYER TORSO                                               *
    1884                    * NOTE: CALL FROM DIRQ, OR WHILE DIRQ IS DISABLED.                       *
    1885                    *                                                                        *
    1886                    **************************************************************************
    1887 00008ec0           PLALIGN
    1888 00008ec0     098f          MMTM    SP,A0,A2,A3
         00008ed0     b000  
    1889 00008ee0     0d5f          CALLA   GETANIXY                ;GET THE TORSO ANIMATION PNT
         00008ef0 00000000! 
    1890 00008f10     4c80          MOVE    A4,A0
    1891 00008f20     b504          MOVE    *A8(OFLAGS),A4,W        ;GET THE FLAGS FROM THE TORSO
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   47

         00008f30     0100  
    1892 00008f40     0d5f          CALLA   GANISAG                 ;AND RE-ADJUST
         00008f50 00000000! 
    1893 00008f70     4c04          MOVE    A0,A4
    1894 00008f80     b700          MOVE    *A8(OZVAL),A0,L
         00008f90     00c0  
    1895 00008fa0     1420          DEC     A0                      ;RE-POSITION PROPERLY
    1896 00008fb0     b204          MOVE    A0,*A4(OZVAL),L
         00008fc0     00c0  
    1897 00008fd0     bb04          MOVE    *A8(OXVEL),*A4(OXVEL),L ;MATCH VELOCITIES
         00008fe0     0040  
         00008ff0     0040  
    1898 00009000     bb04          MOVE    *A8(OYVEL),*A4(OYVEL),L
         00009010     0060  
         00009020     0060  
    1899 00009030     bb04          MOVE    *A8(OZVEL),*A4(OZVEL),L
         00009040     00e0  
         00009050     00e0  
    1900 00009060     0d5f          CALLA   SHADUPD2                ;UPDATE THE TORSO SHADOW
         00009070 00000000! 
    1901 00009090                   SWAP    A4,A8
    1902 000090c0     0d5f          CALLA   SHADUPD                 ;UPDATE LEG SHADOW
         000090d0 00000000! 
    1903 000090f0                   SWAP    A4,A8
    1904 00009120     09af          MMFM    SP,A0,A2,A3
         00009130     000d  
    1905 00009140     0960          RETS
    1906                    
    1907                    **************************************************************************
    1908                    *                                                                        *
    1909                    * PLALIGNSP - SPECIAL RE-ALIGN FOR LEGS AND TORSO, FIRST CHECKS LEGS     *
    1910                    *               AND ONLY RE-ALIGNS IF THEY ARE ON                        *
    1911                    * A4 = PTR TO PLAYER LEGS                                                *
    1912                    * A8 = PTR TO PLAYER TORSO                                               *
    1913                    * NOTE: CALL FROM DIRQ, OR WHILE DIRQ IS DISABLED.                       *
    1914                    *                                                                        *
    1915                    **************************************************************************
    1916 00009150           PLALIGNSP
    1917 00009150     098f          MMTM    SP,A0,A1,A2,A3,A5,A6,A7
         00009160     f700  
    1918 00009170     0d5f          CALLA   GETANIXY                ;GET THE TORSO ANIMATION PNT
         00009180 00000000! 
    1919 000091a0     4c45          MOVE    A2,A5
    1920 000091b0     4c80          MOVE    A4,A0
    1921 000091c0     b681          MOVE    *A4(OIMG),A1,L
         000091d0     0180  
    1922 000091e0     b682          MOVE    *A4(OSIZE),A2,L
         000091f0     0140  
    1923 00009200     b484          MOVE    *A4(OFLAGS),A4,W
         00009210     0100  
    1924 00009220     0d5f          CALLA   GANIOF
         00009230 00000000! 
    1925 00009250     4c04          MOVE    A0,A4
    1926 00009260     44c3          SUB     A6,A3   
    1927 00009270     44e5          SUB     A7,A5                   ;ADJUST UPPER LEFT CORNER
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   48

    1928 00009280     b264          MOVE    A3,*A4(OXVAL),L
         00009290     0080  
    1929 000092a0     b2a4          MOVE    A5,*A4(OYVAL),L         
         000092b0     00a0  
    1930 000092c0     09af          MMFM    SP,A0,A1,A2,A3,A5,A6,A7
         000092d0     00ef  
    1931 000092e0     0960          RETS
    1932                    
    1933                    **************************************************************************
    1934                    *                                                                        *
    1935                    * DLLINE - RETURNS THE DISTANCE OF THE PLAYER FROM HIS LANDING LINE      *
    1936                    * A8 = POINTER TO TORSO                                                  *
    1937                    * A12 = LANDING LINE, 32 BITS                                            *
    1938                    * RETURNS                                                                *
    1939                    * A1 = DISTANCE FROM LINE, 32 BITS                                       *
    1940                    * THE STATUS BITS REFLECT THE SIGN OF A1                                 *
    1941                    * NOTE: A0 IS TRASHED                                                    *
    1942                    *                                                                        *
    1943                    **************************************************************************
    1944 000092f0           DLLINE
    1945 000092f0     b700          MOVE    *A8(OYVAL),A0,L ;GET THE CURRENT Y POSITION
         00009300     00a0  
    1946 00009310     b701          MOVE    *A8(OIMG),A1,L
         00009320     0180  
    1947 00009330     b421          MOVE    *A1(IANIOFF+16),A1,W
         00009340     0030  
    1948 00009350     2601          SLL     16,A1
    1949 00009360     4020          ADD     A1,A0           ;ADJUST FOR ANIMATION POINT
    1950                    
    1951 00009370     4d81          MOVE    A12,A1
    1952 00009380     4401          SUB     A0,A1           ;A1 = DISTANCE FROM Y LANDING LINE
    1953 00009390     0960          RETS
    1954                    
    1955                    **************************************************************************
    1956                    *                                                                        *
    1957                    * LOADLTAB - LOAD A LEG ANIMATION LIST FROM MAIN ANIMATION TABLE         *
    1958                    * A0 = FRAME TYPE                                                        *
    1959                    * A6 = MAIN ANIMATION TABLE                                              *
    1960                    * RETURN(S):                                                             *
    1961                    * A13 = PTR TO HEAD OF ANIMATION LIST                                    *
    1962                    *                                                                        *
    1963                    **************************************************************************
    1964 000093a0           LOADLTAB:
    1965 000093a0     a2cf          MOVE    A6,-*SP,L
    1966 000093b0     0d5f          CALLA   BASFRM          ;OFFSET INTO LIST TABLE
         000093c0 00000000! 
    1967 000093e0     86cd          MOVE    *A6,A13,L       ;POINT TO THE LIST
    1968 000093f0     97e6          MOVE    *SP+,A6,L
    1969 00009400     0960          RETS
    1970                    
    1971                    **************************************************************************
    1972                    *                                                                        *
    1973                    * PLFRAME - GET NEXT LEG FRAME FROM ANIMATION LIST FOR PART 1            *
    1974                    * A4 = POINTER TO OBJECT BLOCK                                           *
    1975                    * A9 = PLAYER FLAGS                                                      *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   49

    1976                    * A13 = POINTER TO NEXT FRAME IN THE ANIMATION LIST                      *
    1977                    * RETURN(S)                                                              *
    1978                    * A3 = TICKS FOR THIS FRAME                                              *
    1979                    * C BIT SET(JxC)  = END OF LIST WAS HIT                                  *
    1980                    * N BIT SET(JxN)  = SPECIAL FRAME ENCOUNTERED                            *
    1981                    *                                                                        *
    1982                    **************************************************************************
    1983 00009410     098f  PLFRAME MMTM    SP,A0,A1,A4,A8
         00009420     c880  
    1984 00009430     97a1          MOVE    *A13+,A1,L      ;LOAD NEXT FRAME
    1985 00009440     cb02          JRNE    PLFRAME1        ;NOT THE END OF THE LIST
    1986 00009450     0de0          SETC                    ;SET CARRY FLAG
    1987 00009460     c016          JRUC    PLFRAMEX
    1988 00009470           PLFRAME1
    1989 00009470     4c88          MOVE    A4,A8
    1990 00009480     b504          MOVE    *A8(OFLAGS),A4,W
         00009490     0100  
    1991 000094a0     0d5f          CALLA   ANI             ;SETUP NEW FRAME
         000094b0 00000000! 
    1992 000094d0           PLFRAME2
    1993 000094d0     95a3          MOVE    *A13+,A3,W      ;LOAD SLEEP TICKS PER FRAME
    1994 000094e0     c508          JRGE    PLFRM5          ;BR = NORMAL FRAME ENCOUNTERED
    1995 000094f0     97aa          MOVE    *A13+,A10,L     ;PUT CURRENT XY FIRING OFFSETS IN BLOCK
    1996 00009500     95a0          MOVE    *A13+,A0,W      ;GET PROCESS "SWITCH" NUMBER
    1997 00009510     0d3f          CALLR   INCFP2
         00009520     fecb  
    1998 00009530     0d3f          CALLR   PSTAKP
         00009540     fecf  
    1999 00009550     03a3          NEG     A3
    2000 00009560     c005          JRUC    PLFRM6
    2001 00009570           PLFRM5
    2002 00009570     1f49          BTST    BRUN,A9
    2003 00009580     ca03          JREQ    PLFRM6
    2004 00009590     1423          SUBK    1,A3            ;SPEED UP FOR RUN
    2005 000095a0     c701          JRGT    PLFRM6
    2006 000095b0     5663          CLR     A3              ;THIS IS THE LOWEST
    2007 000095c0           PLFRM6
    2008 000095c0     0320          CLRC    
    2009 000095d0           PLFRAMEX
    2010 000095d0     09af          MMFM    SP,A0,A1,A4,A8
         000095e0     0113  
    2011 000095f0     0960          RETS
    2012                    
    2013                    **************************************************************************
    2014                    *                                                                        *
    2015                    * P2FRAME - GET NEXT FRAME FROM ANIMATION LIST FOR PART 2                *
    2016                    *           CALL ONLY FROM JOYSTICK PROCESSOR                            *
    2017                    * A8 = POINTER TO PART 2 OBJECT BLOCK                                    *
    2018                    * A4 = POINTER TO PART 1 OBJECT BLOCK                                    *
    2019                    * A9 = PLAYER FLAGS                                                      *
    2020                    * A11 = POINTER TO NEXT FRAME IN THE ANIMATION LIST                      *
    2021                    * RETURN(S)                                                              *
    2022                    * A5 = TICKS FOR THIS FRAME                                              *
    2023                    * C BIT SET(JxC)  = END OF LIST WAS HIT                                  *
    2024                    * N BIT SET(JxN)  = SPECIAL FRAME ENCOUNTERED                            *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   50

    2025                    *                                                                        *
    2026                    **************************************************************************
    2027 00009600           P2FRAME
    2028 00009600     098f          MMTM    SP,A0,A1,A4,A14
         00009610     c802  
    2029 00009620     9761          MOVE    *A11+,A1,L              ;LOAD NEXT FRAME
    2030 00009630     cb02          JRNE    P2FRM1                  ;NOT THE END OF THE LIST
    2031 00009640     0de0          SETC                            ;SET CARRY FLAG
    2032 00009650     c015          JRUC    P2FRMX
    2033 00009660           P2FRM1
    2034 00009660     b504          MOVE    *A8(OFLAGS),A4,W
         00009670     0100  
    2035 00009680     0d5f          CALLA   ANI2                    ;SETUP NEW FRAME
         00009690 00000000! 
    2036 000096b0           P2FRM4
    2037 000096b0     9565          MOVE    *A11+,A5,W      ;LOAD SLEEP TICKS PER FRAME
    2038 000096c0     c508          JRGE    P2FRM5          ;BR = NORMAL FRAME ENCOUNTERED
    2039                    
    2040 000096d0     976a          MOVE    *A11+,A10,L     ;PUT CURRENT XY FIRING OFFSETS IN BLOCK
    2041 000096e0     9560          MOVE    *A11+,A0,W      ;GET PROCESS "SWITCH" NUMBER
    2042 000096f0     0d3f          CALLR   INCFP2
         00009700     fead  
    2043 00009710     0d3f          CALLR   PSTAKP
         00009720     feb1  
    2044 00009730     03a5          NEG     A5
    2045 00009740     c005          JRUC    P2FRM6
    2046 00009750           P2FRM5
    2047 00009750     1f49          BTST    BRUN,A9
    2048 00009760     ca03          JREQ    P2FRM6
    2049 00009770     1425          SUBK    1,A5            ;SPEED UP FOR RUN
    2050 00009780     c701          JRGT    P2FRM6
    2051 00009790     56a5          CLR     A5              ;THIS IS THE LOWEST
    2052 000097a0           P2FRM6
    2053 000097a0     0320          CLRC    
    2054 000097b0     09af  P2FRMX  MMFM    SP,A0,A1,A4,A14
         000097c0     4013  
    2055 000097d0     0960          RETS
    2056                    
    2057                    
    2058                    **************************************************************************
    2059                    *                                                                        *
    2060                    * PLSTOP - STOP A TWO PIECE OBJECT IN ALL DIRECTIONS.                    *
    2061                    * A4 = OBJECT 0 (LEGS)                                                   *
    2062                    * A8 = OBJECT 1 (TORSO)                                                  *
    2063                    *                                                                        *
    2064                    **************************************************************************
    2065 000097e0     0d3f  PLSTOP  CALLR   PLSTOPX
         000097f0     0001  
    2066 00009800     c055          JRUC    PLSTOPYZ
    2067                    **************************************************************************
    2068                    *                                                                        *
    2069                    * PLSTOPX - CLEAR THE TOP AND BOTTOM OBJECTS X VELOCITY,                 *
    2070                    * A4 = LEGS                                                              *
    2071                    * A8 = TORSO                                                             *
    2072                    *                                                                        *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   51

    2073                    **************************************************************************
    2074 00009810           PLSTOPX
    2075 00009810     098f          MMTM    SP,A0,A1
         00009820     c000  
    2076 00009830     5621          CLR     A1
    2077 00009840     b228          MOVE    A1,*A8(OXVEL),L
         00009850     0040  
    2078 00009860     b700          MOVE    *A8(OSHAD),A0,L
         00009870     0240  
    2079 00009880     ca02          JREQ    PLSTOPX1                ;BR = NO TORSO SHADOW
    2080 00009890     b220          MOVE    A1,*A0(OXVEL),L         ;STOP THE SHADOW ALSO
         000098a0     0040  
    2081 000098b0           PLSTOPX1
    2082 000098b0                   TEST    A4
    2083 000098c0     ca07          JREQ    PLSTOPX2                ;BR = NO LEGS
    2084 000098d0     b224          MOVE    A1,*A4(OXVEL),L
         000098e0     0040  
    2085 000098f0     b680          MOVE    *A4(OSHAD),A0,L
         00009900     0240  
    2086 00009910     ca02          JREQ    PLSTOPX2
    2087 00009920     b220          MOVE    A1,*A0(OXVEL),L         ;STOP THE SHADOW ALSO
         00009930     0040  
    2088 00009940           PLSTOPX2
    2089 00009940     09af          MMFM    SP,A0,A1
         00009950     0003  
    2090 00009960     0960          RETS
    2091                    **************************************************************************
    2092                    *                                                                        *
    2093                    * PLSTOPZ - CLEAR THE TOP AND BOTTOM OBJECTS Z VELOCITY,                 *
    2094                    * A4 = LEGS                                                              *
    2095                    * A8 = TORSO                                                             *
    2096                    *                                                                        *
    2097                    **************************************************************************
    2098 00009970           PLSTOPZ
    2099 00009970     098f          MMTM    SP,A0,A1,A2,A3
         00009980     f000  
    2100 00009990     b702          MOVE    *A8(OYVEL),A2,L
         000099a0     0060  
    2101 000099b0     4c43          MOVE    A2,A3                   ;KEEP HERE FOR SIGN COMPARISON
    2102 000099c0     b701          MOVE    *A8(OZVEL),A1,L
         000099d0     00e0  
    2103 000099e0     0381          ABS     A1
    2104 000099f0     0382          ABS     A2
    2105 00009a00     4422          SUB     A1,A2
    2106 00009a10     4c63          MOVE    A3,A3                   ;SWITCH SIGNS?
    2107 00009a20     cf01          JRNN    PLSTOPZN                ;BR = NO
    2108 00009a30     03a2          NEG     A2
    2109 00009a40           PLSTOPZN
    2110 00009a40     5621          CLR     A1
    2111 00009a50     b228          MOVE    A1,*A8(OZVEL),L
         00009a60     00e0  
    2112 00009a70     b248          MOVE    A2,*A8(OYVEL),L
         00009a80     0060  
    2113 00009a90     b700          MOVE    *A8(OSHAD),A0,L
         00009aa0     0240  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   52

    2114 00009ab0     ca04          JREQ    PLSTOPZ1                ;BR = NO TORSO SHADOW
    2115 00009ac0     b220          MOVE    A1,*A0(OZVEL),L
         00009ad0     00e0  
    2116 00009ae0     b220          MOVE    A1,*A0(OYVEL),L         ;TOTALLY STOP THE TORSO SHADOW
         00009af0     0060  
    2117 00009b00           PLSTOPZ1
    2118 00009b00                   TEST    A4
    2119 00009b10     ca0b          JREQ    PLSTOPZ2                ;BR = NO LEGS
    2120 00009b20     b224          MOVE    A1,*A4(OZVEL),L
         00009b30     00e0  
    2121 00009b40     b244          MOVE    A2,*A4(OYVEL),L
         00009b50     0060  
    2122 00009b60     b680          MOVE    *A4(OSHAD),A0,L
         00009b70     0240  
    2123 00009b80     ca04          JREQ    PLSTOPZ2
    2124 00009b90     b220          MOVE    A1,*A0(OZVEL),L
         00009ba0     00e0  
    2125 00009bb0     b220          MOVE    A1,*A0(OYVEL),L         ;TOTALLY STOP THE LEG SHADOW
         00009bc0     0060  
    2126 00009bd0           PLSTOPZ2
    2127 00009bd0     09af          MMFM    SP,A0,A1,A2,A3
         00009be0     000f  
    2128 00009bf0     0960          RETS
    2129                    **************************************************************************
    2130                    *                                                                        *
    2131                    * PLSTOPY - CLEAR THE TOP AND BOTTOM OBJECTS Y VELOCITY,                 *
    2132                    * A4 = LEGS                                                              *
    2133                    * A8 = TORSO                                                             *
    2134                    *                                                                        *
    2135                    **************************************************************************
    2136 00009c00           PLSTOPY
    2137 00009c00     098f          MMTM    SP,A0,A1
         00009c10     c000  
    2138 00009c20     5621          CLR     A1
    2139 00009c30     b228          MOVE    A1,*A8(OYVEL),L
         00009c40     0060  
    2140 00009c50     b700          MOVE    *A8(OSHAD),A0,L
         00009c60     0240  
    2141 00009c70     ca02          JREQ    PLSTPYZ1                ;BR = NO TORSO SHADOW
    2142 00009c80     b220          MOVE    A1,*A0(OYVEL),L
         00009c90     0060  
    2143 00009ca0           PLSTPYZ1
    2144 00009ca0                   TEST    A4
    2145 00009cb0     ca07          JREQ    PLSTPYZ2                ;BR = NO LEGS FOR THIS GUY
    2146 00009cc0     b224          MOVE    A1,*A4(OYVEL),L
         00009cd0     0060  
    2147 00009ce0     b680          MOVE    *A4(OSHAD),A0,L
         00009cf0     0240  
    2148 00009d00     ca02          JREQ    PLSTPYZ2                ;BR = NO SHADOW FOR LEGS
    2149 00009d10     b220          MOVE    A1,*A0(OYVEL),L
         00009d20     0060  
    2150 00009d30           PLSTPYZ2
    2151 00009d30     09af          MMFM    SP,A0,A1
         00009d40     0003  
    2152 00009d50     0960          RETS
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   53

    2153                    **************************************************************************
    2154                    *                                                                        *
    2155                    * PLSTOPYZ - CLEAR A TWO PART OBJECTS Y & Z VELOCITY                     *
    2156                    * A4 = PTR TO BOTTOM HALF                                                *
    2157                    * A8 = PTR TO TOP HALF                                                   *
    2158                    *                                                                        *
    2159                    **************************************************************************
    2160 00009d60           PLSTOPYZ
    2161 00009d60     0d3f          CALLR   PLSTOPZ
         00009d70     ffbf  
    2162 00009d80     c0e7          JRUC    PLSTOPY
    2163                    **************************************************************************
    2164                    *                                                                        *
    2165                    * YLFLIP - FLIP A PART 1 LEGS OBJECT IN Y                                *
    2166                    * A4 = PTR TO LEG OBJECT                                                 *
    2167                    *                                                                        *
    2168                    **************************************************************************
    2169 00009d90     098f  YLFLIP  MMTM    SP,A1,A4,A8
         00009da0     4880  
    2170 00009db0     4c88          MOVE    A4,A8
    2171 00009dc0     b504          MOVE    *A8(OFLAGS),A4
         00009dd0     0100  
    2172 00009de0     0ba4          ORI     M_FLIPH,A4
         00009df0 00000010  
    2173 00009e10     c008          JRUC    SETFLAGL
    2174                    **************************************************************************
    2175                    *                                                                        *
    2176                    * NOYLFLIP - UNFLIP A PART 1 LEGS OBJECT IN Y                            *
    2177                    * A4 = PTR TO LEG OBJECT                                                 *
    2178                    *                                                                        *
    2179                    **************************************************************************
    2180 00009e20           NOYLFLIP
    2181 00009e20     098f          MMTM    SP,A1,A4,A8
         00009e30     4880  
    2182 00009e40     4c88          MOVE    A4,A8
    2183 00009e50     b504          MOVE    *A8(OFLAGS),A4
         00009e60     0100  
    2184 00009e70     0b84          ANDNI   M_FLIPH,A4
         00009e80 00000010  
    2185 00009ea0           SETFLAGL
    2186 00009ea0     b701          MOVE    *A8(OIMG),A1,L          ;GET THE CURRENT IMAGE POINTER
         00009eb0     0180  
    2187 00009ec0     0d5f          CALLA   ANI                     ;SETUP THE "NEW" IMAGE
         00009ed0 00000000! 
    2188 00009ef0     09af          MMFM    SP,A1,A4,A8
         00009f00     0112  
    2189 00009f10     0960          RETS
    2190                    
    2191                    **************************************************************************
    2192                    *                                                                        *
    2193                    * Y2FLIP - FLIP A PART 2 TORSO OBJECT IN Y. PLAYER ONLY!                 *
    2194                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    2195                    * A8 = PTR TO TORSO OBJECT                                               *
    2196                    *                                                                        *
    2197                    **************************************************************************
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   54

    2198 00009f20     098f  Y2FLIP  MMTM    SP,A1,A4
         00009f30     4800  
    2199 00009f40     b504          MOVE    *A8(OFLAGS),A4
         00009f50     0100  
    2200 00009f60     0ba4          ORI     M_FLIPH,A4
         00009f70 00000010  
    2201 00009f90     c007          JRUC    SETFLIP2
    2202                    **************************************************************************
    2203                    *                                                                        *
    2204                    * NOY2FLIP - UNFLIP A PART 2 TORSO OBJECT IN Y. PLAYER ONLY!             *
    2205                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    2206                    * A8 = PTR TO TORSO OBJECT                                               *
    2207                    *                                                                        *
    2208                    **************************************************************************
    2209 00009fa0           NOY2FLIP
    2210 00009fa0     098f          MMTM    SP,A1,A4
         00009fb0     4800  
    2211 00009fc0     b504          MOVE    *A8(OFLAGS),A4
         00009fd0     0100  
    2212 00009fe0     0b84          ANDNI   M_FLIPH,A4
         00009ff0 00000010  
    2213 0000a010           SETFLIP2
    2214 0000a010     b701          MOVE    *A8(OIMG),A1,L          ;GET THE CURRENT IMAGE POINTER
         0000a020     0180  
    2215 0000a030     0d5f          CALLA   ANI2                    ;SETUP THE "NEW" IMAGE
         0000a040 00000000! 
    2216 0000a060     09af          MMFM    SP,A1,A4
         0000a070     0012  
    2217 0000a080     0960          RETS
    2218                    
    2219                    **************************************************************************
    2220                    *                                                                        *
    2221                    * PLAYERON - TURN THE PLAYER'S BODY PARTS ON.                            *
    2222                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    2223                    *                                                                        *
    2224                    **************************************************************************
    2225 0000a090           PLAYERON
    2226 0000a090     098f          MMTM    SP,A0,A1,A3,A4,A8
         0000a0a0     d880  
    2227 0000a0b0     b648          MOVE    *A2(POBJ),A8,L
         0000a0c0     00a0  
    2228 0000a0d0     b500          MOVE    *A8(OFLAGS),A0,W
         0000a0e0     0100  
    2229 0000a0f0     2f80          SRL     4,A0
    2230 0000a100     2480          SLL     4,A0
    2231 0000a110     1040          ADDK    2,A0                    ;LIGHT 'EM UP
    2232 0000a120     b008          MOVE    A0,*A8(OFLAGS),W
         0000a130     0100  
    2233 0000a140     b441          MOVE    *A2(PIRQFLAG),A1,W
         0000a150     0080  
    2234 0000a160     0b81          ANDI    MDRIVER|MPASSEN,A1
         0000a170 ffffe7ff  
    2235 0000a190     cb1a          JRNE    PLAYERO1                ;LEGS ARE GONE
    2236 0000a1a0     4c03          MOVE    A0,A3                   ;NORMAL FLAGS HERE
    2237 0000a1b0     4c04          MOVE    A0,A4                   ;SHADOW FLAGS HERE
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   55

    2238 0000a1c0     2f84          SRL     4,A4
    2239 0000a1d0     2484          SLL     4,A4
    2240 0000a1e0     1104          ADDK    8,A4
    2241 0000a1f0     b640          MOVE    *A2(PLOBJ),A0,L
         0000a200     0120  
    2242 0000a210     09e1          MOVI    PLAYERS,A1
         0000a220 00000000! 
    2243 0000a240     0d5f          CALLA   ISSUPP
         0000a250 00000000! 
    2244 0000a270     ca07          JRZ     PLAYERO0
    2245 0000a280     b060          MOVE    A3,*A0(OFLAGS),W        ;LIGHT THE LEGS ALSO
         0000a290     0100  
    2246 0000a2a0     b600          MOVE    *A0(OSHAD),A0,L
         0000a2b0     0240  
    2247 0000a2c0     ca02          JRZ     PLAYERO0                ;NO LEG SHADOW
    2248 0000a2d0     b080          MOVE    A4,*A0(OFLAGS),W
         0000a2e0     0100  
    2249 0000a2f0           PLAYERO0
    2250 0000a2f0     b700          MOVE    *A8(OSHAD),A0,L
         0000a300     0240  
    2251 0000a310     ca02          JRZ     PLAYERO1                ;NO TORSO SHADOW
    2252 0000a320     b080          MOVE    A4,*A0(OFLAGS),W
         0000a330     0100  
    2253 0000a340           PLAYERO1
    2254 0000a340     09af          MMFM    SP,A0,A1,A3,A4,A8
         0000a350     011b  
    2255 0000a360     0960          RETS
    2256                    
    2257                    **************************************************************************
    2258                    *                                                                        *
    2259                    * PLAYEROF - TURN THE PLAYER'S BODY PARTS OFF.                           *
    2260                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    2261                    *                                                                        *
    2262                    **************************************************************************
    2263 0000a370           PLAYEROF
    2264 0000a370     098f          MMTM    SP,A0,A8
         0000a380     8080  
    2265 0000a390     b648          MOVE    *A2(POBJ),A8,L
         0000a3a0     00a0  
    2266 0000a3b0     b500          MOVE    *A8(OFLAGS),A0,W
         0000a3c0     0100  
    2267 0000a3d0     2f80          SRL     4,A0
    2268 0000a3e0     2480          SLL     4,A0
    2269 0000a3f0     b008          MOVE    A0,*A8(OFLAGS),W        ;TORSO OFF
         0000a400     0100  
    2270 0000a410     b448          MOVE    *A2(PIRQFLAG),A8,W
         0000a420     0080  
    2271 0000a430     0b88          ANDI    MDRIVER|MPASSEN,A8
         0000a440 ffffe7ff  
    2272 0000a460     cb04          JRNE    PLAYROF1                ;LEGS ARE GONE
    2273 0000a470     b648          MOVE    *A2(PLOBJ),A8,L
         0000a480     0120  
    2274 0000a490     b008          MOVE    A0,*A8(OFLAGS),W        ;OFF WITH THE LEGS ALSO
         0000a4a0     0100  
    2275 0000a4b0           PLAYROF1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   56

    2276 0000a4b0     09af          MMFM    SP,A0,A8
         0000a4c0     0101  
    2277 0000a4d0     0960          RETS
    2278                    
    2279                    **************************************************************************
    2280                    *                                                                        *
    2281                    * PLAYERCON - TURN THE PLAYER'S BODY PARTS TO CONSTANT ON.               *
    2282                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    2283                    *                                                                        *
    2284                    **************************************************************************
    2285 0000a4e0           PLAYERCON
    2286 0000a4e0     098f          MMTM    SP,A0,A1,A8
         0000a4f0     c080  
    2287 0000a500     b648          MOVE    *A2(POBJ),A8,L
         0000a510     00a0  
    2288 0000a520     b500          MOVE    *A8(OFLAGS),A0,W
         0000a530     0100  
    2289 0000a540     2f80          SRL     4,A0
    2290 0000a550     2480          SLL     4,A0
    2291 0000a560     1100          ADDK    8,A0                    ;LIGHT 'EM UP
    2292 0000a570     b008          MOVE    A0,*A8(OFLAGS),W
         0000a580     0100  
    2293 0000a590     b448          MOVE    *A2(PIRQFLAG),A8,W
         0000a5a0     0080  
    2294 0000a5b0     0b88          ANDI    MDRIVER|MPASSEN,A8
         0000a5c0 ffffe7ff  
    2295 0000a5e0     cb0c          JRNE    PLAYERCO1               ;LEGS ARE GONE
    2296 0000a5f0     4c08          MOVE    A0,A8
    2297 0000a600     b640          MOVE    *A2(PLOBJ),A0,L
         0000a610     0120  
    2298 0000a620     09e1          MOVI    PLAYERS,A1
         0000a630 00000000! 
    2299 0000a650     0d5f          CALLA   ISSUPP
         0000a660 00000000! 
    2300 0000a680     ca02          JRZ     PLAYERCO1
    2301 0000a690     b100          MOVE    A8,*A0(OFLAGS),W        ;LIGHT THE LEGS ALSO
         0000a6a0     0100  
    2302 0000a6b0           PLAYERCO1
    2303 0000a6b0     09af          MMFM    SP,A0,A1,A8
         0000a6c0     0103  
    2304 0000a6d0     0960          RETS
    2305                    
    2306                    **************************************************************************
    2307                    *                                                                        *
    2308                    * CKLBOUND - CHECK OBJECT AGAINST BOUNDRIES. THE PROPER VELOCITY         *
    2309                    *          IS ZERO'D IN BOTH OF A PLAYERS OBJECTS IF A BOUNDRY IS HIT.   *
    2310                    * A4 = PLAYER LEG OBJECT POINTER                                         *
    2311                    * A8 = PLAYER TORSO OBJECT BLOCK PTR                                     *
    2312                    * A9 = PLAYER FLAGS                                                      *
    2313                    *                                                                        *
    2314                    **************************************************************************
    2315 0000a6e0           CKLBOUND
    2316 0000a6e0     098f          MMTM    SP,A0,A1,A2,A3,A6,A7,A10,A13,A14
         0000a6f0     f326  
    2317 0000a700     05a0          MOVE    @GAMSTATE,A0,W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   57

         0000a710 00000000! 
    2318 0000a730     0b40          CMPI    INAMODE,A0
         0000a740     ffcf  
    2319 0000a750     ca03          JREQ    CKLCHKX
    2320 0000a760     0b40          CMPI    INPLAY,A0
         0000a770     ffdf  
    2321 0000a780     cb4f          JRNE    CKBNDX                  ;NOT IN PLAY, DON'T WORRY ABOUT IT
    2322 0000a790           CKLCHKX
    2323                    *DO X BOUNDRIES FIRST
    2324 0000a790     4c83          MOVE    A4,A3
    2325 0000a7a0     b702          MOVE    *A8(OSIZE),A2,L
         0000a7b0     0140  
    2326 0000a7c0     b504          MOVE    *A8(OFLAGS),A4,W
         0000a7d0     0100  
    2327 0000a7e0     b701          MOVE    *A8(OIMG),A1,L
         0000a7f0     0180  
    2328 0000a800     0d5f          CALLA   GANIOF
         0000a810 00000000! 
    2329 0000a830     4c64          MOVE    A3,A4
    2330 0000a840     2e06          SRL     16,A6
    2331 0000a850     0506          SEXT    A6
    2332                    
    2333 0000a860     b501          MOVE    *A8(OXPOS),A1,W
         0000a870     0090  
    2334 0000a880     05a2          MOVE    @WORLDTL,A2,W
         0000a890 00000000! 
    2335 0000a8b0     4441          SUB     A2,A1                   ;ADJUST X FOR WORLD COORDS
    2336 0000a8c0     40c1          ADD     A6,A1                   ;X ANIMATION POINT
    2337                    
    2338 0000a8d0     b702          MOVE    *A8(OXVEL),A2,L         ;GET HIS VELOCITY
         0000a8e0     0040  
    2339 0000a8f0     ca1f          JREQ    CKYBND                  ;BR = NOT MOVING, FORGET IT
    2340 0000a900     ce04          JRN     CKLBND                  ;BR = NEGATIVE, CHECK LEFT
    2341                    
    2342 0000a910     0b41          CMPI    PXMAX,A1                ;TOO FAR RIGHT?
         0000a920     fe0b  
    2343 0000a930     c41b          JRLT    CKYBND                  ;BR = NO
    2344 0000a940     c003          JRUC    CKLBNDSX
    2345                    
    2346 0000a950     0b41  CKLBND  CMPI    PXMIN,A1                ;TOO FAR LEFT?
         0000a960     fff5  
    2347 0000a970     c717          JRGT    CKYBND                  ;BR = NO
    2348 0000a980           CKLBNDSX
    2349 0000a980     0d3f          CALLR   PLSTOPX
         0000a990     fee7  
    2350 0000a9a0     4d21          MOVE    A9,A1   
    2351 0000a9b0     0b81          ANDI    MPASSEN|MDRIVER,A1
         0000a9c0 ffffe7ff  
    2352 0000a9e0     ca10          JREQ    CKYBND                  ;BR = NO CAR AVAILABLE
    2353 0000a9f0     07aa          MOVE    @PLAYCAR,A10,L
         0000aa00 00000000! 
    2354 0000aa20     ca0c          JRZ     CKYBND
    2355 0000aa30     b74d          MOVE    *A10(OPLINK),A13,L
         0000aa40     01f0  
    2356 0000aa50     5621          CLR     A1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   58

    2357 0000aa60     0d5f          CALLA   CARXVEL
         0000aa70 00000000! 
    2358 0000aa90     0d3f          CALLR   ISCHOP
         0000aaa0     08c3  
    2359 0000aab0     ca03          JREQ    CKYBND                  ;A CHOPPER HAS NO WHEEL YOU IDIOT
    2360 0000aac0     0d5f          CALLA   CWHLSTOP
         0000aad0 00000000! 
    2361                    *NOW CHECK THE Z BOUNDRIES
    2362 0000aaf0           CKYBND
    2363 0000aaf0     b702          MOVE    *A8(OZVEL),A2,L
         0000ab00     00e0  
    2364 0000ab10     ca16          JREQ    CKBNDX                  ;BR = NO VELOCITY, NO CHECK
    2365 0000ab20     05ad          MOVE    @PLZMAX,A13,W
         0000ab30 00000000! 
    2366 0000ab50     05ae          MOVE    @PLZMIN,A14,W           ;GET THE Z BOUNDRIES
         0000ab60 00000000! 
    2367                    
    2368 0000ab80     4d21          MOVE    A9,A1   
    2369 0000ab90     0b81          ANDI    MPASSEN|MDRIVER,A1
         0000aba0 ffffe7ff  
    2370 0000abc0     cb0e          JRNE    CKPCZBND                ;BR = HE'S IN THE CAR, CHECK THERE 
    2371                    
    2372 0000abd0     b503          MOVE    *A8(OZPOS),A3,W         ;GET THIS GUYS Z POSITION
         0000abe0     00d0  
    2373 0000abf0     4c42          MOVE    A2,A2
    2374 0000ac00     ce03          JRN     CKUBND                  ;BR = NEGATIVE, CHECK YMIN
    2375                    ***     MOVE    *A8(OZPLUS),A7,W
    2376                    ***     ADD     A7,A3
    2377 0000ac10     49a3          CMP     A13,A3                  ;HIT ROCK BOTTOM?
    2378 0000ac20     c405          JRLT    CKBNDX                  ;BR = NO
    2379 0000ac30     c002          JRUC    CKBNDRZ
    2380 0000ac40           CKUBND
    2381                    ***     MOVE    *A8(OZMINUS),A7,W
    2382                    ***     SUB     A7,A3
    2383 0000ac40     49c3          CMP     A14,A3                  ;AT THE TOP?
    2384 0000ac50     c702          JRGT    CKBNDX                  ;BR = NO
    2385 0000ac60           CKBNDRZ
    2386 0000ac60     0d3f          CALLR   PLSTOPZ                 ;ZERO Y VELOCITY
         0000ac70     fecf  
    2387 0000ac80           CKBNDX
    2388 0000ac80     09af          MMFM    SP,A0,A1,A2,A3,A6,A7,A10,A13,A14
         0000ac90     64cf  
    2389 0000aca0     0960          RETS
    2390                    *Z CHECK WITHIN CAR, A2 = CURRENT Z VELOCITY, A13 = PLZMAX, A14 = PLZMIN
    2391 0000acb0           CKPCZBND
    2392 0000acb0     07aa          MOVE    @PLAYCAR,A10,L          ;GET THE CAR POINTER
         0000acc0 00000000! 
    2393 0000ace0     caf9          JRZ     CKBNDX
    2394 0000acf0     b543          MOVE    *A10(OZPOS),A3,W
         0000ad00     00d0  
    2395 0000ad10     4c66          MOVE    A3,A6
    2396 0000ad20     b547          MOVE    *A10(OZMINUS),A7,W
         0000ad30     01b0  
    2397 0000ad40     44e3          SUB     A7,A3
    2398 0000ad50     b547          MOVE    *A10(OZPLUS),A7,W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   59

         0000ad60     01c0  
    2399 0000ad70     40e6          ADD     A7,A6
    2400 0000ad80     4c42          MOVE    A2,A2
    2401 0000ad90     ce03          JRN     CKPCZUB                 ;BR = NEGATIVE, CHECK ZMIN
    2402 0000ada0     49a6          CMP     A13,A6                  ;HIT ROCK BOTTOM?
    2403 0000adb0     c4ec          JRLT    CKBNDX                  ;BR = NO
    2404 0000adc0     c002          JRUC    CKPCBRZ
    2405 0000add0           CKPCZUB
    2406 0000add0     49c3          CMP     A14,A3                  ;AT THE TOP?
    2407 0000ade0     c7e9          JRGT    CKBNDX                  ;BR = NO
    2408 0000adf0           CKPCBRZ
    2409 0000adf0     0d3f          CALLR   PLSTOPZ                 ;ZERO Y VELOCITY
         0000ae00     feb6  
    2410 0000ae10     b74d          MOVE    *A10(OPLINK),A13,L
         0000ae20     01f0  
    2411 0000ae30     5621          CLR     A1
    2412 0000ae40     0d5f          CALLA   CARYZVEL
         0000ae50 00000000! 
    2413 0000ae70     0d3f          CALLR   ISCHOP
         0000ae80     0885  
    2414 0000ae90     cb05          JRNE    CKPCISC                 ;BR = THIS IS A CAR
    2415 0000aea0     09c0          MOVI    48,A0
         0000aeb0     0030  
    2416 0000aec0     0d3f          CALLR   PSTAKP                  ;STACK THE SLOW DOWN PROC
         0000aed0     fd36  
    2417 0000aee0     c0d9          JRUC    CKBNDX
    2418 0000aef0           CKPCISC
    2419 0000aef0     09c0          MOVI    45,A0
         0000af00     002d  
    2420 0000af10     0d3f          CALLR   PSTAKP                  ;STACK THE SLOW DOWN PROC
         0000af20     fd31  
    2421 0000af30     c0d4          JRUC    CKBNDX
    2422                    
    2423                    **************************************************************************
    2424                    *                                                                        *
    2425                    * P_INBNDS - SEE IF A PLAYER IS IN THE PLAYFIELD BOUNDRIES               *
    2426                    * A2 = PTR TO PLAYER DATA                                                *
    2427                    * RETURNS:                                                               *
    2428                    *       CARRY SET = NOT IN BOUNDS (BETTER RESET HIM)                     *
    2429                    *       CARRY CLR = IN BOUNDS (EITHER HE'S O.K. OR HE DOESN'T EXIST)     *
    2430                    *                                                                        *
    2431                    **************************************************************************
    2432 0000af40           P_INBNDS
    2433 0000af40                   PUSH    A8
    2434 0000af50     b648          MOVE    *A2(POBJ),A8,L
         0000af60     00a0  
    2435 0000af70     cb02          JRNZ    P_INBNDS1
    2436 0000af80     0320          CLRC
    2437 0000af90     c005          JRUC    P_INBNDSX               ;FLAG HIM O.K.
    2438 0000afa0           P_INBNDS1
    2439 0000afa0     0d3f          CALLR   CKLXBND
         0000afb0     0006  
    2440 0000afc0     c802          JRC     P_INBNDSX
    2441 0000afd0     0d3f          CALLR   CKLZBND
         0000afe0     0023  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   60

    2442 0000aff0           P_INBNDSX
    2443 0000aff0                   PULL    A8
    2444 0000b010     0960          RETS
    2445                    
    2446                    **************************************************************************
    2447                    *                                                                        *
    2448                    * CKLXBND - CHECK OBJECT AGAINST X BOUNDRIES.                            *
    2449                    * A8 = PLAYER TORSO OBJECT BLOCK PTR                                     *
    2450                    * RETURNS                                                                *
    2451                    *       CARRY SET = EXCEEDED BOUNDRY                                     *
    2452                    *       CARRY CLR = IN BOUNDS                                            *
    2453                    *                                                                        *
    2454                    **************************************************************************
    2455 0000b020           CKLXBND
    2456 0000b020     098f          MMTM    SP,A2,A4,A6,A7
         0000b030     2b00  
    2457 0000b040     b702          MOVE    *A8(OSIZE),A2,L
         0000b050     0140  
    2458 0000b060     b504          MOVE    *A8(OFLAGS),A4,W
         0000b070     0100  
    2459 0000b080     b701          MOVE    *A8(OIMG),A1,L
         0000b090     0180  
    2460 0000b0a0     0d5f          CALLA   GANIOF                  ;BASED ON ANIMATION POINT
         0000b0b0 00000000! 
    2461 0000b0d0     2a06          SRA     16,A6
    2462 0000b0e0     b502          MOVE    *A8(OXPOS),A2,W
         0000b0f0     0090  
    2463 0000b100     05a7          MOVE    @WORLDTL,A7,W
         0000b110 00000000! 
    2464 0000b130     44e2          SUB     A7,A2                   ;ADJUST X FOR WORLD COORDS
    2465 0000b140     40c2          ADD     A6,A2                   ;X ANIMATION POINT
    2466 0000b150     0b42          CMPI    PXMAX,A2                ;TOO FAR RIGHT?
         0000b160     fe0b  
    2467 0000b170     c401          JRLT    CKLXBND1                ;BR = NO
    2468 0000b180     c003          JRUC    CKLXSC
    2469 0000b190           CKLXBND1
    2470 0000b190     0b42          CMPI    PXMIN,A2                ;TOO FAR LEFT?
         0000b1a0     fff5  
    2471 0000b1b0     c704          JRGT    CKLXCC                  ;BR = NO
    2472 0000b1c0           CKLXSC
    2473 0000b1c0     0de0          SETC
    2474 0000b1d0           CKLXXXX
    2475 0000b1d0     09af          MMFM    SP,A2,A4,A6,A7
         0000b1e0     00d4  
    2476 0000b1f0     0960          RETS
    2477 0000b200           CKLXCC
    2478 0000b200     0320          CLRC
    2479 0000b210     c0fb          JRUC    CKLXXXX
    2480                    **************************************************************************
    2481                    *                                                                        *
    2482                    * CKLZBND - CHECK PLAYER AGAINST Z BOUNDRIES.                            *
    2483                    * A8 = PTR TO PLAYER TORSO                                               *
    2484                    * RETURNS                                                                *
    2485                    *       CARRY SET = EXCEEDED OR EQUAL TO BOUNDRY                         *
    2486                    *       CARRY CLR = IN BOUNDS                                            *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   61

    2487                    *                                                                        *
    2488                    **************************************************************************
    2489 0000b220           CKLZBND
    2490 0000b220     098f          MMTM    SP,A1,A2,A3
         0000b230     7000  
    2491 0000b240     b701          MOVE    *A8(OZVAL),A1,L         ;GET THIS GUYS Z POSITION
         0000b250     00c0  
    2492 0000b260     05a2          MOVE    @PLZMAX,A2,W
         0000b270 00000000! 
    2493 0000b290     05a3          MOVE    @PLZMIN,A3,W            ;GET THE Y BOUNDRIES
         0000b2a0 00000000! 
    2494 0000b2c0     2602          SLL     16,A2
    2495 0000b2d0     2603          SLL     16,A3
    2496 0000b2e0     4841          CMP     A2,A1                   ;HIT ROCK BOTTOM?
    2497 0000b2f0     c405          JRLT    CKLZXCC                 ;BR = NO
    2498 0000b300     c002          JRUC    CKLZXSC
    2499 0000b310     4861          CMP     A3,A1                   ;AT THE TOP?
    2500 0000b320     c702          JRGT    CKLZXCC                 ;BR = NO
    2501 0000b330           CKLZXSC
    2502 0000b330     0de0          SETC
    2503 0000b340     c001          JRUC    CKLZXX
    2504 0000b350           CKLZXCC
    2505 0000b350     0320          CLRC
    2506 0000b360           CKLZXX
    2507 0000b360     09af          MMFM    SP,A1,A2,A3
         0000b370     000e  
    2508 0000b380     0960          RETS
    2509                    
    2510                    **************************************************************************
    2511                    *                                                                        *
    2512                    * CKLBADJ - RE-ADJUST PLAYER IN BOUNDS IF HE IS OUT, IN X,Y & Z          *
    2513                    *               USE ONLY WHILE RESETTING THE PLAYER FROM DEATH OR BUYIN. *
    2514                    * A2 = PLAYER DATA                                                       *
    2515                    *                                                                        *
    2516                    **************************************************************************
    2517 0000b390           CKLBADJ
    2518 0000b390                   PUSH    A0
    2519 0000b3a0     b440          MOVE    *A2(PIRQFLAG),A0,W
         0000b3b0     0080  
    2520 0000b3c0     0b80          ANDI    MDRIVER|MPASSEN|MSITIN,A0
         0000b3d0 ffffc7ff  
    2521 0000b3f0     cb0d          JRNE    CKLBADJX                ;DON'T RESET, IT'S UNCOOL
    2522 0000b400     05a0          MOVE    @GAMSTATE,A0,W
         0000b410 00000000! 
    2523 0000b430     0b40          CMPI    INAMODE,A0
         0000b440     ffcf  
    2524 0000b450     ca03          JREQ    CKLBCHK
    2525 0000b460     0b40          CMPI    INPLAY,A0
         0000b470     ffdf  
    2526 0000b480     cb04          JRNE    CKLBADJX                ;NOT IN PLAY, DON'T WORRY ABOUT IT
    2527 0000b490           CKLBCHK
    2528 0000b490     0d3f          CALLR   CKLZADJ
         0000b4a0     0005  
    2529 0000b4b0     0d3f          CALLR   CKLXADJ
         0000b4c0     0043  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   62

    2530 0000b4d0           CKLBADJX
    2531 0000b4d0                   PULL    A0
    2532 0000b4f0     0960          RETS
    2533                    
    2534                    **************************************************************************
    2535                    *                                                                        *
    2536                    * CKLZADJ - CHECK PLAYER AGAINST IT'S CURRENT Z BOUNDRIES,               *
    2537                    *           IF A BOUNDRY IS HIT OR PASSED, ADJUST TO BOUNDRY             *
    2538                    *           USED TO RESET THE PLAYER INTO THE Z BOUNDRIES                *
    2539                    *           AFTER DEATH FALLS AND THE LIKE.                              *
    2540                    * A2 = PTR PLAYER DATA                                                   *
    2541                    *                                                                        *
    2542                    **************************************************************************
    2543 0000b500           CKLZADJ
    2544 0000b500     098f          MMTM    SP,A0,A1,A3,A4,A5,A6,A7
         0000b510     df00  
    2545 0000b520     b648          MOVE    *A2(POBJ),A8,L
         0000b530     00a0  
    2546 0000b540     ca38          JRZ     CKLZADJX                ;PLAYER IS NON-EXISTANT
    2547 0000b550     b644          MOVE    *A2(PLOBJ),A4,L 
         0000b560     0120  
    2548                    
    2549 0000b570     b440          MOVE    *A2(PIRQFLAG),A0,W
         0000b580     0080  
    2550 0000b590     0b80          ANDI    MJUMP1|MJUMP2|MDRIVER|MPASSEN|MSITIN,A0
         0000b5a0 ffffc7f9  
    2551                    ***     JRNE    CKLNZR                  ;NO Z RESET WHILE JUMPING OR DRIVING
    2552 0000b5c0     cb30          JRNE    CKLZADJX                ;NO Z RESET WHILE JUMPING OR DRIVING
    2553                    
    2554 0000b5d0     4c80          MOVE    A4,A0
    2555 0000b5e0     0d5f          CALLA   SETZPOS                 ;FIRST RESET THE Z POSITION     
         0000b5f0 00000000! 
    2556 0000b610     b681          MOVE    *A4(OZVAL),A1,L         ;MATCH THE FOOT Z POSITION
         0000b620     00c0  
    2557 0000b630     1021          INC     A1                      ;TORSO ALWAYS ON TOP
    2558 0000b640     b228          MOVE    A1,*A8(OZVAL),L
         0000b650     00c0  
    2559 0000b660           CKLNZR
    2560 0000b660     b501          MOVE    *A8(OZPOS),A1,W         ;KEEP THIS BECAUSE OF BRANCH
         0000b670     00d0  
    2561 0000b680     4c26          MOVE    A1,A6
    2562 0000b690     b505          MOVE    *A8(OYPOS),A5,W
         0000b6a0     00b0  
    2563 0000b6b0     b487          MOVE    *A4(OYPOS),A7,W
         0000b6c0     00b0  
    2564                    
    2565 0000b6d0     05a3          MOVE    @PLZMAX,A3,W
         0000b6e0 00000000! 
    2566 0000b700     4423          SUB     A1,A3
    2567 0000b710     c705          JRGT    CKLUZADJ
    2568 0000b720     0383          ABS     A3
    2569 0000b730     4466          SUB     A3,A6
    2570 0000b740     4465          SUB     A3,A5
    2571 0000b750     4467          SUB     A3,A7
    2572 0000b760     c009          JRUC    CKLZADJ1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   63

    2573 0000b770           CKLUZADJ
    2574 0000b770     05a3          MOVE    @PLZMIN,A3,W
         0000b780 00000000! 
    2575 0000b7a0     4461          SUB     A3,A1
    2576 0000b7b0     c711          JRGT    CKLZADJX
    2577 0000b7c0     0381          ABS     A1
    2578 0000b7d0     4026          ADD     A1,A6
    2579 0000b7e0     4025          ADD     A1,A5
    2580 0000b7f0     4027          ADD     A1,A7
    2581 0000b800           CKLZADJ1
    2582 0000b800     0d5f          CALLA   PLSTOPYZ
         0000b810 00009d60' 
    2583 0000b830     b0e4          MOVE    A7,*A4(OYPOS),W
         0000b840     00b0  
    2584 0000b850     b0a8          MOVE    A5,*A8(OYPOS),W
         0000b860     00b0  
    2585 0000b870     2606          SLL     16,A6
    2586 0000b880     b2c4          MOVE    A6,*A4(OZVAL),L
         0000b890     00c0  
    2587 0000b8a0     1026          INC     A6      
    2588 0000b8b0     b2c8          MOVE    A6,*A8(OZVAL),L
         0000b8c0     00c0  
    2589 0000b8d0           CKLZADJX
    2590 0000b8d0     09af          MMFM    SP,A0,A1,A3,A4,A5,A6,A7
         0000b8e0     00fb  
    2591 0000b8f0     0960          RETS
    2592                    
    2593                    **************************************************************************
    2594                    *                                                                        *
    2595                    * CKLXADJ - ADJUST THE PLAYER TO BE WITHIN X BOUNDS, IF HE IS DEEMED OUT *
    2596                    * A2 = PLINDX                                                            *
    2597                    *                                                                        *
    2598                    **************************************************************************
    2599 0000b900           CKLXADJ
    2600 0000b900     098f          MMTM    SP,A0,A1,A3,A4,A6,A7
         0000b910     db00  
    2601                            
    2602 0000b920     b648          MOVE    *A2(POBJ),A8,L
         0000b930     00a0  
    2603 0000b940     ca22          JRZ     CKLXADJX                ;PLAYER IS NON-EXISTANT
    2604 0000b950     b644          MOVE    *A2(PLOBJ),A4,L
         0000b960     0120  
    2605                    
    2606 0000b970     0d5f          CALLA   GETANIX                 ;BOUNDRY CHECK BASED ON X ANIMATION
         0000b980 00000000! 
    2607 0000b9a0     4c01          MOVE    A0,A1
    2608 0000b9b0     0501          SEXT    A1
    2609 0000b9c0     05a0          MOVE    @WORLDTLX+16,A0,W
         0000b9d0 00000010! 
    2610 0000b9f0     4401          SUB     A0,A1                   ;ADJUST X TO THE SCREEN
    2611                    
    2612 0000ba00     b506          MOVE    *A8(OXPOS),A6,W
         0000ba10     0090  
    2613 0000ba20     b487          MOVE    *A4(OXPOS),A7,W
         0000ba30     0090  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   64

    2614                    
    2615 0000ba40     09c3          MOVI    PXMAX,A3
         0000ba50     01f4  
    2616 0000ba60     4423          SUB     A1,A3
    2617 0000ba70     c704          JRGT    CKLRXADJ
    2618 0000ba80     0383          ABS     A3
    2619 0000ba90     4466          SUB     A3,A6
    2620 0000baa0     4467          SUB     A3,A7
    2621 0000bab0     c007          JRUC    CKLXADJ1
    2622 0000bac0           CKLRXADJ
    2623 0000bac0     09c3          MOVI    PXMIN,A3
         0000bad0     000a  
    2624 0000bae0     4461          SUB     A3,A1
    2625 0000baf0     c707          JRGT    CKLXADJX
    2626 0000bb00     0381          ABS     A1
    2627 0000bb10     4026          ADD     A1,A6
    2628 0000bb20     4027          ADD     A1,A7
    2629 0000bb30           CKLXADJ1
    2630 0000bb30     b0e4          MOVE    A7,*A4(OXPOS),W
         0000bb40     0090  
    2631 0000bb50     b0c8          MOVE    A6,*A8(OXPOS),W
         0000bb60     0090  
    2632 0000bb70           CKLXADJX
    2633 0000bb70     09af          MMFM    SP,A0,A1,A3,A4,A6,A7
         0000bb80     00db  
    2634 0000bb90     0960          RETS
    2635                    
    2636                    **************************************************************************
    2637                    *                                                                        *
    2638                    * CKABGND - PLAYER OBJECTS AGAINST THE BACKGROUND. THE PROPER VELOCITY   *
    2639                    *         PROPER ACTIONS WILL BE TAKEN IF HE HITS SOMETHING.             *
    2640                    * A4 = PLAYER LEG OBJECT POINTER                                         *
    2641                    * A8 = PLAYER TORSO OBJECT BLOCK PTR                                     *
    2642                    * A9 = PLAYER FLAGS                                                      *
    2643                    * RETURNS:                                                               *
    2644                    * A14 = COLLISION PLANE FLAGS:                                           *
    2645                    *               BIT 0 = Z                                                *
    2646                    *               BIT 1 = Y                                                *
    2647                    *               BIT 2 = X                                                *
    2648                    *                                                                        *
    2649                    **************************************************************************
    2650 0000bba0           CKABGND
    2651 0000bba0     098f          MMTM    SP,A0,A1,A2,A3,A4,A8
         0000bbb0     f880  
    2652 0000bbc0     5642          CLR     A2
    2653 0000bbd0     4c80          MOVE    A4,A0
    2654 0000bbe0     4d04          MOVE    A8,A4
    2655 0000bbf0     09e1          MOVI    BACKSLST,A1
         0000bc00 00000000! 
    2656 0000bc20     0d3f          CALLR   SCANALL 
         0000bc30     0190  
    2657 0000bc40     4d03          MOVE    A8,A3
    2658 0000bc50     09af          MMFM    SP,A4,A8                ;GET THESE TWO BACK
         0000bc60     0110  
    2659 0000bc70     ca1f          JREQ    CKABGND1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   65

    2660 0000bc80     01e0          PUSHST
    2661 0000bc90     b461          MOVE    *A3(OID),A1,W
         0000bca0     01a0  
    2662 0000bcb0     2f01          SRL     8,A1
    2663 0000bcc0     2501          SLL     8,A1
    2664 0000bcd0     0b41          CMPI    BGDCID,A1
         0000bce0     faff  
    2665 0000bcf0     ca3d          JREQ    CKABORT
    2666 0000bd00     0b41          CMPI    BGGDCID,A1
         0000bd10     f8ff  
    2667 0000bd20     ca3a          JREQ    CKABORT
    2668 0000bd30     0b41          CMPI    SLOTOID,A1
         0000bd40     f5ff  
    2669 0000bd50     ca37          JREQ    CKABORT
    2670 0000bd60     0b41          CMPI    BGWCID,A1
         0000bd70     f9ff  
    2671 0000bd80     ca34          JREQ    CKABORT
    2672 0000bd90     0b41          CMPI    WEEDOID,A1
         0000bda0     f7ff  
    2673 0000bdb0     ca31          JREQ    CKABORT
    2674 0000bdc0     0b41          CMPI    BGNID,A1
         0000bdd0     f43f  
    2675 0000bde0     ca2e          JREQ    CKABORT
    2676 0000bdf0     01c0          POPST
    2677 0000be00     c903          JRNC    CKABGND0                ;WE HIT SOMETHING, ZERO CORRECT VELS
    2678 0000be10     0d3f          CALLR   CKMIDZST                
         0000be20     0039  
    2679 0000be30     c003          JRUC    CKABGND1
    2680 0000be40           CKABGND0
    2681 0000be40     55c2          OR      A14,A2
    2682 0000be50     0d3f          CALLR   CKVSTOP
         0000be60     0028  
    2683 0000be70           CKABGND1
    2684 0000be70     098f          MMTM    SP,A4,A8
         0000be80     0880  
    2685 0000be90     4c80          MOVE    A4,A0
    2686 0000bea0     4d04          MOVE    A8,A4
    2687 0000beb0     09e1          MOVI    CARLIST,A1
         0000bec0 00000000! 
    2688 0000bee0     0d3f          CALLR   SCANALL 
         0000bef0     0164  
    2689 0000bf00     4d03          MOVE    A8,A3
    2690 0000bf10     09af          MMFM    SP,A4,A8                ;GET THESE TWO BACK
         0000bf20     0110  
    2691 0000bf30     ca15          JREQ    CKABGNDX
    2692 0000bf40     01e0          PUSHST
    2693 0000bf50     b461          MOVE    *A3(OID),A1,W
         0000bf60     01a0  
    2694 0000bf70     0b41          CMPI    TRAN1OID,A1
         0000bf80     f3cf  
    2695 0000bf90     ca36          JREQ    CKPORS
    2696 0000bfa0     0b41          CMPI    TRAN2OID,A1
         0000bfb0     f3bf  
    2697 0000bfc0     ca00          JREQ    CKCHOP
         0000bfd0     00c6  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   66

    2698 0000bfe0     0b41          CMPI    INTR2OID,A1
         0000bff0     f39f  
    2699 0000c000     ca0c          JREQ    CKABORT
    2700 0000c010           CKABGNDG                                ;RE-ENTRY AFTER CHECKY POO
    2701 0000c010     01c0          POPST
    2702 0000c020     c903          JRNC    CKABGND2                ;SOMETHING HIT US, SKIP FOR NOW
    2703 0000c030     0d3f          CALLR   CKMIDZST                
         0000c040     0017  
    2704 0000c050     c003          JRUC    CKABGND3
    2705 0000c060           CKABGND2
    2706 0000c060     55c2          OR      A14,A2
    2707 0000c070     0d3f          CALLR   CKVSTOP
         0000c080     0006  
    2708 0000c090           CKABGND3
    2709 0000c090           CKABGNDX
    2710 0000c090     4c4e          MOVE    A2,A14
    2711 0000c0a0     09af          MMFM    SP,A0,A1,A2,A3
         0000c0b0     000f  
    2712 0000c0c0     0960          RETS
    2713 0000c0d0           CKABORT
    2714 0000c0d0     01c0          POPST
    2715 0000c0e0     c0fa          JRUC    CKABGNDX
    2716                    *
    2717                    *STOP VELOCITIES
    2718                    *A14 = COLLISION FLAGS
    2719 0000c0f0           CKVSTOP
    2720 0000c0f0     2fee          SRL     1,A14
    2721 0000c100     c902          JRNC    CKVSTOP1
    2722 0000c110     0d3f          CALLR   PLSTOPZ
         0000c120     fd84  
    2723 0000c130           CKVSTOP1
    2724 0000c130     2fee          SRL     1,A14
    2725 0000c140     c902          JRNC    CKVSTOP2
    2726 0000c150     0d3f          CALLR   PLSTOPY
         0000c160     fda9  
    2727 0000c170           CKVSTOP2
    2728 0000c170     2fee          SRL     1,A14
    2729 0000c180     c902          JRNC    CKVSTOPX
    2730 0000c190     0d3f          CALLR   PLSTOPX                 ;STOP THIS BAD DOG
         0000c1a0     fd66  
    2731 0000c1b0           CKVSTOPX
    2732 0000c1b0     0960          RETS
    2733                    *
    2734                    *STOP Z VELOCITY IF IT'S GOING TO ALLOW THE PLAYER TO CONTINUE
    2735                    * THROUGH AN OBJECT, THIS OCCURANCE COULD PROVE TO BE "TRES BOGAS"
    2736                    *A0 = PLAYER OBJECT
    2737                    *A3 = OBJECT HIT
    2738                    *A14 = COLLISION FLAGS
    2739 0000c1c0           CKMIDZST
    2740 0000c1c0     098f          MMTM    SP,A5,A6
         0000c1d0     0600  
    2741 0000c1e0     b465          MOVE    *A3(OZPOS),A5,W
         0000c1f0     00d0  
    2742 0000c200     b406          MOVE    *A0(OZPOS),A6,W
         0000c210     00d0  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   67

    2743 0000c220     48a6          CMP     A5,A6
    2744 0000c230     c504          JRGE    CKMIDZ1
    2745 0000c240     b406          MOVE    *A0(OZVEL+16),A6,W
         0000c250     00f0  
    2746 0000c260     c606          JRLE    CKMIDZX
    2747 0000c270     c003          JRUC    CKMIDZ2
    2748 0000c280           CKMIDZ1
    2749 0000c280     b406          MOVE    *A0(OZVEL+16),A6,W
         0000c290     00f0  
    2750 0000c2a0     c502          JRGE    CKMIDZX
    2751 0000c2b0           CKMIDZ2
    2752 0000c2b0     0d3f          CALLR   PLSTOPZ
         0000c2c0     fd6a  
    2753 0000c2d0           CKMIDZX
    2754 0000c2d0     09af          MMFM    SP,A5,A6
         0000c2e0     0060  
    2755 0000c2f0     0960          RETS
    2756                    
    2757                    **************************************************************************
    2758                    *                                                                        *
    2759                    * CKPORS - CHECK TO SEE IF WE HIT THE PORSCHE IN THE MIDDLE              *
    2760                    * A3 = PORSCHE OBJECT                                                    *
    2761                    * A4 = PLAYER LEG OBJECT                                                 *
    2762                    * A8 = PLAYER TORSO OBJECT                                               *
    2763                    * A9 = PLAYER FLAGS [EXE,IRQ]                                            *
    2764                    * A14 = COLLISION FLAGS                                                  *
    2765                    *                                                                        *
    2766                    **************************************************************************
    2767 0000c300           CKPORS
    2768 0000c300     1fce          BTST    1,A14   
    2769 0000c310     cacf          JREQ    CKABGNDG                ;BR = NOT JUMPING INTO IT, JUST VELOCITY STOP
    2770 0000c320     098f          MMTM    SP,A5,A6,A7
         0000c330     0700  
    2771 0000c340     4d25          MOVE    A9,A5
    2772 0000c350     2e05          SRL     16,A5
    2773 0000c360     0b85          ANDI    MDHOLD|MDEAD|MDYING,A5
         0000c370 ffffffb9  
    2774 0000c390     cb00          JRNZ    CKPORSXX
         0000c3a0     0085  
    2775                    
    2776 0000c3b0     09af          MMFM    SP,A5,A6,A7
         0000c3c0     00e0  
    2777 0000c3d0     01c0          POPST
    2778 0000c3e0     0783          MOVE    A3,@PLAYCAR,L           ;STORE THE CAR POINTER
         0000c3f0 00000000! 
    2779 0000c410     b660          MOVE    *A3(OPLINK),A0,L
         0000c420     01f0  
    2780 0000c430     ca7c          JRZ     CKPORSXX                ;BR = NO CONTLOHL
    2781 0000c440     ba68          MOVE    *A3(OXVEL),*A8(OXVEL),L ;MATCH VELOCITIES
         0000c450     0040  
         0000c460     0040  
    2782 0000c470     ba68          MOVE    *A3(OYVEL),*A8(OYVEL),L
         0000c480     0060  
         0000c490     0060  
    2783 0000c4a0     ba68          MOVE    *A3(OZVEL),*A8(OZVEL),L
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   68

         0000c4b0     00e0  
         0000c4c0     00e0  
    2784 0000c4d0     ba64          MOVE    *A3(OXVEL),*A4(OXVEL),L ;MATCH VELOCITIES, LEGS TOO
         0000c4e0     0040  
         0000c4f0     0040  
    2785 0000c500     ba64          MOVE    *A3(OYVEL),*A4(OYVEL),L
         0000c510     0060  
         0000c520     0060  
    2786 0000c530     ba64          MOVE    *A3(OZVEL),*A4(OZVEL),L
         0000c540     00e0  
         0000c550     00e0  
    2787                    
    2788 0000c560     4d01          MOVE    A8,A1
    2789 0000c570     0d5f          CALLA   GETA8
         0000c580 00000000! 
    2790 0000c5a0     cb13          JRNZ    CKPORSDR                ;BR = DRIVER ALREADY PRESENT
    2791 0000c5b0     0ba9          ORI     MDRIVER|MSITIN,A9       ;MAKE THIS GUY A DRIVER
         0000c5c0 00002800  
    2792 0000c5e0     4c28          MOVE    A1,A8
    2793 0000c5f0     0d5f          CALLA   PUTA8
         0000c600 00000000! 
    2794                    
    2795 0000c620     09c0          MOVI    49,A0
         0000c630     0031  
    2796 0000c640     0d3f          CALLR   PSTAKP                  ;CREATE EUGENE MESSAGE
         0000c650     fbbe  
    2797                    
    2798 0000c660     b660          MOVE    *A3(OZVAL),A0,L
         0000c670     00c0  
    2799 0000c680     b208          MOVE    A0,*A8(OZVAL),L
         0000c690     00c0  
    2800 0000c6a0     1420          DEC     A0
    2801 0000c6b0     b204          MOVE    A0,*A4(OZVAL),L         ;MAKE SURE THEY'RE IN THE DRIVERS SPOT
         0000c6c0     00c0  
    2802 0000c6d0     c00e          JRUC    CKPORSFR                ;GO LOAD THE FRAMES
    2803 0000c6e0           CKPORSDR
    2804 0000c6e0     4c28          MOVE    A1,A8
    2805 0000c6f0     0ba9          ORI     MPASSEN|MSITIN,A9       ;MAKE THIS GUY A PASSENGER
         0000c700 00003000  
    2806 0000c720     b300          MOVE    A8,*A0(PASSPTR),L
         0000c730     0260  
    2807 0000c740     b660          MOVE    *A3(OZVAL),A0,L
         0000c750     00c0  
    2808 0000c760     1040          ADDK    2,A0
    2809 0000c770     b208          MOVE    A0,*A8(OZVAL),L
         0000c780     00c0  
    2810 0000c790     1420          DEC     A0
    2811 0000c7a0     b204          MOVE    A0,*A4(OZVAL),L         ;IN THE PASSENGERS SPOT WITH YOU
         0000c7b0     00c0  
    2812 0000c7c0           CKPORSFR        
    2813 0000c7c0     09af          MMFM    SP,A2,A3
         0000c7d0     000c  
    2814 0000c7e0     0d3f          CALLR   PLAYERON                ;MAKE SURE THE PLAYER IS ON NOW
         0000c7f0     fd89  
    2815 0000c800     1ae0          MOVK    JUMPINFR,A0
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   69

    2816 0000c810     4cc1          MOVE    A6,A1
    2817 0000c820     0d5f          CALLA   BASFRM                  ;GET THE LEG SCRIPT POINTER     
         0000c830 00000000! 
    2818 0000c850     96cd          MOVE    *A6+,A13,L
    2819 0000c860     b3a2          MOVE    A13,*A2(PLEGAS),L       ;STORE HERE FOR A RESET
         0000c870     0160  
    2820 0000c880     5663          CLR     A3                      ;CLEAR LEG TICKS FOR SURE
    2821 0000c890     56a5          CLR     A5                      ;AND TORSO TICKS
    2822 0000c8a0     86cb          MOVE    *A6,A11,L               ;NOW THE TORSO
    2823 0000c8b0     4c26          MOVE    A1,A6
    2824 0000c8c0     09af          MMFM    SP,A0,A1
         0000c8d0     0003  
    2825                    
    2826                    *MOVE THE PLAYER TO THE PORSCHE OPENING
    2827 0000c8e0     098f          MMTM    SP,A0,A2,A3,A5,A6
         0000c8f0     b600  
    2828 0000c900     098f          MMTM    SP,A4,A8        
         0000c910     0880  
    2829 0000c920     07a8          MOVE    @PLAYCAR,A8,L   
         0000c930 00000000! 
    2830 0000c950     0d5f          CALLA   GETANIXY
         0000c960 00000000! 
    2831 0000c980     b504          MOVE    *A8(OFLAGS),A4,W        
         0000c990     0100  
    2832 0000c9a0     4c45          MOVE    A2,A5
    2833 0000c9b0     4c66          MOVE    A3,A6
    2834 0000c9c0                   PULL    A0
    2835 0000c9e0     0d5f          CALLA   GANISAG                 ;ADJUST THE TORSO PORTION OF THE BOD
         0000c9f0 00000000! 
    2836 0000ca10     4c08          MOVE    A0,A8
    2837 0000ca20                   PULL    A0
    2838 0000ca40     4ca2          MOVE    A5,A2
    2839 0000ca50     4cc3          MOVE    A6,A3
    2840 0000ca60     0d5f          CALLA   GANISAG
         0000ca70 00000000! 
    2841 0000ca90     4c04          MOVE    A0,A4
    2842 0000caa0     09af          MMFM    SP,A0,A2,A3,A5,A6
         0000cab0     006d  
    2843                    
    2844 0000cac0     0b89          ANDNI   MJUMP1|MJUMP2|MCHOLD|MSWALK|MRUN,A9     ;FLAGS DOWN     
         0000cad0 000000e6  
    2845 0000caf0     0d3f          CALLR   P2FRAME
         0000cb00     fcaf  
    2846 0000cb10     0d3f          CALLR   PLAYLEG                 ;ANIMATE THESE FRAMES IN NOW!
         0000cb20     fb7f  
    2847                    
    2848 0000cb30     09c0          MOVI    38,A0
         0000cb40     0026  
    2849 0000cb50     0d3f          CALLR   INCFP2
         0000cb60     fb67  
    2850 0000cb70     0d3f          CALLR   PSTAKP                  ;CREATE TSHADDEL
         0000cb80     fb6b  
    2851 0000cb90     09c0          MOVI    42,A0
         0000cba0     002a  
    2852 0000cbb0     0d3f          CALLR   INCFP2
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   70

         0000cbc0     fb61  
    2853 0000cbd0     0d3f          CALLR   PSTAKP                  ;CREATE LSHADDEL
         0000cbe0     fb65  
    2854 0000cbf0     0960          RETS
    2855 0000cc00           CKPORSXX
    2856 0000cc00     09af          MMFM    SP,A5,A6,A7
         0000cc10     00e0  
    2857 0000cc20     c000          JRUC    CKABGNDG
         0000cc30     ff3d  
    2858                    **************************************************************************
    2859                    *                                                                        *
    2860                    * CKCHOP - CHECK TO SEE IF WE HIT THE CHOPPER BODY                       *
    2861                    * A3 = CHOPPER OBJECT                                                    *
    2862                    * A4 = PLAYER LEG OBJECT                                                 *
    2863                    * A8 = PLAYER TORSO OBJECT                                               *
    2864                    * A9 = PLAYER FLAGS [EXE,IRQ]                                            *
    2865                    * A14 = COLLISION FLAGS                                                  *
    2866                    *                                                                        *
    2867                    **************************************************************************
    2868 0000cc40           CKCHOP
    2869 0000cc40     098f          MMTM    SP,A5
         0000cc50     0400  
    2870 0000cc60     4d25          MOVE    A9,A5
    2871 0000cc70     2e05          SRL     16,A5
    2872 0000cc80     0b85          ANDI    MDHOLD|MDEAD|MDYING,A5
         0000cc90 ffffffb9  
    2873 0000ccb0     cb00          JRNZ    CKCHOPXX
         0000ccc0     0083  
    2874 0000ccd0     09af          MMFM    SP,A5
         0000cce0     0020  
    2875 0000ccf0     01c0          POPST
    2876 0000cd00     0783          MOVE    A3,@PLAYCAR,L           ;STORE THE CHOPPER POINTER
         0000cd10 00000000! 
    2877 0000cd30     b660          MOVE    *A3(OPLINK),A0,L
         0000cd40     01f0  
    2878 0000cd50     ca7a          JRZ     CKCHOPXX                ;BR = NO CONTLOHL
    2879 0000cd60     ba68          MOVE    *A3(OXVEL),*A8(OXVEL),L ;MATCH VELOCITIES
         0000cd70     0040  
         0000cd80     0040  
    2880 0000cd90     ba68          MOVE    *A3(OYVEL),*A8(OYVEL),L
         0000cda0     0060  
         0000cdb0     0060  
    2881 0000cdc0     ba68          MOVE    *A3(OZVEL),*A8(OZVEL),L
         0000cdd0     00e0  
         0000cde0     00e0  
    2882 0000cdf0     ba64          MOVE    *A3(OXVEL),*A4(OXVEL),L ;MATCH VELOCITIES, LEGS TOO
         0000ce00     0040  
         0000ce10     0040  
    2883 0000ce20     ba64          MOVE    *A3(OYVEL),*A4(OYVEL),L
         0000ce30     0060  
         0000ce40     0060  
    2884 0000ce50     ba64          MOVE    *A3(OZVEL),*A4(OZVEL),L
         0000ce60     00e0  
         0000ce70     00e0  
    2885                    
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   71

    2886 0000ce80     4d01          MOVE    A8,A1
    2887 0000ce90     0d5f          CALLA   GETA8
         0000cea0 00000000! 
    2888 0000cec0     cb08          JRNZ    CKCHOPDR                ;BR = DRIVER ALREADY PRESENT
    2889 0000ced0     0ba9          ORI     MDRIVER|MSITIN,A9       ;MAKE THIS GUY A DRIVER
         0000cee0 00002800  
    2890 0000cf00     4c28          MOVE    A1,A8
    2891 0000cf10     0d5f          CALLA   PUTA8
         0000cf20 00000000! 
    2892 0000cf40     c006          JRUC    CKCHOPFR                ;GO LOAD THE FRAMES
    2893 0000cf50           CKCHOPDR
    2894 0000cf50     4c28          MOVE    A1,A8
    2895 0000cf60     0ba9          ORI     MPASSEN|MSITIN,A9       ;MAKE THIS GUY A PASSENGER
         0000cf70 00003000  
    2896 0000cf90     b300          MOVE    A8,*A0(PASSPTR),L
         0000cfa0     0260  
    2897 0000cfb0           CKCHOPFR        
    2898 0000cfb0     b660          MOVE    *A3(OZVAL),A0,L
         0000cfc0     00c0  
    2899 0000cfd0     b702          MOVE    *A8(OZVAL),A2,L
         0000cfe0     00c0  
    2900 0000cff0     4802          CMP     A0,A2                   ;WHICH SIDE IS THIS GUY ON?
    2901 0000d000     c502          JRGE    CKCENTF                 ;IN FRONT OF, ENTER ON FRONT SIDE
    2902 0000d010     1420          DEC     A0                      ;OTHERWISE ENTER ON THE BACK SIDE       
    2903 0000d020     c001          JRUC    CKCENTN
    2904 0000d030           CKCENTF
    2905 0000d030     1040          ADDK    2,A0
    2906 0000d040           CKCENTN
    2907 0000d040     b208          MOVE    A0,*A8(OZVAL),L
         0000d050     00c0  
    2908 0000d060     1420          DEC     A0
    2909 0000d070     b204          MOVE    A0,*A4(OZVAL),L         ;IN THE PASSENGERS SPOT WITH YOU
         0000d080     00c0  
    2910                    
    2911 0000d090     09af          MMFM    SP,A2,A3
         0000d0a0     000c  
    2912 0000d0b0     0d3f          CALLR   PLAYERON                ;MAKE SURE THE PLAYER IS ON NOW
         0000d0c0     fcfc  
    2913 0000d0d0     1b80          MOVK    HELJUMP,A0
    2914 0000d0e0     4cc1          MOVE    A6,A1
    2915 0000d0f0     0d5f          CALLA   BASFRM                  ;GET THE LEG SCRIPT POINTER     
         0000d100 00000000! 
    2916 0000d120     96cd          MOVE    *A6+,A13,L
    2917 0000d130     b3a2          MOVE    A13,*A2(PLEGAS),L       ;STORE HERE FOR A RESET
         0000d140     0160  
    2918 0000d150     5663          CLR     A3                      ;CLEAR LEG TICKS FOR SURE
    2919 0000d160     56a5          CLR     A5                      ;AND TORSO TICKS
    2920 0000d170     86cb          MOVE    *A6,A11,L               ;NOW THE TORSO
    2921 0000d180     4c26          MOVE    A1,A6
    2922 0000d190     09af          MMFM    SP,A0,A1
         0000d1a0     0003  
    2923                    *MOVE THE PLAYER TO THE CHOPPER OPENING
    2924 0000d1b0     098f          MMTM    SP,A0,A2,A3,A5,A6
         0000d1c0     b600  
    2925 0000d1d0     098f          MMTM    SP,A4,A8        
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   72

         0000d1e0     0880  
    2926 0000d1f0     07a8          MOVE    @PLAYCAR,A8,L   
         0000d200 00000000! 
    2927 0000d220     0d5f          CALLA   GETANIXY
         0000d230 00000000! 
    2928 0000d250     b504          MOVE    *A8(OFLAGS),A4,W        
         0000d260     0100  
    2929 0000d270     4c45          MOVE    A2,A5
    2930 0000d280     4c66          MOVE    A3,A6
    2931 0000d290                   PULL    A0
    2932 0000d2b0     0d5f          CALLA   GANISAG                 ;ADJUST THE TORSO PORTION OF THE BOD
         0000d2c0 00000000! 
    2933 0000d2e0     4c08          MOVE    A0,A8
    2934 0000d2f0                   PULL    A0
    2935 0000d310     4ca2          MOVE    A5,A2
    2936 0000d320     4cc3          MOVE    A6,A3
    2937 0000d330     0d5f          CALLA   GANISAG
         0000d340 00000000! 
    2938 0000d360     4c04          MOVE    A0,A4
    2939 0000d370     09af          MMFM    SP,A0,A2,A3,A5,A6
         0000d380     006d  
    2940 0000d390     0b89          ANDNI   MJUMP1|MJUMP2|MCHOLD|MSWALK|MRUN,A9     ;FLAGS DOWN     
         0000d3a0 000000e6  
    2941 0000d3c0     0ba9          ORI     MUNLIMIT,A9                             ;FREE ROCKETS EVERYONE
         0000d3d0 00004000  
    2942 0000d3f0     0d3f          CALLR   P2FRAME
         0000d400     fc1f  
    2943 0000d410     0d3f          CALLR   PLAYLEG                 ;ANIMATE THESE FRAMES IN NOW!
         0000d420     faef  
    2944 0000d430     09c0          MOVI    38,A0
         0000d440     0026  
    2945 0000d450     0d3f          CALLR   INCFP2
         0000d460     fad7  
    2946 0000d470     0d3f          CALLR   PSTAKP                  ;CREATE TSHADDEL
         0000d480     fadb  
    2947 0000d490     09c0          MOVI    42,A0
         0000d4a0     002a  
    2948 0000d4b0     0d3f          CALLR   INCFP2
         0000d4c0     fad1  
    2949 0000d4d0     0d3f          CALLR   PSTAKP                  ;CREATE LSHADDEL
         0000d4e0     fad5  
    2950 0000d4f0     0960          RETS
    2951 0000d500           CKCHOPXX
    2952 0000d500     09af          MMFM    SP,A5
         0000d510     0020  
    2953 0000d520     c000          JRUC    CKABGNDG
         0000d530     fead  
    2954                    
    2955                    **************************************************************************
    2956                    *                                                                        *
    2957                    * SCANALL - SCAN FOR COLLISIONS FIRST WITHOUT VELOCITY ADDITION, AND THE *
    2958                    *         NEXT POSITION.                                                 *
    2959                    * A0 = OBJECT TO CHECK                                                   *
    2960                    * A1 = LIST OF OBJECTS TO CHECK AGAINST                                  *
    2961                    * RETURNS:                                                               *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   73

    2962                    * A8 = OBJECT HIT, NULL IF NO COLLISIONS                                 *
    2963                    * A14 = FLAGS OF COLLISION POSITION                                      *
    2964                    *      BIT 0 SET = COLLISION MOVING IN Z                                 *
    2965                    *      BIT 1 SET = COLLISION MOVING IN Y                                 *      
    2966                    *      BIT 2 SET = COLLISION MOVING IN X                                 *
    2967                    * Z BIT SET = NO COLLISION                                               *
    2968                    *  IF Z BIT CLR                                                          *
    2969                    *   CARRY SET = OBJECT WAS HIT                                           *
    2970                    *   CARRY CLR = OBJECT RAN INTO ANOTHER ONE                              *
    2971                    *                                                                        *
    2972                    **************************************************************************
    2973 0000d540           SCANALL
    2974 0000d540     098f          MMTM    SP,A5,A6,A7
         0000d550     0700  
    2975 0000d560     57ce          CLR     A14
    2976 0000d570     0d5f          CALLA   COLSCAN1        
         0000d580 00000000! 
    2977 0000d5a0     ca04          JREQ    SCANALL1        ;NO COLLISIONS
    2978 0000d5b0     0de0          SETC                    ;OBJECT WAS HIT
    2979 0000d5c0     09af          MMFM    SP,A5,A6,A7
         0000d5d0     00e0  
    2980 0000d5e0     0960          RETS
    2981 0000d5f0           SCANALL1
    2982 0000d5f0     098f          MMTM    SP,A2,A3,A4,A9,A10,A11,A12
         0000d600     3878  
    2983 0000d610     4c0c          MOVE    A0,A12
    2984 0000d620     0b0c          ADDI    OXVEL,A12
         0000d630     0040  
    2985 0000d640     09ac          MMFM    A12,A2,A3,A4,A9,A10,A11 ;GET ALL COORDS. AND VELS.
         0000d650     0e1c  
    2986 0000d660     098f          MMTM    SP,A3,A4,A9     ;PUSH OLD COORDS.
         0000d670     1840  
    2987 0000d680     4169          ADD     A11,A9          ;NEXT X POSITION
    2988 0000d690     4144          ADD     A10,A4          ;NEXT Y POSITION
    2989 0000d6a0     4043          ADD     A2,A3           ;NEXT Z POSITION
    2990 0000d6b0     140c          SUBK    32,A12
    2991 0000d6c0     098c          MMTM    A12,A3,A4,A9    ;INSTALL NEW COORDS.
         0000d6d0     1840  
    2992 0000d6e0     0d5f          CALLA   COLSCAN1
         0000d6f0 00000000! 
    2993 0000d710     09af          MMFM    SP,A2,A10,A11   ;PULL OLD COORDS.
         0000d720     0c04  
    2994 0000d730     cb05          JRNE    SCANALXY        ;BR = COLLISION CHECK WHICH
    2995 0000d740     0b0c          ADDI    60H,A12
         0000d750     0060  
    2996 0000d760     098c          MMTM    A12,A2,A10,A11  ;SHOVE OLD COORDS. BACK
         0000d770     2030  
    2997 0000d780     c024          JRUC    SCANALL5        ;AND GET LOST
    2998                    *OBJECT HIT SOMETHING HERE, CHECK TO SEE WHICH VELOCITIES CAUSED THE COLLISION
    2999 0000d790           SCANALXY
    3000 0000d790     4c0c          MOVE    A0,A12
    3001 0000d7a0     b24c          MOVE    A2,*A12(OZVAL),L        ;RESTORE OLD Z
         0000d7b0     00c0  
    3002 0000d7c0     b34c          MOVE    A10,*A12(OYVAL),L ;RESTORE OLD Y
         0000d7d0     00a0  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   74

    3003 0000d7e0     0d5f          CALLA   CKOBJXY         ;CHECK IF COLLISION WAS IN X
         0000d7f0 00000000! 
    3004 0000d810     ca03          JREQ    SCANALL2
    3005 0000d820     0bae          ORI     4,A14
         0000d830 00000004  
    3006 0000d850           SCANALL2
    3007 0000d850     b36c          MOVE    A11,*A12(OXVAL),L       ;RESTORE OLD X
         0000d860     0080  
    3008 0000d870     b28c          MOVE    A4,*A12(OYVAL),L        ;PUT IN NEW Y
         0000d880     00a0  
    3009 0000d890     0d5f          CALLA   CKOBJXY         ;CHECK IF COLLISION WAS IN Y
         0000d8a0 00000000! 
    3010 0000d8c0     ca03          JREQ    SCANALL3
    3011 0000d8d0     0bae          ORI     2,A14
         0000d8e0 00000002  
    3012 0000d900           SCANALL3
    3013 0000d900     b34c          MOVE    A10,*A12(OYVAL),L ;RESTORE OLD Y AGAIN
         0000d910     00a0  
    3014 0000d920     b26c          MOVE    A3,*A12(OZVAL),L ;NEW Z
         0000d930     00c0  
    3015 0000d940     0d5f          CALLA   CKOBJXY
         0000d950 00000000! 
    3016 0000d970     ca03          JREQ    SCANALL4
    3017 0000d980     0bae          ORI     1,A14
         0000d990 00000001  
    3018 0000d9b0           SCANALL4
    3019 0000d9b0     b24c          MOVE    A2,*A12(OZVAL),L ;RESTORE OLD Z
         0000d9c0     00c0  
    3020 0000d9d0           SCANALL5
    3021 0000d9d0     09af          MMFM    SP,A2,A3,A4,A9,A10,A11,A12
         0000d9e0     1e1c  
    3022 0000d9f0     4dce          MOVE    A14,A14         ;SET COLLISION FLAG
    3023 0000da00     0320          CLRC                    ;MAKE SURE CARRY IS CLEAR
    3024 0000da10     09af          MMFM    SP,A5,A6,A7
         0000da20     00e0  
    3025 0000da30     0960          RETS
    3026                    
    3027                    **************************************************************************
    3028                    *                                                                        *
    3029                    * PxHYPHIT - PLAYER HIT BY HYPODERMIC HEADER                             *
    3030                    *                                                                        *
    3031                    **************************************************************************
    3032 0000da40           P1HYPHIT
    3033 0000da40     09e2          MOVI    P1DATA,A2
         0000da50 00000000! 
    3034 0000da70     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000da80 00000000! 
    3035 0000daa0     c000          JRUC    PHYPOHIT
         0000dab0     01c4  
    3036 0000dac0           P2HYPHIT
    3037 0000dac0     09e2          MOVI    P2DATA,A2
         0000dad0 00000000! 
    3038 0000daf0     09ea          MOVI    P1DIE,A10
         0000db00 00000000! 
    3039 0000db20     c000          JRUC    PHYPOHIT
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   75

         0000db30     01bc  
    3040                    
    3041                    **************************************************************************
    3042                    *                                                                        *
    3043                    * DEATH PROCESSES                                                        *
    3044                    * A8  = OBLOCK PTR                                                       *
    3045                    * A9  = FLAGS                                                            *
    3046                    * A10 = PTR TO ANIMATION TAB                                             *
    3047                    * A11 = FRAME NUMBER                                                     *
    3048                    *                                                                        *
    3049                    **************************************************************************
    3050                    *PLAYER 1 DEATH SEQUENCE
    3051 0000db40           P1DETH
    3052 0000db40     09e0          MOVI    P1BHIT,A0
         0000db50 00000000! 
    3053 0000db70     18a1          MOVK    5,A1
    3054 0000db80     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000db90 00000000! 
    3055 0000dbb0     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000dbc0 00000000! 
    3056 0000dbe0     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000dbf0 00000000! 
    3057 0000dc10     c000          JRUC    PDEATH
         0000dc20     011b  
    3058                    
    3059                    *PLAYER 2 DEATH SEQUENCE
    3060 0000dc30           P2DETH
    3061 0000dc30     09e0          MOVI    P1BHIT,A0
         0000dc40 00000000! 
    3062 0000dc60     18a1          MOVK    5,A1
    3063 0000dc70     09e2          MOVI    P2DATA,A2
         0000dc80 00000000! 
    3064 0000dca0     09e9          MOVI    P1SHAKE,A9
         0000dcb0 00000000! 
    3065 0000dcd0     09ea          MOVI    P1DIE,A10
         0000dce0 00000000! 
    3066 0000dd00     c000          JRUC    PDEATH
         0000dd10     010c  
    3067                    *
    3068                    *PLAYER 1 HEAD BUTT PROC
    3069 0000dd20           P1HEADB
    3070 0000dd20     09e0          MOVI    P1BHIT,A0
         0000dd30 00000000! 
    3071 0000dd50     18a1          MOVK    5,A1
    3072 0000dd60     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000dd70 00000000! 
    3073 0000dd90     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000dda0 00000000! 
    3074 0000ddc0     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000ddd0 00000000! 
    3075 0000ddf0     c00e          JRUC    PHEADBUT
    3076                    *
    3077                    *PLAYER 2 HEAD BUTT PROC
    3078 0000de00           P2HEADB
    3079 0000de00     09e0          MOVI    P1BHIT,A0
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   76

         0000de10 00000000! 
    3080 0000de30     18a1          MOVK    5,A1
    3081 0000de40     09e2          MOVI    P2DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000de50 00000000! 
    3082 0000de70     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000de80 00000000! 
    3083 0000dea0     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000deb0 00000000! 
    3084 0000ded0     0300          JRUC    PHEADBUT
    3085                    *
    3086                    *HEAD BUTT ROUTINE
    3087 0000dee0           PHEADBUT
    3088 0000dee0     b443          MOVE    *A2(PIRQFLAG),A3,W
         0000def0     0080  
    3089 0000df00     0b83          ANDI    MDRIVER|MPASSEN,A3
         0000df10 ffffe7ff  
    3090 0000df30     ca00          JREQ    PDEATH                  ;JUST DO NORMAL DEATH
         0000df40     00e9  
    3091 0000df50     b440          MOVE    *A2(PEXEFLAG),A0,W
         0000df60     0090  
    3092 0000df70     0b80          ANDNI   MDHOLD,A0
         0000df80 00000040  
    3093 0000dfa0     b002          MOVE    A0,*A2(PEXEFLAG),W
         0000dfb0     0090  
    3094 0000dfc0     4c4b          MOVE    A2,A11
    3095 0000dfd0                   CREATE  INDPID,ESCAPEJ          ;ESCAPE BY WAY OF THE JUMP BUTTON
    3096 0000e050                   SLEEP   3
    3097 0000e090                   DIE     
    3098                    **************************************************************************
    3099                    *                                                                        *
    3100                    * PxKNIFE - PLAYER KNIFE HIT HEADERS                                     *
    3101                    *                                                                        *
    3102                    **************************************************************************
    3103                    *PLAYER 1 KNIFE SEQUENCE
    3104 0000e0c0           P1KNIFE
    3105 0000e0c0     09e0          MOVI    P1BHIT,A0
         0000e0d0 00000000! 
    3106 0000e0f0     1941          MOVK    10,A1
    3107 0000e100     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000e110 00000000! 
    3108 0000e130     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000e140 00000000! 
    3109 0000e160     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000e170 00000000! 
    3110 0000e190     c000          JRUC    PDEATH
         0000e1a0     00c3  
    3111                    
    3112                    *PLAYER 2 KNIFE SEQUENCE
    3113 0000e1b0           P2KNIFE
    3114 0000e1b0     09e0          MOVI    P1BHIT,A0
         0000e1c0 00000000! 
    3115 0000e1e0     1941          MOVK    10,A1
    3116 0000e1f0     09e2          MOVI    P2DATA,A2
         0000e200 00000000! 
    3117 0000e220     09e9          MOVI    P1SHAKE,A9
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   77

         0000e230 00000000! 
    3118 0000e250     09ea          MOVI    P1DIE,A10
         0000e260 00000000! 
    3119 0000e280     c000          JRUC    PDEATH
         0000e290     00b4  
    3120                    
    3121                    **************************************************************************
    3122                    *                                                                        *
    3123                    * PxBUGGER - BUG BITE PROCESS HEADER                                     *
    3124                    * A9 = AMOUNT OF ENERGY TO SUBTRACT, 32 BITS                             *
    3125                    *                                                                        *
    3126                    **************************************************************************
    3127 0000e2a0           P1BUGGER
    3128 0000e2a0     09e0          MOVI    P1BHIT,A0       
         0000e2b0 00000000! 
    3129 0000e2d0     4d21          MOVE    A9,A1
    3130 0000e2e0     09e2          MOVI    P1DATA,A2
         0000e2f0 00000000! 
    3131 0000e310     5729          CLR     A9
    3132 0000e320     09ea          MOVI    P1DIE,A10
         0000e330 00000000! 
    3133 0000e350     c000          JRUC    PBUGGER
         0000e360     01e7  
    3134 0000e370           P2BUGGER
    3135 0000e370     09e0          MOVI    P1BHIT,A0       
         0000e380 00000000! 
    3136 0000e3a0     4d21          MOVE    A9,A1
    3137 0000e3b0     09e2          MOVI    P2DATA,A2
         0000e3c0 00000000! 
    3138 0000e3e0     5729          CLR     A9
    3139 0000e3f0     09ea          MOVI    P1DIE,A10
         0000e400 00000000! 
    3140 0000e420     c000          JRUC    PBUGGER
         0000e430     01da  
    3141                    **************************************************************************
    3142                    *                                                                        *
    3143                    * PxEXPL - PLAYER HIT BY AN EXPLOSION                                    *
    3144                    *                                                                        *
    3145                    **************************************************************************
    3146                    *PLAYER 1 EXPLOSION
    3147 0000e440           P1EXPL
    3148 0000e440     09e0          MOVI    P1BHIT,A0
         0000e450 00000000! 
    3149 0000e470     18c1          MOVK    6,A1
    3150 0000e480     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000e490 00000000! 
    3151 0000e4b0     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000e4c0 00000000! 
    3152 0000e4e0     c000          JRUC    PEXPLODE
         0000e4f0     0211  
    3153                    
    3154                    *PLAYER 2 EXPLOSION
    3155 0000e500           P2EXPL
    3156 0000e500     09e0          MOVI    P1BHIT,A0
         0000e510 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   78

    3157 0000e530     18c1          MOVK    6,A1
    3158 0000e540     09e2          MOVI    P2DATA,A2
         0000e550 00000000! 
    3159 0000e570     09ea          MOVI    P1DIE,A10
         0000e580 00000000! 
    3160 0000e5a0     c000          JRUC    PEXPLODE
         0000e5b0     0205  
    3161                    
    3162                    **************************************************************************
    3163                    *                                                                        *
    3164                    * PxROCKER - PLAYER HIT BY SPEEDING ROCKET BOMB                          *
    3165                    *                                                                        *
    3166                    **************************************************************************
    3167                    *PLAYER 1 ROCKET BOMB HIT
    3168 0000e5c0           P1ROCKER
    3169 0000e5c0     09e0          MOVI    PEXPSND,A0
         0000e5d0 0000ec80' 
    3170 0000e5f0     1901          MOVK    8,A1
    3171 0000e600     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000e610 00000000! 
    3172 0000e630     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000e640 00000000! 
    3173 0000e660     c000          JRUC    PROCKHIT
         0000e670     0280  
    3174                    *
    3175                    *PLAYER 2 ROCKET BOMB HIT
    3176 0000e680           P2ROCKER
    3177 0000e680     09e0          MOVI    PEXPSND,A0
         0000e690 0000ec80' 
    3178 0000e6b0     1901          MOVK    8,A1
    3179 0000e6c0     09e2          MOVI    P2DATA,A2
         0000e6d0 00000000! 
    3180 0000e6f0     09ea          MOVI    P1DIE,A10
         0000e700 00000000! 
    3181 0000e720     c000          JRUC    PROCKHIT
         0000e730     0274  
    3182                    
    3183                    **************************************************************************
    3184                    *                                                                        *
    3185                    * PxCARHIT - PLAYER HIT BY SPEEDING CAR                                  *
    3186                    *                                                                        *
    3187                    **************************************************************************
    3188                    *PLAYER 1 CAR HIT
    3189 0000e740           P1CARHIT
    3190 0000e740     09e0          MOVI    PCAREXP,A0
         0000e750 0000ece0' 
    3191 0000e770     1901          MOVK    8,A1
    3192 0000e780     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000e790 00000000! 
    3193 0000e7b0     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000e7c0 00000000! 
    3194 0000e7e0     c000          JRUC    PCARHIT
         0000e7f0     02ac  
    3195                    *
    3196                    *PLAYER 2 CAR HIT
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   79

    3197 0000e800           P2CARHIT
    3198 0000e800     09e0          MOVI    PCAREXP,A0
         0000e810 0000ece0' 
    3199 0000e830     1901          MOVK    8,A1
    3200 0000e840     09e2          MOVI    P2DATA,A2
         0000e850 00000000! 
    3201 0000e870     09ea          MOVI    P1DIE,A10
         0000e880 00000000! 
    3202 0000e8a0     c000          JRUC    PCARHIT
         0000e8b0     02a0  
    3203                    
    3204                    **************************************************************************
    3205                    *                                                                        *
    3206                    * PxGARBAGE - PLAYER HIT BY A FLYING GARBAGE CAN                         *
    3207                    *                                                                        *
    3208                    **************************************************************************
    3209                    *PLAYER 1 GARBAGE CAN HIT
    3210 0000e8c0           P1GARBAGE
    3211 0000e8c0     09e0          MOVI    PGARBSND,A0
         0000e8d0 0000ed40' 
    3212 0000e8f0     1821          MOVK    1,A1
    3213 0000e900     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         0000e910 00000000! 
    3214 0000e930     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000e940 00000000! 
    3215 0000e960     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000e970 00000000! 
    3216 0000e990     c000          JRUC    PGARBHIT
         0000e9a0     0265  
    3217                    *
    3218                    *PLAYER 2 GARBAGE CAN HIT
    3219 0000e9b0           P2GARBAGE
    3220 0000e9b0     09e0          MOVI    PGARBSND,A0
         0000e9c0 0000ed40' 
    3221 0000e9e0     1821          MOVK    1,A1
    3222 0000e9f0     09e2          MOVI    P2DATA,A2
         0000ea00 00000000! 
    3223 0000ea20     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000ea30 00000000! 
    3224 0000ea50     09ea          MOVI    P1DIE,A10
         0000ea60 00000000! 
    3225 0000ea80     c000          JRUC    PGARBHIT
         0000ea90     0256  
    3226                    
    3227                    **************************************************************************
    3228                    *                                                                        *
    3229                    * PxDUMP - PLAYER HIT BY A FLYING DUMPSTER                               *
    3230                    *                                                                        *
    3231                    **************************************************************************
    3232                    *PLAYER 1 DUMPSTER HIT
    3233 0000eaa0           P1DUMP
    3234 0000eaa0     09e0          MOVI    PDUMPHIT,A0
         0000eab0 0000ed90' 
    3235 0000ead0     1941          MOVK    10,A1
    3236 0000eae0     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   80

         0000eaf0 00000000! 
    3237 0000eb10     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000eb20 00000000! 
    3238 0000eb40     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         0000eb50 00000000! 
    3239 0000eb70     c000          JRUC    PGARBHIT
         0000eb80     0247  
    3240                    *
    3241                    *PLAYER 2 DUMPSTER HIT
    3242 0000eb90           P2DUMP
    3243 0000eb90     09e0          MOVI    PDUMPHIT,A0
         0000eba0 0000ed90' 
    3244 0000ebc0     1941          MOVK    10,A1
    3245 0000ebd0     09e2          MOVI    P2DATA,A2
         0000ebe0 00000000! 
    3246 0000ec00     09e9          MOVI    P1SHAKE,A9              ;POINTER TO BULLET HIT SHAKE FRAMES
         0000ec10 00000000! 
    3247 0000ec30     09ea          MOVI    P1DIE,A10
         0000ec40 00000000! 
    3248 0000ec60     c000          JRUC    PGARBHIT
         0000ec70     0238  
    3249                    
    3250                    *
    3251                    *PLAYER SOUNDS
    3252 0000ec80     f026  PEXPSND .WORD   0F000H|EXPLOPRI+1,010H,08031H,020H,080C9H,0 ;EXPLODE & SCREAM
    3253 0000ece0     f020  PCAREXP .WORD   0F000H|SPEAKPRI,0AH,08044H,020H,080C9H,0 ;CAR THUD WITH SCREAM
    3254 0000ed40     f01f  PGARBSND .WORD  0F000H|SPEAKPRI-1,010H,08044H,08014H,0 ;PLAYER GARBAGE CAN HIT
    3255 0000ed90     f420  PDUMPHIT .WORD  0F000H|SPEAKPRI|NINTEQ,018H,08010H,08014H,0 ;DUMPSTER HITTING PLAYER
    3256                    
    3257                    **************************************************************************
    3258                    *                                                                        *
    3259                    * PLAYER DEATH PROCESS                                                   *
    3260                    * A0 = SOUND TO MAKE                                                     *
    3261                    * A1 = # OF HIT POINTS TO TAKE AWAY                                      *
    3262                    * A2 = PLINDX=PLAYER DATA STRUCTURE                                      *
    3263                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
    3264                    * A9 = SHAKE FRAME TABLE PTR                                             *
    3265                    * A10= DEATH FRAME TABLE PTR                                             *
    3266                    *                                                                        *
    3267                    **************************************************************************
    3268 0000ede0           PDEATH
    3269 0000ede0     4f01          MOVE    A8,B1                   ;KEEP COLLIDING OBJECT PTR HERE                 
    3270 0000edf0     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         0000ee00     00a0  
    3271 0000ee10     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS
         0000ee20     0120  
    3272 0000ee30     4c8b          MOVE    A4,A11                  ;STORE HERE FOR FUN
    3273                            
    3274 0000ee40     b20d          MOVE    A0,*A13(PDATA),L        ;STORE THE SOUND HERE
         0000ee50     0060  
    3275 0000ee60     b02d          MOVE    A1,*A13(PDATA+20H),W    ;STORE HIT POINTS
         0000ee70     0080  
    3276                    
    3277 0000ee80           PDEATHMV
    3278 0000ee80                   PUSHP   A2                      ;STACK THE BLOCK POINTER
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   81

    3279 0000ee90     b645          MOVE    *A2(PFLAGS),A5,L
         0000eea0     0080  
    3280 0000eeb0     1d85          BTST    BBUYIN,A5
    3281 0000eec0     cb79          JRNE    PDEATHX                 ;BR = SOMETHINGS FUNKY
    3282 0000eed0     4ca0          MOVE    A5,A0
    3283 0000eee0     0b80          ANDI    MDRIVER|MPASSEN,A0
         0000eef0 ffffe7ff  
    3284 0000ef10     cb00          JRNE    PHITINC                 ;HIT WHILE IN THE CAR
         0000ef20     0488  
    3285                    
    3286 0000ef30     0d3f          CALLR   CKLXBND                 ;CHECK FOR EXCEEDED BOUNDRIES
         0000ef40     fc0d  
    3287 0000ef50     c808          JRC     PDEATH3
    3288                    ***     MOVI    [12,0],A0
    3289 0000ef60     b630          MOVE    *B1(OXVEL),B0,L
         0000ef70     0040  
    3290 0000ef80     ca05          JRZ     PDEATH3
    3291 0000ef90     4e10          MOVE    B0,A0
    3292 0000efa0     2420          SLL     1,A0    
    3293                    ***     JRNN    PDEATH2
    3294                    ***     NEG     A0
    3295 0000efb0           PDEATH2
    3296 0000efb0     0d5f          CALLA   PPOSADDX                ;ADD THIS TO PLAYER POSITION
         0000efc0 00000000! 
    3297 0000efe0           PDEATH3
    3298 0000efe0     1dc5          BTST    BDYING,A5
    3299 0000eff0     cb00          JRNE    PFLASHD                 ;BR = JUST FLASH AND MAKE WHOOPY
         0000f000     04be  
    3300 0000f010     2e05          SRL     16,A5
    3301 0000f020     0ba5          ORI     MDYING,A5               ;TURN OFF THE SAFETY
         0000f030 00000002  
    3302 0000f050     b0a2          MOVE    A5,*A2(PEXEFLAG),W
         0000f060     0090  
    3303                    
    3304 0000f070     0d3f          CALLR   PLAYERON                ;MAKE SURE THE PLAYER IS ON
         0000f080     fb00  
    3305                    
    3306 0000f090     b446          MOVE    *A2(PIRQFLAG),A6,W
         0000f0a0     0080  
    3307 0000f0b0     0b86          ANDI    MJUMP1|MJUMP2,A6
         0000f0c0 fffffff9  
    3308 0000f0e0     cb02          JRNE    PDEATH5                 ;BR = JUMPING, DON'T STOP ME NOW 
    3309 0000f0f0     0d3f          CALLR   PLSTOP
         0000f100     fa6d  
    3310 0000f110           PDEATH5
    3311 0000f110     4d64          MOVE    A11,A4
    3312 0000f120     0d5f          CALLA   PLEGOFF
         0000f130 00000000! 
    3313 0000f150     4d60          MOVE    A11,A0
    3314 0000f160     09e1          MOVI    PLAYERS,A1
         0000f170 00000000! 
    3315 0000f190     0d5f          CALLA   ISSUPP
         0000f1a0 00000000! 
    3316 0000f1c0     ca03          JRZ     PDEATH6                 ;HE'S ALREADY GONE
    3317 0000f1d0     0d5f          CALLA   DELSUPP
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   82

         0000f1e0 00000000! 
    3318 0000f200           PDEATH6
    3319 0000f200     5621          CLR     A1
    3320 0000f210                   JSRP    FRANIM                  ;FIRST FRAME
    3321 0000f280     b7a0          MOVE    *A13(PDATA),A0,L
         0000f290     0060  
    3322 0000f2a0     0d5f          CALLA   ONESND                  ;SOUND IS OF COURSE SLOWER THAN LIGHT
         0000f2b0 00000000! 
    3323 0000f2d0     1821          MOVK    1,A1
    3324 0000f2e0                   JSRP    FRANIM                  ;SHAKE ME BABY
    3325 0000f350     4d60          MOVE    A11,A0
    3326 0000f360     09e1          MOVI    PLAYERS,A1
         0000f370 00000000! 
    3327 0000f390     0d5f          CALLA   ADDSUPP
         0000f3a0 00000000! 
    3328 0000f3c0     8782          MOVE    *A12,A2,L
    3329 0000f3d0     0d3f          CALLR   PLAYERON
         0000f3e0     faca  
    3330 0000f3f0     b5a0          MOVE    *A13(PDATA+20H),A0,W
         0000f400     0080  
    3331 0000f410     0d5f          CALLA   SUBNNRGY                ;SUBTRACT SOME LIFE
         0000f420 00000000! 
    3332 0000f440     c800          JRC     PBUYINT                 ;BR = PLAYER'S ENERGY IS DEPLETED 
         0000f450     0222  
    3333                    
    3334                    *
    3335                    *ENTRYPOINT FOR DEATH ENDER, PxDATA MUST BE FIRST OFF PROCESS STACK
    3336 0000f460           PDEATHOV
    3337 0000f460     8782          MOVE    *A12,A2,L
    3338 0000f470     b648          MOVE    *A2(POBJ),A8,L
         0000f480     00a0  
    3339 0000f490     b64b          MOVE    *A2(PLOBJ),A11,L        ;MAKE SURE THESE ARE HERE
         0000f4a0     0120  
    3340 0000f4b0     b440          MOVE    *A2(PEXEFLAG),A0,W
         0000f4c0     0090  
    3341 0000f4d0     0b80          ANDNI   MDHOLD|MDYING|MDEAD,A0  ;GET RID O' THE HOLDUPS
         0000f4e0 00000046  
    3342 0000f500     b002          MOVE    A0,*A2(PEXEFLAG),W
         0000f510     0090  
    3343 0000f520     182a          MOVK    1,A10                   ;INVINCIBLE FOR 4 TICKS
    3344 0000f530     4c49          MOVE    A2,A9
    3345 0000f540     b441          MOVE    *A2(PPID),A1,W
         0000f550     0240  
    3346 0000f560     0b01          ADDI    PIPID,A1
         0000f570     0030  
    3347 0000f580     09e7          MOVI    INVINCNF,A7
         0000f590 00000000! 
    3348 0000f5b0     0d5f          CALLA   GETPRC                  ;START THE INVINCIBLE PROCESS
         0000f5c0 00000000! 
    3349 0000f5e0     4d64          MOVE    A11,A4
    3350 0000f5f0     0d3f          CALLR   PLALIGN                 ;RE-ALIGN THE BODY PARTS
         0000f600     f98b  
    3351 0000f610     0d3f          CALLR   CKLBADJ                 ;AND MAKE SURE HE'S IN BOUNDS
         0000f620     fbd6  
    3352 0000f630                   DIE
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   83

    3353                    *
    3354                    *SOMEKIND OF QUICK DEATH EXIT ON FAILURES
    3355 0000f660           PDEATHX
    3356 0000f660     b440          MOVE    *A2(PEXEFLAG),A0,W
         0000f670     0090  
    3357 0000f680     0b80          ANDNI   MDHOLD|MDYING|MDEAD,A0   ;TURN OFF THE HOLD
         0000f690 00000046  
    3358 0000f6b0     b002          MOVE    A0,*A2(PEXEFLAG),W
         0000f6c0     0090  
    3359 0000f6d0                   DIE
    3360                            
    3361                    **************************************************************************
    3362                    *                                                                        *
    3363                    * PHYPOHIT - PLAYER HIT BY HYPODERMIC PROCESS                            *
    3364                    * A2=PLINDX=PLAYER DATA STRUCTURE                                        *
    3365                    * A10 = PTR TO FINAL DEATH FRAMES                                        *
    3366                    *                                                                        *
    3367                    **************************************************************************
    3368 0000f700           PHYPOHIT
    3369 0000f700     b34d          MOVE    A10,*A13(PDATA+40H),L
         0000f710     00a0  
    3370 0000f720     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         0000f730     00a0  
    3371 0000f740     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS HERE FOR PLSTOP
         0000f750     0120  
    3372 0000f760     4c8b          MOVE    A4,A11                  ;KEEP HERE FOR SLEEPS
    3373 0000f770                   PUSHP   A2                      ;STACK THE BLOCK POINTER
    3374 0000f780     b20d          MOVE    A0,*A13(PDATA+60H),L    ;SAVE SOUND CALL
         0000f790     00c0  
    3375 0000f7a0     1a00          MOVK    16,A0
    3376 0000f7b0     b00d          MOVE    A0,*A13(PDATA+32),W
         0000f7c0     0080  
    3377                    
    3378 0000f7d0     b645          MOVE    *A2(PFLAGS),A5,L
         0000f7e0     0080  
    3379 0000f7f0     1d85          BTST    BBUYIN,A5
    3380 0000f800     cbe5          JRNE    PDEATHX                 ;BR = SOMETHINGS FUNKY
    3381 0000f810     1dc5          BTST    BDYING,A5
    3382 0000f820     cb00          JRNE    PFLASHD                 ;BR = JUST FLASH AND MAKE WHOOPY
         0000f830     043b  
    3383 0000f840     4ca0          MOVE    A5,A0
    3384 0000f850     0b80          ANDI    MDRIVER|MPASSEN,A0
         0000f860 ffffe7ff  
    3385 0000f880     cb00          JRNE    PFLASHD
         0000f890     0435  
    3386                    
    3387 0000f8a0     2e05          SRL     16,A5
    3388 0000f8b0     0ba5          ORI     MDYING,A5               ;TURN ON THE SAFETY
         0000f8c0 00000002  
    3389 0000f8e0     b0a2          MOVE    A5,*A2(PEXEFLAG),W
         0000f8f0     0090  
    3390                    
    3391 0000f900     0d3f          CALLR   PLAYERON
         0000f910     fa77  
    3392                    
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   84

    3393 0000f920     b7a0          MOVE    *A13(PDATA+60H),A0,L
         0000f930     00c0  
    3394 0000f940                   SOUND1  HHITSND                 ;MAKE THE WEIRDO HYPO SOUND
    3395                    
    3396 0000f9a0     b504          MOVE    *A8(OPAL),A4,W
         0000f9b0     0160  
    3397 0000f9c0     b08d          MOVE    A4,*A13(PDATA),W
         0000f9d0     0060  
    3398 0000f9e0     09e6          MOVI    0EFEFH,A6
         0000f9f0 0000efef  
    3399 0000fa10     b0c8          MOVE    A6,*A8(OCONST),W
         0000fa20     0170  
    3400 0000fa30     b0cb          MOVE    A6,*A11(OCONST),W
         0000fa40     0170  
    3401 0000fa50     1a06          MOVK    16,A6                   ;TAKE AWAY THIS MANY UNITS
    3402 0000fa60           PRELOAD
    3403 0000fa60     5729          CLR     A9
    3404 0000fa70     09ea          MOVI    PALRAM,A10
         0000fa80 00000000! 
    3405 0000faa0           PHPALLUP
    3406 0000faa0     0b6a          CMPI    (NUMPAL*PALRSIZ)+PALRAM,A10
         0000fab0 fffff9ff! 
    3407 0000fad0     c9f8          JRHS    PRELOAD
    3408 0000fae0                   PUSHP   A6
    3409 0000faf0     8740          MOVE    *A10,A0,L
    3410 0000fb00     cb07          JRNZ    PNEXTPAL                ;BR = NEW PALETTE PLEASE
    3411 0000fb10                   PULLP   A6
    3412 0000fb30     0b09          ADDI    0101H,A9
         0000fb40     0101  
    3413 0000fb50     0b0a          ADDI    PALRSIZ,A10
         0000fb60     0030  
    3414 0000fb70     c0f2          JRUC    PHPALLUP        
    3415 0000fb80           PNEXTPAL
    3416 0000fb80     b128          MOVE    A9,*A8(OPAL),W
         0000fb90     0160  
    3417 0000fba0     b12b          MOVE    A9,*A11(OPAL),W
         0000fbb0     0160  
    3418 0000fbc0     b441          MOVE    *A2(PIRQFLAG),A1,W
         0000fbd0     0080  
    3419 0000fbe0     0b81          ANDI    MJUMP1|MJUMP2|MDRIVER|MPASSEN,A1
         0000fbf0 ffffe7f9  
    3420 0000fc10     cb0a          JRNE    PHYPOD1                 ;BR = JUMPING, DO NOT STOP
    3421 0000fc20     4d64          MOVE    A11,A4
    3422 0000fc30     0d3f          CALLR   PLSTOP
         0000fc40     f9b9  
    3423                    
    3424 0000fc50     b441          MOVE    *A2(PEXEFLAG),A1,W
         0000fc60     0090  
    3425 0000fc70     0ba1          ORI     MDHOLD,A1
         0000fc80 00000040  
    3426 0000fca0     b022          MOVE    A1,*A2(PEXEFLAG),W      ;TURN OFF THE HOLDING FLAG
         0000fcb0     0090  
    3427 0000fcc0           PHYPOD1
    3428 0000fcc0     0b0a          ADDI    PALRSIZ,A10             ;NEXT PALETTE
         0000fcd0     0030  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   85

    3429 0000fce0     0b09          ADDI    0101H,A9
         0000fcf0     0101  
    3430 0000fd00                   SLEEP   4
    3431 0000fd40     5600          CLR     A0
    3432 0000fd50     b008          MOVE    A0,*A8(OPAL),W
         0000fd60     0160  
    3433 0000fd70     b00b          MOVE    A0,*A11(OPAL),W
         0000fd80     0160  
    3434 0000fd90     b500          MOVE    *A8(OFLAGS),A0,W
         0000fda0     0100  
    3435 0000fdb0     2f80          SRL     4,A0
    3436 0000fdc0     2480          SLL     4,A0
    3437 0000fdd0     1100          ADDK    8,A0                    ;DO A CONSTANT COLOR
    3438 0000fde0     b008          MOVE    A0,*A8(OFLAGS),W
         0000fdf0     0100  
    3439 0000fe00     b00b          MOVE    A0,*A11(OFLAGS),W
         0000fe10     0100  
    3440 0000fe20                   SLEEP   2
    3441 0000fe60     b500          MOVE    *A8(OFLAGS),A0,W
         0000fe70     0100  
    3442 0000fe80     2f80          SRL     4,A0
    3443 0000fe90     2480          SLL     4,A0
    3444 0000fea0     1040          ADDK    2,A0                    ;NORMAL CURRENT PALETTE
    3445 0000feb0     b008          MOVE    A0,*A8(OFLAGS),W
         0000fec0     0100  
    3446 0000fed0     b00b          MOVE    A0,*A11(OFLAGS),W
         0000fee0     0100  
    3447 0000fef0                   PULLP   A6
    3448 0000ff10     8782          MOVE    *A12,A2,L
    3449 0000ff20     b441          MOVE    *A2(PEXEFLAG),A1,W
         0000ff30     0090  
    3450 0000ff40     0b81          ANDNI   MDHOLD,A1
         0000ff50 00000040  
    3451 0000ff70     b022          MOVE    A1,*A2(PEXEFLAG),W      ;TURN OFF THE HOLDING FLAG
         0000ff80     0090  
    3452 0000ff90     1820          MOVK    1,A0
    3453 0000ffa0     0d5f          CALLA   SUBNNRGY                ;SUBTRACT A LIFE
         0000ffb0 00000000! 
    3454 0000ffd0     c810          JRC     PHDIED                  ;BR = PLAYER'S LAST LIFE, BUY IN
    3455 0000ffe0     0d86          DSJ     A6,PHPALLUP
         0000fff0     ffaa  
    3456 00010000                   SOUND1  HHITEND
    3457 00010060     b5a4          MOVE    *A13(PDATA),A4,W
         00010070     0060  
    3458 00010080     b088          MOVE    A4,*A8(OPAL),W
         00010090     0160  
    3459 000100a0     b08b          MOVE    A4,*A11(OPAL),W         ;RESTORE PROPER PALETTE
         000100b0     0160  
    3460 000100c0     c000          JRUC    PDEATHOV                ;THIS DEATH IS DONE
         000100d0     ff38  
    3461 000100e0           PHDIED
    3462 000100e0                   SOUND1  HHITEND
    3463 00010140     b5a4          MOVE    *A13(PDATA),A4,W
         00010150     0060  
    3464 00010160     b088          MOVE    A4,*A8(OPAL),W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   86

         00010170     0160  
    3465 00010180     b08b          MOVE    A4,*A11(OPAL),W         ;RESTORE PROPER PALETTE
         00010190     0160  
    3466 000101a0     b7aa          MOVE    *A13(PDATA+40H),A10,L
         000101b0     00a0  
    3467 000101c0     c000          JRUC    PBUYINT
         000101d0     014a  
    3468                    
    3469                    **************************************************************************
    3470                    *                                                                        *
    3471                    * PLAYER BUG BITE PROCESS                                                *
    3472                    * A0 = SOUND TO MAKE                                                     *
    3473                    * A1 = # OF HIT POINTS TO TAKE AWAY (32 BITS)                            *
    3474                    * A2 = PLINDX=PLAYER DATA STRUCTURE                                      *
    3475                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
    3476                    * A10= DEATH FRAME TABLE PTR                                             *
    3477                    *                                                                        *
    3478                    **************************************************************************
    3479 000101e0           PBUGGER
    3480 000101e0     4f01          MOVE    A8,B1                   ;KEEP COLLIDING OBJECT PTR HERE                 
    3481 000101f0     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         00010200     00a0  
    3482 00010210     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS
         00010220     0120  
    3483 00010230     4c8b          MOVE    A4,A11                  ;STORE HERE FOR FUN
    3484                            
    3485 00010240     b20d          MOVE    A0,*A13(PDATA),L        ;STORE THE SOUND HERE
         00010250     0060  
    3486 00010260     b22d          MOVE    A1,*A13(PDATA+20H),L    ;STORE HIT POINTS
         00010270     0080  
    3487                    
    3488 00010280                   PUSHP   A2                      ;STACK THE BLOCK POINTER
    3489                    
    3490 00010290     b645          MOVE    *A2(PFLAGS),A5,L
         000102a0     0080  
    3491 000102b0     1d85          BTST    BBUYIN,A5
    3492 000102c0     cb00          JRNE    PDEATHX                 ;BR = SOMETHINGS FUNKY
         000102d0     ff38  
    3493 000102e0     1dc5          BTST    BDYING,A5
    3494 000102f0     cb00          JRNE    PFLASHFD                ;BR = JUST FLASH AND MAKE WHOOPY
         00010300     039a  
    3495 00010310     4ca0          MOVE    A5,A0
    3496 00010320     2e05          SRL     16,A5
    3497 00010330     0ba5          ORI     MDYING,A5               ;TURN ON THE SAFETY
         00010340 00000002  
    3498 00010360     b0a2          MOVE    A5,*A2(PEXEFLAG),W
         00010370     0090  
    3499 00010380     0b80          ANDI    MDRIVER|MPASSEN,A0
         00010390 ffffe7ff  
    3500 000103b0     ca11          JREQ    PBUGG0                  ;FLASH'EM
    3501                    
    3502 000103c0     b7a0          MOVE    *A13(PDATA+20H),A0,L
         000103d0     0080  
    3503 000103e0     0d5f          CALLA   SUBFNRGY                ;SUBTRACT SOME LIFE
         000103f0 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   87

    3504 00010410     c800          JRC     PBUYINT                 ;BR = PLAYER'S ENERGY IS DEPLETED 
         00010420     0125  
    3505 00010430     b440          MOVE    *A2(PEXEFLAG),A0,W
         00010440     0090  
    3506 00010450     0b80          ANDNI   MDHOLD|MDYING|MDEAD,A0  ;GET RID O' THE HOLDUPS
         00010460 00000046  
    3507 00010480     b002          MOVE    A0,*A2(PEXEFLAG),W
         00010490     0090  
    3508 000104a0                   DIE
    3509 000104d0           PBUGG0
    3510 000104d0     b7a0          MOVE    *A13(PDATA+20H),A0,L
         000104e0     0080  
    3511 000104f0     0d5f          CALLA   SUBFNRGY                ;SUBTRACT SOME LIFE
         00010500 00000000! 
    3512 00010520     c800          JRC     PBUYINT                 ;BR = PLAYER'S ENERGY IS DEPLETED 
         00010530     0114  
    3513 00010540     b440          MOVE    *A2(PEXEFLAG),A0,W
         00010550     0090  
    3514 00010560     0b80          ANDNI   MDHOLD|MDYING|MDEAD,A0  ;GET RID O' THE HOLDUPS
         00010570 00000046  
    3515 00010590     b002          MOVE    A0,*A2(PEXEFLAG),W
         000105a0     0090  
    3516 000105b0     4d64          MOVE    A11,A4
    3517 000105c0     0d3f          CALLR   PLALIGN                 ;RE-ALIGN THE BODY PARTS
         000105d0     f88e  
    3518 000105e0                   DIE
    3519                    
    3520                    **************************************************************************
    3521                    *                                                                        *
    3522                    * PLAYER WACKED BY AN EXPLOSION                                          *
    3523                    * A0 = SOUND TO MAKE                                                     *
    3524                    * A1 = # OF HIT POINTS TO TAKE AWAY                                      *
    3525                    * A2 = PLINDX=PLAYER DATA STRUCTURE                                      *
    3526                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
    3527                    * A10 = PTR TO FINAL DEATH ANIMATION                                     *
    3528                    *                                                                        *
    3529                    **************************************************************************
    3530 00010610           PEXPLODE
    3531 00010610     b20d          MOVE    A0,*A13(PDATA),L        ;STORE THE SOUND HERE
         00010620     0060  
    3532 00010630     b440          MOVE    *A2(PIRQFLAG),A0,W
         00010640     0080  
    3533 00010650     1f20          BTST    BSWALK,A0
    3534 00010660     ca01          JREQ    PEXPLOD0
    3535 00010670     2be1          SRA     1,A1                    ;HIT/2 FOR SQUAT DUDE
    3536 00010680           PEXPLOD0
    3537 00010680     b02d          MOVE    A1,*A13(PDATA+20H),W    ;STORE HIT POINTS
         00010690     0080  
    3538                    
    3539 000106a0     4f01          MOVE    A8,B1                   ;KEEP COLLIDING OBJECT PTR HERE                 
    3540 000106b0     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         000106c0     00a0  
    3541 000106d0     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS
         000106e0     0120  
    3542 000106f0     4c8b          MOVE    A4,A11                  ;STORE HERE FOR FUN
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   88

    3543                            
    3544 00010700                   PUSHP   A2                      ;STACK THE BLOCK POINTER
    3545 00010710     b645          MOVE    *A2(PFLAGS),A5,L
         00010720     0080  
    3546 00010730     1d85          BTST    BBUYIN,A5
    3547 00010740     cb00          JRNE    PDEATHX                 ;BR = SOMETHINGS FUNKY
         00010750     fef0  
    3548                    *FIGURE IN SOME X VELOCITY
    3549 00010760     09e0          MOVI    18000H,A0
         00010770 00018000  
    3550 00010790     0d5f          CALLA   SRAND
         000107a0 00000000! 
    3551 000107c0     09e1          MOVI    28000H,A1
         000107d0 00028000  
    3552 000107f0     4001          ADD     A0,A1
    3553 00010800     4e30          MOVE    B1,A0
    3554 00010810     0d5f          CALLA   WHICHSID
         00010820 00000000! 
    3555 00010840     c901          JRNC    PEXPLOD1
    3556 00010850     03a1          NEG     A1
    3557 00010860           PEXPLOD1
    3558 00010860     b703          MOVE    *A8(OXVEL),A3,L
         00010870     0040  
    3559 00010880     4c60          MOVE    A3,A0
    3560 00010890     4023          ADD     A1,A3                   ;TACK IT ON TO WHAT WE'VE GOT
    3561 000108a0     4c61          MOVE    A3,A1
    3562 000108b0     0381          ABS     A1
    3563 000108c0     0b61          CMPI    [4,0],A1
         000108d0 fffbffff  
    3564 000108f0     c201          JRLS    PEXPLOD2                ;BR = LOWER THAN MAX VEL
    3565 00010900     4c03          MOVE    A0,A3                   ;RESTORE PREVIOUS VELOCITY
    3566 00010910           PEXPLOD2
    3567                    *CHECK IF PLAYER IS TOO CLOSE TO A SCREEN EDGE, ALWAYS BLOW IN OTHER DIREC.
    3568 00010910     05a0          MOVE    @NPLYRS,A0,W
         00010920 00000000! 
    3569 00010940     1420          DEC     A0
    3570 00010950     ca13          JRZ     PEXPLOD4                ;ONLY ONE PLAYER, DON'T WORRY
    3571 00010960     0d5f          CALLA   GETANIX                 ;GET PLAYERS X ANIMATION PNT
         00010970 00000000! 
    3572 00010990     05a1          MOVE    @WORLDTLX+16,A1,W
         000109a0 00000010! 
    3573 000109c0     4c63          MOVE    A3,A3
    3574 000109d0     ce06          JRN     PEXPLOD3
    3575 000109e0     0b01          ADDI    512-75,A1
         000109f0     01b5  
    3576 00010a00     4820          CMP     A1,A0   
    3577 00010a10     c607          JRLE    PEXPLOD4
    3578 00010a20     03a3          NEG     A3
    3579 00010a30     c005          JRUC    PEXPLOD4
    3580 00010a40           PEXPLOD3
    3581 00010a40     0b01          ADDI    50,A1
         00010a50     0032  
    3582 00010a60     4820          CMP     A1,A0
    3583 00010a70     c501          JRGE    PEXPLOD4
    3584 00010a80     03a3          NEG     A3
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   89

    3585 00010a90           PEXPLOD4
    3586 00010a90     b268          MOVE    A3,*A8(OXVEL),L
         00010aa0     0040  
    3587 00010ab0     b264          MOVE    A3,*A4(OXVEL),L
         00010ac0     0040  
    3588                    *IF YOU ENTER HERE, MAKE SURE PEXEFLAG IS IN A5
    3589                    *PDATA = SOUND CALL
    3590 00010ad0           PEXPLOD5        
    3591 00010ad0     1dc5          BTST    BDYING,A5
    3592 00010ae0     cb00          JRNE    PFLASHD                 ;BR = JUST SUBTRACT SOME DEATH
         00010af0     030f  
    3593 00010b00     2e05          SRL     16,A5
    3594 00010b10     0ba5          ORI     MDYING,A5               ;TURN OFF THE SAFETY
         00010b20 00000002  
    3595 00010b40     b0a2          MOVE    A5,*A2(PEXEFLAG),W
         00010b50     0090  
    3596 00010b60     0d3f          CALLR   PLAYERON                ;MAKE SURE THE PLAYER IS ON
         00010b70     f951  
    3597                    
    3598 00010b80     b7a0          MOVE    *A13(PDATA),A0,L
         00010b90     0060  
    3599 00010ba0     0d5f          CALLA   ONESND                  ;LET'S MAKE SOME NOISE
         00010bb0 00000000! 
    3600                    
    3601 00010bd0     05a1          MOVE    @PUPDATE,A1,W
         00010be0 00000000! 
    3602 00010c00     1820          MOVK    1,A0
    3603 00010c10     0580          MOVE    A0,@PUPDATE,W
         00010c20 00000000! 
    3604 00010c40     b446          MOVE    *A2(PIRQFLAG),A6,W
         00010c50     0080  
    3605 00010c60     0b86          ANDNI   MJUMP1|MJUMP2,A6        ;OUT OF JUMP MODE BUDDY
         00010c70 00000006  
    3606 00010c90     b0c2          MOVE    A6,*A2(PIRQFLAG),W
         00010ca0     0080  
    3607 00010cb0     0581          MOVE    A1,@PUPDATE,W
         00010cc0 00000000! 
    3608                    
    3609 00010ce0                   JSRP    PFLYNDIE
    3610                    
    3611 00010d50     4d60          MOVE    A11,A0
    3612 00010d60     09e1          MOVI    PLAYERS,A1
         00010d70 00000000! 
    3613 00010d90     0d5f          CALLA   ADDSUPP
         00010da0 00000000! 
    3614 00010dc0     8782          MOVE    *A12,A2,L
    3615 00010dd0     0d3f          CALLR   PLAYERON
         00010de0     f92a  
    3616 00010df0     b5a0          MOVE    *A13(PDATA+20H),A0,W
         00010e00     0080  
    3617 00010e10     0d5f          CALLA   SUBNNRGY                ;SUBTRACT SOME LIFE
         00010e20 00000000! 
    3618 00010e40     c800          JRC     PBUYINT                 ;BR = PLAYER'S ENERGY IS DEPLETED 
         00010e50     0082  
    3619 00010e60     c000          JRUC    PDEATHOV
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   90

         00010e70     fe5e  
    3620                    
    3621                    **************************************************************************
    3622                    *                                                                        *
    3623                    * PLAYER SUCKED A ROCKET                                                 *
    3624                    * A0 = SOUND TO MAKE                                                     *
    3625                    * A1 = # OF HIT POINTS TO TAKE AWAY                                      *
    3626                    * A2 = PLINDX=PLAYER DATA STRUCTURE                                      *
    3627                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
    3628                    * A10 = PTR TO FINAL DEATH ANIMATION                                     *
    3629                    *                                                                        *
    3630                    **************************************************************************
    3631 00010e80           PROCKHIT
    3632 00010e80     b20d          MOVE    A0,*A13(PDATA),L        ;STORE THE SOUND HERE
         00010e90     0060  
    3633 00010ea0     b02d          MOVE    A1,*A13(PDATA+20H),W    ;STORE HIT POINTS
         00010eb0     0080  
    3634                    
    3635 00010ec0     4d00          MOVE    A8,A0                   ;KEEP COLLIDING OBJECT PTR HERE                 
    3636 00010ed0     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         00010ee0     00a0  
    3637 00010ef0     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS
         00010f00     0120  
    3638 00010f10     4c8b          MOVE    A4,A11                  ;STORE HERE FOR FUN
    3639                            
    3640 00010f20                   PUSHP   A2                      ;STACK THE BLOCK POINTER
    3641 00010f30     b645          MOVE    *A2(PFLAGS),A5,L
         00010f40     0080  
    3642 00010f50     1d85          BTST    BBUYIN,A5
    3643 00010f60     cb00          JRNE    PDEATHX                 ;BR = SOMETHINGS FUNKY
         00010f70     fe6e  
    3644                    
    3645 00010f80     b601          MOVE    *A0(OXVEL),A1,L
         00010f90     0040  
    3646 00010fa0     2be1          SRA     1,A1                    ;DIVIDE DOWN, JUST FOR KICKS
    3647 00010fb0     b228          MOVE    A1,*A8(OXVEL),L
         00010fc0     0040  
    3648 00010fd0     b22b          MOVE    A1,*A11(OXVEL),L
         00010fe0     0040  
    3649 00010ff0     c0ad          JRUC    PEXPLOD5                ;FINISH UP LIKE A NORMAL EXPLOSION
    3650                    
    3651                    **************************************************************************
    3652                    *                                                                        *
    3653                    * PLAYER HIT BY A GARBAGE CAN                                            *
    3654                    * A0 = SOUND TO MAKE                                                     *
    3655                    * A1 = # OF HIT POINTS TO TAKE AWAY                                      *
    3656                    * A2 = PLINDX=PLAYER DATA STRUCTURE                                      *
    3657                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
    3658                    * A9 = SHAKE FRAME TABLE PTR                                             *
    3659                    * A10 = PTR TO FINAL DEATH ANIMATION                                     *
    3660                    *                                                                        *
    3661                    **************************************************************************
    3662 00011000           PGARBHIT
    3663 00011000     b20d          MOVE    A0,*A13(PDATA),L        ;STORE THE SOUND HERE
         00011010     0060  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   91

    3664                    
    3665 00011020     b700          MOVE    *A8(OYVEL),A0,L
         00011030     0060  
    3666 00011040     ce16          JRN     PGARBXX                 ;CRUISE AGAIN, THIS IS NOT COMING DOWN
    3667 00011050     ca15          JRZ     PGARBXX                 ;DEFINITELY NOT COMING DOWN ON US
    3668                    
    3669 00011060     29e0          SRA     17,A0
    3670 00011070     0380          ABS     A0
    3671 00011080     4001          ADD     A0,A1                   ;EXCACERBATE VIA VELOCITY
    3672                    
    3673 00011090     b02d          MOVE    A1,*A13(PDATA+20H),W    ;STORE HIT POINTS
         000110a0     0080  
    3674 000110b0     0d5f          CALLA   GETBOTY                 ;GET THE CANS BOTTOM Y POSITION
         000110c0 00000000! 
    3675                    
    3676 000110e0     4d00          MOVE    A8,A0                   ;KEEP COLLIDING OBJECT PTR HERE                 
    3677 000110f0     4f01          MOVE    A8,B1                   ;KEEP HERE FOR PDEATH
    3678                    
    3679 00011100     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         00011110     00a0  
    3680 00011120     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS
         00011130     0120  
    3681 00011140     4c8b          MOVE    A4,A11                  ;STORE HERE FOR FUN
    3682                            
    3683 00011150     b565          MOVE    *A11(OYPOS),A5,W
         00011160     00b0  
    3684 00011170     48a1          CMP     A5,A1
    3685 00011180     c702          JRGT    PGARBXX                 ;BR = CAN IS NOT ABOVE THE BELT
    3686 00011190     c000          JRUC    PDEATHMV                ;FINISH LIKE A BULLET
         000111a0     fdcd  
    3687                    *
    3688                    *ENTER HERE TO EXIT THE DEATH ROUTINES WITH NO EFFECT UNDER NORMAL
    3689                    *CIRCUMSTANCES
    3690 000111b0           PGARBXX
    3691 000111b0     b645          MOVE    *A2(PFLAGS),A5,L
         000111c0     0080  
    3692 000111d0     1dc5          BTST    BDYING,A5
    3693 000111e0     ca03          JREQ    PGARBDOFF
    3694 000111f0                   DIE
    3695 00011220           PGARBDOFF
    3696 00011220     b440          MOVE    *A2(PEXEFLAG),A0,W
         00011230     0090  
    3697 00011240     0b80          ANDNI   MDHOLD,A0        ;TURN OFF THE HOLD
         00011250 00000040  
    3698 00011270     b002          MOVE    A0,*A2(PEXEFLAG),W
         00011280     0090  
    3699 00011290                   DIE
    3700                    
    3701                    **************************************************************************
    3702                    *                                                                        *
    3703                    * PLAYER TANKED THE CAR                                                  *
    3704                    * A0 = SOUND TO MAKE                                                     *
    3705                    * A1 = # OF HIT POINTS TO TAKE AWAY                                      *
    3706                    * A2 = PLINDX=PLAYER DATA STRUCTURE                                      *
    3707                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   92

    3708                    * A10 = PTR TO FINAL DEATH ANIMATION                                     *
    3709                    *                                                                        *
    3710                    **************************************************************************
    3711 000112c0           PCARHIT
    3712 000112c0     b20d          MOVE    A0,*A13(PDATA),L        ;STORE THE SOUND HERE
         000112d0     0060  
    3713 000112e0     b02d          MOVE    A1,*A13(PDATA+20H),W    ;STORE HIT POINTS
         000112f0     0080  
    3714 00011300     4f41          MOVE    A10,B1
    3715 00011310     4e40          MOVE    A2,B0
    3716 00011320     4d0a          MOVE    A8,A10                  ;KEEP COLLIDING OBJECT PTR HERE                 
    3717 00011330     4d00          MOVE    A8,A0
    3718 00011340     b648          MOVE    *A2(POBJ),A8,L          ;NEED OBJECT BLOCK PTR
         00011350     00a0  
    3719 00011360     b644          MOVE    *A2(PLOBJ),A4,L         ;GET THE LEGS
         00011370     0120  
    3720 00011380     4c8b          MOVE    A4,A11                  ;STORE HERE FOR FUN
    3721 00011390     0d5f          CALLA   GCUBEVEL
         000113a0 00000000! 
    3722 000113c0     4c45          MOVE    A2,A5
    3723 000113d0     4e12          MOVE    B0,A2
    3724 000113e0     4e3a          MOVE    B1,A10
    3725 000113f0     5425          OR      A1,A5
    3726 00011400     cada          JRZ     PGARBXX                 ;NOT A VALID SLAM
    3727                    
    3728 00011410                   PUSHP   A2                      ;STACK THE BLOCK POINTER
    3729 00011420     b645          MOVE    *A2(PFLAGS),A5,L
         00011430     0080  
    3730 00011440     1d85          BTST    BBUYIN,A5
    3731 00011450     cb00          JRNE    PDEATHX                 ;BR = SOMETHINGS FUNKY
         00011460     fe1f  
    3732                    
    3733 00011470     b601          MOVE    *A0(OXVEL),A1,L
         00011480     0040  
    3734 00011490     2be1          SRA     1,A1                    ;DIVIDE DOWN, JUST FOR KICKS
    3735 000114a0     b228          MOVE    A1,*A8(OXVEL),L
         000114b0     0040  
    3736 000114c0     b22b          MOVE    A1,*A11(OXVEL),L
         000114d0     0040  
    3737 000114e0     c000          JRUC    PEXPLOD5                ;FINISH UP LIKE A NORMAL EXPLOSION
         000114f0     ff5d  
    3738                    
    3739                    *
    3740                    *PLAYER 1 BUY IN START
    3741 00011500           P1BUYINT
    3742 00011500     09e2          MOVI    P1DATA,A2               ;GET THIS GUYS DATA BLOCK
         00011510 00000000! 
    3743 00011530     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         00011540 00000000! 
    3744 00011560                   PUSHP   A2
    3745 00011570     b648          MOVE    *A2(POBJ),A8,L
         00011580     00a0  
    3746 00011590     b64b          MOVE    *A2(PLOBJ),A11,L
         000115a0     0120  
    3747 000115b0     c00c          JRUC    PBUYINT
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   93

    3748                    *
    3749                    *PLAYER 2 BUY IN START
    3750 000115c0           P2BUYINT
    3751 000115c0     09e2          MOVI    P2DATA,A2               ;GET THIS GUYS DATA BLOCK
         000115d0 00000000! 
    3752 000115f0     09ea          MOVI    P1DIE,A10               ;POINTER TO FINAL DEATH FRAMES
         00011600 00000000! 
    3753 00011620                   PUSHP   A2
    3754 00011630     b648          MOVE    *A2(POBJ),A8,L
         00011640     00a0  
    3755 00011650     b64b          MOVE    *A2(PLOBJ),A11,L
         00011660     0120  
    3756 00011670     0300          JRUC    PBUYINT
    3757                    **************************************************************************
    3758                    *                                                                        *
    3759                    * PBUYINT - PROCESS FOR PLAYER BUYIN TIME                                *
    3760                    * A8 = PTR TO PLAYER EL-TORSO OBJECT                                     *
    3761                    * A10 = POINTER TO FINAL DEATH FRAMES                                    *
    3762                    * A11 = POINTER TO PLAYER LEG OBJECT                                     *
    3763                    * A12 = POINTS TO PROCESS STACK POSITION OF CORRECT PDATA POINTER        *
    3764                    *                                                                        *
    3765                    **************************************************************************
    3766 00011680           PBUYINT
    3767 00011680     05a0          MOVE    @GAMSTATE,A0,W
         00011690 00000000! 
    3768 000116b0     0b40          CMPI    INPLAY,A0
         000116c0     ffdf  
    3769 000116d0     ca0a          JREQ    PBUYINT1
    3770 000116e0     0b40          CMPI    INAMODE,A0
         000116f0     ffcf  
    3771 00011700     ca07          JREQ    PBUYINT1
    3772 00011710                   SLOOP   2,PBUYINT
    3773                    *GIVE PLAYER SOME TIME FLASH FOR BUY-IN, THEN KILL HIM
    3774 00011780           PBUYINT1
    3775 00011780     8782          MOVE    *A12,A2,L
    3776 00011790     b44e          MOVE    *A2(PPID),A14
         000117a0     0240  
    3777 000117b0     4dc0          MOVE    A14,A0
    3778 000117c0     09e1          MOVI    0FF00H,A1               ;MASK
         000117d0 0000ff00  
    3779 000117f0     0d5f          CALLA   KILALL                  ;KILL ALL PLAYER PROCESSES      
         00011800 00000000! 
    3780                    
    3781 00011820     05a0          MOVE    @GAMSTATE,A0,W
         00011830 00000000! 
    3782 00011850     0b40          CMPI    INAMODE,A0
         00011860     ffcf  
    3783 00011870     cb10          JRNE    PBUYINT0                ;BR = NOT IN A-MODE, NORMAL DEC
    3784                    
    3785 00011880                   SWAP    A2,A11
    3786 000118b0     4dc1          MOVE    A14,A1                  ;RE-START MESSAGE PROC FOR SURE
    3787 000118c0     0b01          ADDI    PMPID,A1
         000118d0     0020  
    3788 000118e0     09e7          MOVI    PRESCONT,A7     
         000118f0 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   94

    3789 00011910     0d5f          CALLA   GETPRC
         00011920 00000000! 
    3790 00011940                   SWAP    A2,A11
    3791 00011970     c010          JRUC    PBUYAMOD
    3792                    
    3793 00011980           PBUYINT0
    3794 00011980     b440          MOVE    *A2(PEXEFLAG),A0,W
         00011990     0090  
    3795 000119a0     0ba0          ORI     MINVINC,A0              ;MAKE SURE HE IS INVINCIBLE
         000119b0 00000010  
    3796 000119d0     b002          MOVE    A0,*A2(PEXEFLAG),W
         000119e0     0090  
    3797                            
    3798 000119f0     b440          MOVE    *A2(PLIVES),A0,W
         00011a00     02b0  
    3799 00011a10     1420          DEC     A0
    3800 00011a20     c67f          JRLE    POUTO
    3801                    
    3802 00011a30     09c1          MOVI    25H,A1
         00011a40     0025  
    3803 00011a50     0d5f          CALLA   SCORE                   ;25 FOR DYING
         00011a60 00000000! 
    3804                    
    3805 00011a80           PBUYAMOD
    3806 00011a80     b440          MOVE    *A2(PEXEFLAG),A0,W
         00011a90     0090  
    3807 00011aa0     0ba0          ORI     MDHOLD|MDYING|MDEAD,A0  ;HOLD THIS GUY UP MAN
         00011ab0 00000046  
    3808 00011ad0     b002          MOVE    A0,*A2(PEXEFLAG),W
         00011ae0     0090  
    3809                    
    3810 00011af0     5663          CLR     A3
    3811 00011b00     b262          MOVE    A3,*A2(PSWTCH),L        ;CLEAR ANY LATCHED SWITCHES
         00011b10     00c0  
    3812                    
    3813 00011b20     b643          MOVE    *A2(PIRQFLAG),A3,L      
         00011b30     0080  
    3814 00011b40     0b83          ANDI    MDRIVER|MPASSEN,A3
         00011b50 ffffe7ff  
    3815 00011b70     ca07          JREQ    PBUYDOK         ;BR = NOT IN CAR
    3816                    
    3817 00011b80                   JSRP    PFLYNDIE        ;FLAIL HIM OUT OF THE CAR
    3818 00011bf0           PBUYDOK
    3819 00011bf0     4d64          MOVE    A11,A4
    3820                    *MAKE THE PLAYER DIE
    3821 00011c00     0d5f          CALLA   PLEGOFF
         00011c10 00000000! 
    3822 00011c30     4d60          MOVE    A11,A0
    3823 00011c40     09e1          MOVI    PLAYERS,A1
         00011c50 00000000! 
    3824 00011c70     0d5f          CALLA   ISSUPP
         00011c80 00000000! 
    3825 00011ca0     ca03          JRZ     PBUYLNS                 ;THE LEGS ARE ALREADY MISSING
    3826 00011cb0     0d5f          CALLA   DELSUPP
         00011cc0 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   95

    3827 00011ce0           PBUYLNS
    3828 00011ce0     1821          MOVK    1,A1
    3829 00011cf0     4d49          MOVE    A10,A9
    3830 00011d00                   JSRP    FRANIM                  ;MAKE HIM DIE
    3831                    
    3832 00011d70     09c6          MOVI    60/5,A6                 ;WAIT TIME
         00011d80     000c  
    3833 00011d90           PBUYD3
    3834 00011d90     b700          MOVE    *A8(OYVEL),A0,L
         00011da0     0060  
    3835 00011db0     ca0c          JRZ     PBUYD4
    3836 00011dc0     b701          MOVE    *A8(OZVEL),A1,L
         00011dd0     00e0  
    3837 00011de0     4820          CMP     A1,A0
    3838 00011df0     ca08          JREQ    PBUYD4
    3839 00011e00                   PUSHP   A6
    3840 00011e10                   SLEEP   5
    3841 00011e50                   PULLP   A6
    3842 00011e70     3de6          DSJS    A6,PBUYD3
    3843 00011e80           PBUYD4
    3844 00011e80     4d64          MOVE    A11,A4
    3845 00011e90     0d3f          CALLR   PLSTOP
         00011ea0     f793  
    3846                    ****    MOVE    *A8(OSHAD),A0,L
    3847                    ****    JRZ     PBUYD4A
    3848                    ****    MOVE    *A0(OFLAGS),A1,W
    3849                    ****    SRL     4,A1
    3850                    ****    SLL     4,A1
    3851                    ****    MOVE    A1,*A0(OFLAGS),W
    3852                    ****PBUYD4A
    3853                    ****    MOVE    A8,A0
    3854                    ****    CALLA   SETZPOS                 ;RESET ZPOSITION FOR GOOD LOOKS
    3855 00011eb0     4cc6          MOVE    A6,A6
    3856 00011ec0     ca08          JRZ     PBUYD6                  ;BR = NO WAIT TIME LEFT
    3857 00011ed0           PBUYD5
    3858 00011ed0                   PUSHP   A6
    3859 00011ee0                   SLEEP   5
    3860 00011f20                   PULLP   A6
    3861 00011f40     3d06          DSJS    A6,PBUYD5
    3862 00011f50           PBUYD6
    3863 00011f50     4d60          MOVE    A11,A0
    3864 00011f60     09e1          MOVI    PLAYERS,A1
         00011f70 00000000! 
    3865 00011f90     0d5f          CALLA   ADDSUPP
         00011fa0 00000000! 
    3866 00011fc0     8782          MOVE    *A12,A2,L
    3867 00011fd0     0d3f          CALLR   PLAYERON
         00011fe0     f80a  
    3868                    
    3869 00011ff0     0d5f          CALLA   SUBLIFE                 ;TAKE THIS AWAY...
         00012000 00000000! 
    3870 00012020     09c0          MOVI    IENERGY,A0
         00012030     0023  
    3871 00012040     2600          SLL     16,A0
    3872 00012050     b202          MOVE    A0,*A2(PENERGY),L
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   96

         00012060     01c0  
    3873 00012070     0d5f          CALLA   OUTENRGY
         00012080 00000000! 
    3874 000120a0     0d3f          CALLR   STARTINV
         000120b0     f274  
    3875 000120c0     5600          CLR     A0
    3876 000120d0     b002          MOVE    A0,*A2(PSWTCH),W
         000120e0     00c0  
    3877                    
    3878 000120f0     05a1          MOVE    @PUPDATE,A1,W
         00012100 00000000! 
    3879 00012120     1820          MOVK    1,A0
    3880 00012130     0580          MOVE    A0,@PUPDATE,W
         00012140 00000000! 
    3881 00012160     b446          MOVE    *A2(PIRQFLAG),A6,W
         00012170     0080  
    3882 00012180     0b86          ANDNI   MJUMP1|MJUMP2,A6        ;OUT OF JUMP MODE BUDDY
         00012190 00000006  
    3883 000121b0     b0c2          MOVE    A6,*A2(PIRQFLAG),W
         000121c0     0080  
    3884 000121d0     0581          MOVE    A1,@PUPDATE,W
         000121e0 00000000! 
    3885 00012200     c000          JRUC    PDEATHOV
         00012210     fd24  
    3886                    
    3887                    *PLAYER IS OUT OF ALL HIS WARES
    3888 00012220           POUTO
    3889 00012220     0d5f          CALLA   SUBLIFE                 ;FORMALITIES
         00012230 00000000! 
    3890                    
    3891 00012250     b441          MOVE    *A2(PEXEFLAG),A1,W
         00012260     0090  
    3892 00012270     0ba1          ORI     MBUYIN,A1
         00012280 00000008  
    3893 000122a0     b022          MOVE    A1,*A2(PEXEFLAG),W      ;FLAG THAT IT'S BUY IN TIME
         000122b0     0090  
    3894                    
    3895 000122c0     4f62          MOVE    A11,B2
    3896 000122d0     4c4b          MOVE    A2,A11                  ;PASS PLAYER DATA STRUCTURE
    3897 000122e0     4dc1          MOVE    A14,A1
    3898 000122f0     0b01          ADDI    PMPID,A1
         00012300     0020  
    3899 00012310     09e7          MOVI    PRESCONT,A7     
         00012320 00000000! 
    3900 00012340     0d5f          CALLA   GETPRC
         00012350 00000000! 
    3901 00012370     4e5b          MOVE    B2,A11
    3902                    
    3903 00012380     b441          MOVE    *A2(PBUYINS),A1,W       ;BUYIN ALLOWED
         00012390     02c0  
    3904 000123a0     ca43          JRZ     PDEATHCT                ;I SAY WE KILL HIM!
    3905 000123b0     1421          DEC     A1
    3906 000123c0     b022          MOVE    A1,*A2(PBUYINS),W
         000123d0     02c0  
    3907                    
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   97

    3908 000123e0     b441          MOVE    *A2(PEXEFLAG),A1,W
         000123f0     0090  
    3909 00012400     0b81          ANDNI   MDHOLD|MDYING,A1
         00012410 00000042  
    3910 00012430     b022          MOVE    A1,*A2(PEXEFLAG),W      ;FLAG THAT IT'S BUY IN TIME
         00012440     0090  
    3911                    
    3912 00012450     09c0          MOVI    EBAITPID,A0
         00012460     0d39  
    3913 00012470     5621          CLR     A1
    3914 00012480     03e1          NOT     A1
    3915 00012490     0d5f          CALLA   KILALL                  ;KILL THE BAITER PROCESS
         000124a0 00000000! 
    3916 000124c0     09c0          MOVI    PBAITPID,A0
         000124d0     0d38  
    3917 000124e0     0d5f          CALLA   KILALL                  ;AND THE POSITION DUDES
         000124f0 00000000! 
    3918                    
    3919 00012510     b441          MOVE    *A2(PIRQFLAG),A1,W
         00012520     0080  
    3920 00012530     0b81          ANDI    MDRIVER|MPASSEN,A1
         00012540 ffffe7ff  
    3921 00012560     cb03          JRNZ    POUTO1                  ;DON'T ALIGN THE PLAYER IN THE CAR
    3922 00012570     4d64          MOVE    A11,A4
    3923 00012580     0d3f          CALLR   PLALIGN
         00012590     f692  
    3924 000125a0           POUTO1
    3925 000125a0     0d3f          CALLR   PLAYERON                ;MAKE SURE THE PLAYER IS LIT
         000125b0     f7ad  
    3926                    
    3927 000125c0     4dc1          MOVE    A14,A1
    3928 000125d0     0b01          ADDI    PFPID,A1
         000125e0     00f0  
    3929 000125f0                   SWAP    A11,A2
    3930 00012620     09e7          MOVI    PFLASH2,A7,L
         00012630 00000000! 
    3931 00012650     0d5f          CALLA   GETPRC                  ;START THE FLASH PROCESS
         00012660 00000000! 
    3932 00012680                   SWAP    A11,A2
    3933                    
    3934 000126b0                   SLEEP   1
    3935                    *INSERT ADJUSTABLE BUY-IN TIME HERE
    3936 000126f0     09c6          MOVI    210/5,A6                ;WAIT TIME/5(PUT ADJUSTABLE HERE)
         00012700     002a  
    3937 00012710           PBUYIWT1
    3938 00012710                   PUSHP   A6
    3939 00012720                   SLEEP   5
    3940 00012760                   PULLP   A6
    3941 00012780     8782          MOVE    *A12,A2,L
    3942 00012790     b640          MOVE    *A2(PENERGY),A0,L
         000127a0     01c0  
    3943 000127b0     c700          JRGT    PBUYINOV                ;BR = HE GOT SOME MORE LIFE
         000127c0     00c2  
    3944 000127d0     3da6          DSJS    A6,PBUYIWT1
    3945                    *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   98

    3946                    *MAKE PLAYER DIE IN A REALLY BIG WAY
    3947 000127e0           PDEATHCT
    3948 000127e0     09c1          MOVI    25H,A1
         000127f0     0025  
    3949 00012800     0d5f          CALLA   SCORE                   ;25 FOR DYING
         00012810 00000000! 
    3950                    
    3951 00012830     b440          MOVE    *A2(PEXEFLAG),A0,W
         00012840     0090  
    3952 00012850     0ba0          ORI     MDEAD|MDHOLD|MDYING,A0          ;TURN ON THE DEAD FLAG
         00012860 00000046  
    3953 00012880     b002          MOVE    A0,*A2(PEXEFLAG),W
         00012890     0090  
    3954                    
    3955 000128a0     5663          CLR     A3
    3956 000128b0     b262          MOVE    A3,*A2(PSWTCH),L        ;CLEAR ANY LATCHED SWITCHES
         000128c0     00c0  
    3957                    
    3958 000128d0     b643          MOVE    *A2(PFLAGS),A3,L        
         000128e0     0080  
    3959 000128f0     0b83          ANDI    MDRIVER|MPASSEN,A3
         00012900 ffffe7ff  
    3960 00012920     ca07          JREQ    PDEATHOK                ;BR = NOT IN CAR
    3961                            
    3962 00012930                   JSRP    PFLYNDIE
    3963 000129a0           PDEATHOK
    3964 000129a0     4d64          MOVE    A11,A4                  ;GOT TO HAVE THIS MAAHN
    3965 000129b0     0d5f          CALLA   PLEGOFF
         000129c0 00000000! 
    3966 000129e0     4d60          MOVE    A11,A0
    3967 000129f0     09e1          MOVI    PLAYERS,A1
         00012a00 00000000! 
    3968 00012a20     0d5f          CALLA   ISSUPP
         00012a30 00000000! 
    3969 00012a50     ca03          JRZ     PBUYINT2                ;BR = ALREADY OFF YOU NIT WIT
    3970 00012a60     0d5f          CALLA   DELSUPP
         00012a70 00000000! 
    3971 00012a90           PBUYINT2
    3972 00012a90     1821          MOVK    1,A1
    3973 00012aa0     4d49          MOVE    A10,A9
    3974 00012ab0                   JSRP    FRANIM                  ;MAKE HIM DIE
    3975                    
    3976 00012b20     09c6          MOVI    30/5,A6                 ;WAIT TIME
         00012b30     0006  
    3977 00012b40           PBUYINT3
    3978 00012b40     b700          MOVE    *A8(OYVEL),A0,L
         00012b50     0060  
    3979 00012b60     ca0c          JRZ     PBUYINT4
    3980 00012b70     b701          MOVE    *A8(OZVEL),A1,L
         00012b80     00e0  
    3981 00012b90     4820          CMP     A1,A0
    3982 00012ba0     ca08          JREQ    PBUYINT4
    3983 00012bb0                   PUSHP   A6
    3984 00012bc0                   SLEEP   5
    3985 00012c00                   PULLP   A6
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE   99

    3986 00012c20     3de6          DSJS    A6,PBUYINT3
    3987 00012c30           PBUYINT4
    3988 00012c30     4d64          MOVE    A11,A4
    3989 00012c40     0d3f          CALLR   PLSTOP
         00012c50     f6b8  
    3990                    ****    MOVE    *A8(OSHAD),A0,L
    3991                    ****    JRZ     PBUYINT5
    3992                    ****    MOVE    *A0(OFLAGS),A1,W
    3993                    ****    SRL     4,A1
    3994                    ****    SLL     4,A1
    3995                    ****    MOVE    A1,*A0(OFLAGS),W
    3996                    ****PBUYINT5
    3997                    ****    MOVE    A8,A0
    3998                    ****    CALLA   SETZPOS                 ;RESET ZPOSITION FOR GOOD LOOKS
    3999 00012c60     4cc6          MOVE    A6,A6                   ;MAKE SURE COUNTER IS NOT ZERO
    4000 00012c70     c701          JRGT    PBUYIWT2
    4001 00012c80     1826          MOVK    1,A6
    4002 00012c90           PBUYIWT2
    4003 00012c90                   PUSHP   A6
    4004 00012ca0                   SLEEP   5
    4005 00012ce0                   PULLP   A6
    4006 00012d00     8782          MOVE    *A12,A2,L
    4007 00012d10     b640          MOVE    *A2(PENERGY),A0,L
         00012d20     01c0  
    4008 00012d30     c60d          JRLE    PBUYIWT3                ;BR = HE'S STILL OUT OF LIFE
    4009                    
    4010 00012d40     4d60          MOVE    A11,A0
    4011 00012d50     09e1          MOVI    PLAYERS,A1
         00012d60 00000000! 
    4012 00012d80     0d5f          CALLA   ADDSUPP
         00012d90 00000000! 
    4013 00012db0     0d3f          CALLR   PLAYERON
         00012dc0     f72c  
    4014 00012dd0     5600          CLR     A0
    4015 00012de0     b002          MOVE    A0,*A2(PSWTCH),W        ;BLOW OUT THE SWITCHES
         00012df0     00c0  
    4016 00012e00     c05e          JRUC    PBUYINOV
    4017 00012e10           PBUYIWT3
    4018 00012e10     3f26          DSJS    A6,PBUYIWT2
    4019                    
    4020 00012e20     b440          MOVE    *A2(PPID),A0
         00012e30     0240  
    4021 00012e40     0b00          ADDI    PFPID,A0
         00012e50     00f0  
    4022 00012e60     5621          CLR     A1
    4023 00012e70     03e1          NOT     A1
    4024 00012e80     0d5f          CALLA   KILALL                  ;KILL THE PLAYER FLASH
         00012e90 00000000! 
    4025                    
    4026 00012eb0     b500          MOVE    *A8(OFLAGS),A0,W
         00012ec0     0100  
    4027 00012ed0     2f80          SRL     4,A0
    4028 00012ee0     2480          SLL     4,A0
    4029 00012ef0     0ba0          ORI     DMAWNZ,A0               ;NORMAL STUFF MAAHN
         00012f00 00008002  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  100

    4030 00012f20     b008          MOVE    A0,*A8(OFLAGS),W        ;MAKE SURE WE'RE NORMAL
         00012f30     0100  
    4031                    
    4032 00012f40     05a0          MOVE    @NPLYRS,A0,W
         00012f50 00000000! 
    4033 00012f70     1420          DEC     A0
    4034 00012f80     cb24          JRNZ    PBUYIWT4                ;BR = THIS IS NOT THE LAST PLAYER
    4035 00012f90     4c4a          MOVE    A2,A10
    4036 00012fa0     b440          MOVE    *A2(PBUYINS),A0,W
         00012fb0     02c0  
    4037 00012fc0     cb10          JRNZ    PBUYBUY                 ;MORE BUY-IN ALLOWED
    4038                    
    4039 00012fd0           PBUYLPLP
    4040 00012fd0                   CREATE  BUYINPID,BUYINLP        ;CREATE BUYIN LOOP WINDOW       
    4041 00013050     cb17          JRNZ    PBUYIWT4
    4042 00013060                   SLOOP   4,PBUYLPLP
    4043                            
    4044 000130d0           PBUYBUY
    4045 000130d0                   CREATE  BUYINPID,BUYINWIN       ;CREATE BUYIN WINDOW    
    4046 00013150     cb07          JRNZ    PBUYIWT4
    4047 00013160                   SLOOP   4,PBUYBUY
    4048 000131d0           PBUYIWT4
    4049                    *WAIT ON BUYIN MESSAGE TO CRUISE
    4050 000131d0     09c0          MOVI    BUYINPID,A0
         000131e0     0d95  
    4051 000131f0     5621          CLR     A1
    4052 00013200     03e1          NOT     A1
    4053 00013210     0d5f          CALLA   EXISTP
         00013220 00000000! 
    4054 00013240     ca07          JRZ     PBUYIWT5                ;BR = BUY IN IS DONE
    4055 00013250                   SLOOP   1,PBUYIWT4
    4056 000132c0           PBUYIWT5
    4057 000132c0     8782          MOVE    *A12,A2,L               ;GET THAT DOGGONE PLINDX
    4058 000132d0     4d60          MOVE    A11,A0
    4059 000132e0     0d5f          CALLA   DELSOBJ
         000132f0 00000000! 
    4060 00013310     5600          CLR     A0
    4061 00013320     b202          MOVE    A0,*A2(PLOBJ),L         ;FREE UP THE LEGS
         00013330     0120  
    4062 00013340     b00d          MOVE    A0,*A13(PROCID),W       ;CLEAR I.D.
         00013350     0020  
    4063                    
    4064 00013360     0d5f          CALLA   PDELETE                 ;DELETE THIS PLAYER
         00013370 00000000! 
    4065 00013390     ca80          JAEQ    GAMEOVER                ;BR = LAST PLAYER, GET OUTTA TOWN
         000133a0 00000000! 
    4066 000133c0                   DIE                             ;CIAO
    4067                    
    4068                    *BUY-IN GETS TRASHED BY ENERGY EARNING
    4069 000133f0           PBUYINOV
    4070 000133f0     4f60          MOVE    A11,B0
    4071 00013400     b440          MOVE    *A2(PPID),A0,W          ;GET THE BASE I.D.
         00013410     0240  
    4072 00013420     09e1          MOVI    0FF00h,A1
         00013430 0000ff00  
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  101

    4073 00013450     0d5f          CALLA   KILALL                  ;KILL ALL PLAYER SUBORDINATES
         00013460 00000000! 
    4074                    
    4075 00013480     b440          MOVE    *A2(PEXEFLAG),A0,W
         00013490     0090  
    4076 000134a0     0b80          ANDNI   MDHOLD|MDYING|MBUYIN|MDEAD|MINVINC,A0   ;TURN OFF THIS BUY-IN GARBAGE
         000134b0 0000005e  
    4077 000134d0     b002          MOVE    A0,*A2(PEXEFLAG),W      
         000134e0     0090  
    4078                    
    4079 000134f0     4c4b          MOVE    A2,A11
    4080 00013500     2e01          SRL     16,A1
    4081 00013510     2601          SLL     16,A1
    4082 00013520     0b01          ADDI    PMLPID,A1
         00013530     0028  
    4083 00013540     09e7          MOVI    CLOSCALL,A7
         00013550 00000000! 
    4084 00013570     0d5f          CALLA   GETPRC
         00013580 00000000! 
    4085                    
    4086                    *RE-UPDATE STATUS AREA FOR THIS PLAYER TO CAN START MESSAGES
    4087 000135a0     0d5f          CALLA   UPDSL
         000135b0 00000000! 
    4088                    
    4089 000135d0     4e1b          MOVE    B0,A11
    4090 000135e0     b500          MOVE    *A8(OFLAGS),A0,W
         000135f0     0100  
    4091 00013600     2f80          SRL     4,A0
    4092 00013610     2480          SLL     4,A0
    4093 00013620     0ba0          ORI     DMAWNZ,A0               ;NORMAL STUFF MAAHN
         00013630 00008002  
    4094 00013650     b008          MOVE    A0,*A8(OFLAGS),W        ;MAKE SURE WE'RE NORMAL
         00013660     0100  
    4095 00013670     b00b          MOVE    A0,*A11(OFLAGS),W
         00013680     0100  
    4096 00013690     0d3f          CALLR   CKLBADJ
         000136a0     f7ce  
    4097 000136b0                   DIE
    4098                    
    4099                    **************************************************************************
    4100                    *                                                                        *
    4101                    * ISCHOP - IS THIS OBJECT THE CHOPPER?                                   *
    4102                    * A1 = PTR TO THE OBJECT                                                 *
    4103                    * RETURNS:                                                               *
    4104                    *       Z BIT SET(EQ) = YES                                              *
    4105                    *       Z BIT CLR(NE) = NO                                               *
    4106                    *                                                                        *
    4107                    **************************************************************************
    4108 000136e0           ISCHOP
    4109 000136e0     098f          MMTM    SP,A0,A1
         000136f0     c000  
    4110 00013700     07a1          MOVE    @PLAYCAR,A1,L           ;GET THE CAR POINTER
         00013710 00000000! 
    4111 00013730     ca04          JRZ     ISCHOPX
    4112 00013740     b420          MOVE    *A1(OID),A0,W
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  102

         00013750     01a0  
    4113 00013760     0b40          CMPI    TRAN2OID,A0             ;COMPARE TO THE CHOPPER I.D.    
         00013770     f3bf  
    4114 00013780           ISCHOPX
    4115 00013780     09af          MMFM    SP,A0,A1
         00013790     0003  
    4116 000137a0     0960          RETS
    4117                            
    4118                    **************************************************************************
    4119                    *                                                                        *
    4120                    * PHITINC - PLAYER HIT BY SOMETHING WHILE IN CAR.                        *
    4121                    * A2 = PLINDX                                                            *
    4122                    * A8 = POBJ                                                              *
    4123                    * A11= PLOBJ                                                             *
    4124                    * PDATA = PTR TO SOUND                                                   *
    4125                    * PDATA+32 = # OF HITS FOR THIS DUDE                                     *
    4126                    *                                                                        *
    4127                    **************************************************************************
    4128 000137b0           PHITINC
    4129 000137b0     b645          MOVE    *A2(PFLAGS),A5,L
         000137c0     0080  
    4130 000137d0     1dc5          BTST    BDYING,A5
    4131 000137e0     cb40          JRNE    PFLASHD
    4132 000137f0     4ca0          MOVE    A5,A0
    4133 00013800     2e00          SRL     16,A0
    4134 00013810     0ba0          ORI     MDYING,A0
         00013820 00000002  
    4135 00013840     b002          MOVE    A0,*A2(PEXEFLAG),W      ;SET THE DYING FLAG
         00013850     0090  
    4136 00013860                   PUSHP   A2
    4137 00013870     b7a0          MOVE    *A13(PDATA),A0,L
         00013880     0060  
    4138 00013890     0d5f          CALLA   ONESND                  ;SOUND IS OF COURSE SLOWER THAN LIGHT
         000138a0 00000000! 
    4139 000138c0     1e45          BTST    BSITIN,A5
    4140 000138d0     cb1f          JRNE    PHITINA                 ;NO ANIMATIONS FOR THIS, JUST FLASH
    4141 000138e0     1e65          BTST    BPASSEN,A5
    4142 000138f0     ca0b          JREQ    PDHITINC                ;BR = MUST HAVE BEEN THE DRIVER
    4143                    
    4144 00013900     0d3f          CALLR   ISCHOP                  ;RIDING IN THE CHOPPER?
         00013910     ffdc  
    4145 00013920     cb04          JRNE    PHITINPP                ;BR = NO
    4146 00013930     09e9          MOVI    PHELPHIT,A9
         00013940 00014e00' 
    4147 00013960     c00e          JRUC    PHITINCA
    4148 00013970           PHITINPP
    4149 00013970     09e9          MOVI    PPASSHIT,A9
         00013980 00014d80' 
    4150 000139a0     c00a          JRUC    PHITINCA
    4151                    
    4152 000139b0           PDHITINC
    4153 000139b0     0d3f          CALLR   ISCHOP                  ;RIDING IN THE CHOPPER?
         000139c0     ffd1  
    4154 000139d0     cb04          JRNE    PHITINPD                ;BR = NO
    4155 000139e0     09e9          MOVI    PPILOHIT,A9
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  103

         000139f0 00014d00' 
    4156 00013a10     c003          JRUC    PHITINCA
    4157 00013a20           PHITINPD
    4158 00013a20     09e9          MOVI    PDRIVHIT,A9
         00013a30 00014c80' 
    4159                    
    4160 00013a50           PHITINCA
    4161 00013a50     1821          MOVK    1,A1
    4162 00013a60                   JSRP    FRANIM                  ;ANIMATE THIS
    4163 00013ad0           PHITINA
    4164 00013ad0     8782          MOVE    *A12,A2,L
    4165 00013ae0     b5a0          MOVE    *A13(PDATA+32),A0,W
         00013af0     0080  
    4166 00013b00     0d5f          CALLA   SUBNNRGY                ;SUBTRACT SOME SHIT
         00013b10 00000000! 
    4167 00013b30     c800          JRC     PBUYINT
         00013b40     fdb3  
    4168 00013b50     b440          MOVE    *A2(PEXEFLAG),A0,W
         00013b60     0090  
    4169 00013b70     0b80          ANDNI   MDHOLD|MDYING|MDEAD,A0  ;GET RID O' THE HOLDUPS
         00013b80 00000046  
    4170 00013ba0     b002          MOVE    A0,*A2(PEXEFLAG),W
         00013bb0     0090  
    4171 00013bc0                   DIE
    4172                    
    4173                    **************************************************************************
    4174                    *                                                                        *
    4175                    * PFLASHD - PLAYER FLASH AND SUBTRACT FOR MULTI-HITS                     *
    4176                    * A2 = PLINDX                                                            *
    4177                    * A8 = POBJ                                                              *
    4178                    * A11= PLOBJ                                                             *
    4179                    * PDATA = PTR TO SOUND                                                   *
    4180                    * PDATA+32 = # OF HITS FOR THIS DUDE                                     *
    4181                    *                                                                        *
    4182                    **************************************************************************
    4183 00013bf0           PFLASHD
    4184 00013bf0     09c0          MOVI    INDPID,A0
         00013c00     0006  
    4185 00013c10     b00d          MOVE    A0,*A13(PROCID),W       ;NONE SHALL PASS
         00013c20     0020  
    4186 00013c30     b5a0          MOVE    *A13(PDATA+32),A0,W
         00013c40     0080  
    4187 00013c50     0d5f          CALLA   SUBNNRGY                ;SUBTRACT SOME SHIT
         00013c60 00000000! 
    4188                    
    4189                    ***     MOVI    0FFFFH,A3
    4190                    ***     MOVE    A3,*A8(OCONST),W
    4191                    ***     MOVE    A3,*A11(OCONST),W
    4192                    ***     MOVI    2,A9
    4193                    ***     PUSHP   A2
    4194                    ***PFLASHL
    4195                    ***     CALLR   PLAYERCON               ;TURN CONSTANT ON
    4196                    ***     SLEEP   3
    4197                    ***     MOVE    *A12,A2,L
    4198                    ***     CALLR   PLAYERON
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  104

    4199                    ***     SLEEP   2
    4200                    ***     MOVE    *A12,A2,L
    4201                    ***     DSJS    A9,PFLASHL
    4202                    
    4203 00013c80                   DIE
    4204                    
    4205                    **************************************************************************
    4206                    *                                                                        *
    4207                    * PFLASHD - PLAYER MULTIPLE HIT ROUTINE, WITH FRACTIONAL ENERGY          *
    4208                    * A2 = PLINDX                                                            *
    4209                    * A8 = POBJ                                                              *
    4210                    * A11= PLOBJ                                                             *
    4211                    * PDATA = PTR TO SOUND                                                   *
    4212                    * PDATA+32 = # OF HITS FOR THIS DUDE (32 BITS)                           *
    4213                    *                                                                        *
    4214                    **************************************************************************
    4215 00013cb0           PFLASHFD
    4216 00013cb0     09c0          MOVI    INDPID,A0
         00013cc0     0006  
    4217 00013cd0     b00d          MOVE    A0,*A13(PROCID),W       ;NONE SHALL PASS
         00013ce0     0020  
    4218 00013cf0     b7a0          MOVE    *A13(PDATA+32),A0,L
         00013d00     0080  
    4219 00013d10     0d5f          CALLA   SUBFNRGY                ;SUBTRACT SOME SHIT
         00013d20 00000000! 
    4220 00013d40                   DIE
    4221                    
    4222                    **************************************************************************
    4223                    *                                                                        *
    4224                    * PLAYER COLLISION ROUTINES                                              *
    4225                    *                                                                        *
    4226                    **************************************************************************
    4227                    *
    4228                    *PLAYER 1 HIT BY A BULLET
    4229                    *A0 = POINTER TO PLAYER OBJECT
    4230                    *A8 = PTR TO BULLET
    4231 00013d70     09e2  P1COLL0 MOVI    P1DATA,A2
         00013d80 00000000! 
    4232 00013da0     c003          JRUC    BULLHIT
    4233                    *
    4234                    *PLAYER 2 HIT BY A BULLET
    4235                    *A0 = POINTER TO PLAYER OBJECT
    4236                    *A8 = PTR TO BULLET
    4237 00013db0     09e2  P2COLL0 MOVI    P2DATA,A2
         00013dc0 00000000! 
    4238                    **************************************************************************
    4239                    *                                                                        *
    4240                    * BULLHIT - CALL TO MAKE A PLAYER BULLET EFFECT                          *
    4241                    * A2 = PLINDX                                                            *
    4242                    *                                                                        *
    4243                    **************************************************************************
    4244 00013de0           BULLHIT
    4245 00013de0     098f          MMTM    SP,A0,A1,A3,A7,A9
         00013df0     d140  
    4246 00013e00     0b62          CMPI    P1DATA,A2
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  105

         00013e10 ffffffff! 
    4247 00013e30     cb07          JRNE    BULLHIT2
    4248 00013e40     09c1          MOVI    P1PID|PDPID,A1
         00013e50     01d0  
    4249 00013e60     09e7          MOVI    P1DETH,A7
         00013e70 0000db40' 
    4250 00013e90     c000          JRUC    PCOLL0
         00013ea0     00cb  
    4251 00013eb0           BULLHIT2
    4252 00013eb0     09c1          MOVI    P2PID|PDPID,A1
         00013ec0     02d0  
    4253 00013ed0     09e7          MOVI    P2DETH,A7
         00013ee0 0000dc30' 
    4254 00013f00     c000          JRUC    PCOLL0  
         00013f10     00c4  
    4255                    
    4256                    **************************************************************************
    4257                    *                                                                        *
    4258                    * HEADBUTT - CALL TO TAKE A HEAD BUTT FROM DUMPSTER MAHN                 *
    4259                    * A2 = PLINDX                                                            *
    4260                    *                                                                        *
    4261                    **************************************************************************
    4262 00013f20           HEADBUTT
    4263 00013f20     098f          MMTM    SP,A0,A1,A3,A7,A9
         00013f30     d140  
    4264 00013f40     0b62          CMPI    P1DATA,A2
         00013f50 ffffffff! 
    4265 00013f70     cb07          JRNE    HEADBUT2
    4266 00013f80     09c1          MOVI    P1PID|PDPID,A1
         00013f90     01d0  
    4267 00013fa0     09e7          MOVI    P1HEADB,A7
         00013fb0 0000dd20' 
    4268 00013fd0     c000          JRUC    PCOLL0
         00013fe0     00b7  
    4269 00013ff0           HEADBUT2
    4270 00013ff0     09c1          MOVI    P2PID|PDPID,A1
         00014000     02d0  
    4271 00014010     09e7          MOVI    P2HEADB,A7
         00014020 0000de00' 
    4272 00014040     c000          JRUC    PCOLL0  
         00014050     00b0  
    4273                    
    4274                    **************************************************************************
    4275                    *                                                                        *
    4276                    * KNIFEHIT - CALL TO MAKE A PLAYER KNIFE HIT EFFECT                      *
    4277                    * A2 = PLINDX                                                            *
    4278                    *                                                                        *
    4279                    **************************************************************************
    4280 00014060           KNIFEHIT
    4281 00014060     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014070     d140  
    4282 00014080     0b62          CMPI    P1DATA,A2
         00014090 ffffffff! 
    4283 000140b0     cb07          JRNE    KNIFHIT2
    4284 000140c0     09c1          MOVI    P1PID|PDPID,A1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  106

         000140d0     01d0  
    4285 000140e0     09e7          MOVI    P1KNIFE,A7
         000140f0 0000e0c0' 
    4286 00014110     c000          JRUC    PCOLL0
         00014120     00a3  
    4287 00014130           KNIFHIT2
    4288 00014130     09c1          MOVI    P2PID|PDPID,A1
         00014140     02d0  
    4289 00014150     09e7          MOVI    P2KNIFE,A7
         00014160 0000e1b0' 
    4290 00014180     c000          JRUC    PCOLL0  
         00014190     009c  
    4291                    **************************************************************************
    4292                    *                                                                        *
    4293                    * BUGBITE - CALL TO BITE THE PLAYER                                      *
    4294                    * A0 = 32 BIT AMOUNT OF ENERGY TO TAKE AWAY [INTEGER,FRACTION]           *
    4295                    * A2 = PLINDX                                                            *
    4296                    *                                                                        *
    4297                    **************************************************************************
    4298 000141a0           BUGBITE
    4299 000141a0     098f          MMTM    SP,A0,A1,A3,A7,A9
         000141b0     d140  
    4300 000141c0     4c09          MOVE    A0,A9
    4301 000141d0     0b62          CMPI    P1DATA,A2
         000141e0 ffffffff! 
    4302 00014200     cb07          JRNE    BUGBITE2
    4303 00014210     09c1          MOVI    P1PID|PDPID,A1
         00014220     01d0  
    4304 00014230     09e7          MOVI    P1BUGGER,A7
         00014240 0000e2a0' 
    4305 00014260     c000          JRUC    PCOLL0
         00014270     008e  
    4306 00014280           BUGBITE2
    4307 00014280     09c1          MOVI    P2PID|PDPID,A1
         00014290     02d0  
    4308 000142a0     09e7          MOVI    P2BUGGER,A7
         000142b0 0000e370' 
    4309 000142d0     c000          JRUC    PCOLL0  
         000142e0     0087  
    4310                            
    4311                    *
    4312                    *PLAYER 1 HIT BY A HYPODERMIC NEEDLE
    4313                    *A0 = POINTER TO PLAYER OBJECT
    4314                    *A8 = PTR TO BULLET
    4315 000142f0           P1COLLHY
    4316 000142f0     09e2          MOVI    P1DATA,A2
         00014300 00000000! 
    4317 00014320     c003          JRUC    HYPOHIT
    4318                    *
    4319                    *PLAYER 2 HIT BY A HYPODERMIC NEEDLE
    4320                    *A0 = POINTER TO PLAYER OBJECT
    4321                    *A8 = PTR TO BULLET
    4322 00014330           P2COLLHY
    4323 00014330     09e2          MOVI    P2DATA,A2
         00014340 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  107

    4324                    **************************************************************************
    4325                    *                                                                        *
    4326                    * HYPOHIT - CALL TO MAKE A PLAYER HYPO EFFECT                            *
    4327                    * A2 = PLINDX                                                            *
    4328                    *                                                                        *
    4329                    **************************************************************************
    4330 00014360           HYPOHIT
    4331 00014360     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014370     d140  
    4332 00014380     0b62          CMPI    P1DATA,A2
         00014390 ffffffff! 
    4333 000143b0     cb06          JRNE    HYPOHIT2
    4334 000143c0     09c1          MOVI    P1PID|PDPID,A1
         000143d0     01d0  
    4335 000143e0     09e7          MOVI    P1HYPHIT,A7
         000143f0 0000da40' 
    4336 00014410     c074          JRUC    PCOLL0
    4337 00014420           HYPOHIT2
    4338 00014420     09c1          MOVI    P2PID|PDPID,A1
         00014430     02d0  
    4339 00014440     09e7          MOVI    P2HYPHIT,A7
         00014450 0000dac0' 
    4340 00014470     c06e          JRUC    PCOLL0  
    4341                    **************************************************************************
    4342                    *                                                                        *
    4343                    * PLAYER HIT BY EXPLOSION ROUTINES                                       *
    4344                    *                                                                        *
    4345                    **************************************************************************
    4346 00014480           PEXPL1
    4347 00014480     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014490     d140  
    4348 000144a0     09c1          MOVI    P1PID|PDPID,A1
         000144b0     01d0  
    4349 000144c0     09e2          MOVI    P1DATA,A2
         000144d0 00000000! 
    4350 000144f0     09e7          MOVI    P1EXPL,A7
         00014500 0000e440' 
    4351 00014520     c063          JRUC    PCOLL0
    4352                    
    4353 00014530           PEXPL2
    4354 00014530     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014540     d140  
    4355 00014550     09c1          MOVI    P2PID|PDPID,A1
         00014560     02d0  
    4356 00014570     09e2          MOVI    P2DATA,A2
         00014580 00000000! 
    4357 000145a0     09e7          MOVI    P2EXPL,A7
         000145b0 0000e500' 
    4358 000145d0     c058          JRUC    PCOLL0
    4359                    
    4360                    **************************************************************************
    4361                    *                                                                        *
    4362                    * PLAYER HIT BY ROCKET BOMB ROUTINES                                     *
    4363                    *                                                                        *
    4364                    **************************************************************************
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  108

    4365 000145e0           PROCK1
    4366 000145e0     098f          MMTM    SP,A0,A1,A3,A7,A9
         000145f0     d140  
    4367 00014600     09c1          MOVI    P1PID|PDPID,A1
         00014610     01d0  
    4368 00014620     09e2          MOVI    P1DATA,A2
         00014630 00000000! 
    4369 00014650     09e7          MOVI    P1ROCKER,A7
         00014660 0000e5c0' 
    4370 00014680     c04d          JRUC    PCOLL0
    4371                    
    4372 00014690           PROCK2
    4373 00014690     098f          MMTM    SP,A0,A1,A3,A7,A9
         000146a0     d140  
    4374 000146b0     09c1          MOVI    P2PID|PDPID,A1
         000146c0     02d0  
    4375 000146d0     09e2          MOVI    P2DATA,A2
         000146e0 00000000! 
    4376 00014700     09e7          MOVI    P2ROCKER,A7
         00014710 0000e680' 
    4377 00014730     c042          JRUC    PCOLL0
    4378                    
    4379                    **************************************************************************
    4380                    *                                                                        *
    4381                    * PLAYER HIT BY ROCKET BOMB ROUTINES                                     *
    4382                    *                                                                        *
    4383                    **************************************************************************
    4384 00014740           PCARHIT1
    4385 00014740     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014750     d140  
    4386 00014760     09c1          MOVI    P1PID|PDPID,A1
         00014770     01d0  
    4387 00014780     09e2          MOVI    P1DATA,A2
         00014790 00000000! 
    4388 000147b0     09e7          MOVI    P1CARHIT,A7
         000147c0 0000e740' 
    4389 000147e0     c037          JRUC    PCOLL0
    4390                    
    4391 000147f0           PCARHIT2
    4392 000147f0     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014800     d140  
    4393 00014810     09c1          MOVI    P2PID|PDPID,A1
         00014820     02d0  
    4394 00014830     09e2          MOVI    P2DATA,A2
         00014840 00000000! 
    4395 00014860     09e7          MOVI    P2CARHIT,A7
         00014870 0000e800' 
    4396 00014890     c02c          JRUC    PCOLL0
    4397                    
    4398                    **************************************************************************
    4399                    *                                                                        *
    4400                    * PLAYER HIT BY FLYING GARBAGE CAN ROUTINES                              *
    4401                    *                                                                        *
    4402                    **************************************************************************
    4403 000148a0           PGARBAGE1
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  109

    4404 000148a0     098f          MMTM    SP,A0,A1,A3,A7,A9
         000148b0     d140  
    4405 000148c0     09c1          MOVI    P1PID|PDPID,A1
         000148d0     01d0  
    4406 000148e0     09e2          MOVI    P1DATA,A2
         000148f0 00000000! 
    4407 00014910     09e7          MOVI    P1GARBAGE,A7
         00014920 0000e8c0' 
    4408 00014940     c021          JRUC    PCOLL0
    4409                    
    4410 00014950           PGARBAGE2
    4411 00014950     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014960     d140  
    4412 00014970     09c1          MOVI    P2PID|PDPID,A1
         00014980     02d0  
    4413 00014990     09e2          MOVI    P2DATA,A2
         000149a0 00000000! 
    4414 000149c0     09e7          MOVI    P2GARBAGE,A7
         000149d0 0000e9b0' 
    4415 000149f0     c016          JRUC    PCOLL0
    4416                    
    4417                    **************************************************************************
    4418                    *                                                                        *
    4419                    * PLAYER HIT BY FLYING DUMPSTER ROUTINES                                 *
    4420                    *                                                                        *
    4421                    **************************************************************************
    4422 00014a00           PDUMP1
    4423 00014a00     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014a10     d140  
    4424 00014a20     09c1          MOVI    P1PID|PDPID,A1
         00014a30     01d0  
    4425 00014a40     09e2          MOVI    P1DATA,A2
         00014a50 00000000! 
    4426 00014a70     09e7          MOVI    P1DUMP,A7
         00014a80 0000eaa0' 
    4427 00014aa0     c00b          JRUC    PCOLL0
    4428                    
    4429 00014ab0           PDUMP2
    4430 00014ab0     098f          MMTM    SP,A0,A1,A3,A7,A9
         00014ac0     d140  
    4431 00014ad0     09c1          MOVI    P2PID|PDPID,A1
         00014ae0     02d0  
    4432 00014af0     09e2          MOVI    P2DATA,A2
         00014b00 00000000! 
    4433 00014b20     09e7          MOVI    P2DUMP,A7
         00014b30 0000eb90' 
    4434 00014b50     0300          JRUC    PCOLL0
    4435                    
    4436                    **************************************************************************
    4437                    *                                                                        *
    4438                    * PCOLL0 - PLAYER COLLISION AS OBJECT 0                                  *
    4439                    *       ALL PLAYER HIT ROUTINES MUST USE THIS TO CREATE THE PROCESS      *
    4440                    * A1 = I.D. OF PROCESS TO CREATE                                         *
    4441                    * A2 = PTR TO PLAYER DATA STRUCTURE                                      *
    4442                    * A7 = ADDRESS OF PROCESS TO CREATE                                      *
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  110

    4443                    * A8 = PTR TO OBJECT THAT HIT PLAYER                                     *
    4444                    *                                                                        *
    4445                    **************************************************************************
    4446 00014b60           PCOLL0
    4447 00014b60     b643          MOVE    *A2(PFLAGS),A3,L
         00014b70     0080  
    4448 00014b80     1d63          BTST    BINVINC,A3
    4449 00014b90     cb09          JRNE    PCOLLX                  ;BR = THIS JOKER'S INVINCIBLE
    4450 00014ba0     0d5f          CALLA   GETPRC                  ;FIRE OFF THE PROCESS
         00014bb0 00000000! 
    4451 00014bd0     2e03          SRL     16,A3
    4452 00014be0     0ba3          ORI     MDHOLD,A3
         00014bf0 00000040  
    4453 00014c10     b062          MOVE    A3,*A2(PEXEFLAG),W      ;SET THIS TO ADD A WAIT
         00014c20     0090  
    4454 00014c30           PCOLLX
    4455 00014c30     5600          CLR     A0
    4456 00014c40     1020          INC     A0                      ;END SCAN
    4457 00014c50     09af          MMFM    SP,A0,A1,A3,A7,A9
         00014c60     028b  
    4458 00014c70     0960          RETS
    4459                    *
    4460                    *PLAYER IN CAR ANIMATIONS
    4461                    *
    4462                    *DRIVER HIT
    4463 00014c80           PDRIVHIT
    4464 00014c80 00000000!         .LONG   jtdrive4
    4465 00014ca0     000a          .WORD   10
    4466 00014cb0 00000000!         .LONG   jtdrive1
    4467 00014cd0     0007          .WORD   7
    4468 00014ce0 00000000          .LONG   0
    4469 00014d00           PPILOHIT
    4470 00014d00 00000000!         .LONG   jrpilohit
    4471 00014d20     000a          .WORD   10
    4472 00014d30 00000000!         .LONG   jrpilot
    4473 00014d50     0007          .WORD   7
    4474 00014d60 00000000          .LONG   0
    4475                    *
    4476                    *PASSENGER HIT
    4477 00014d80           PPASSHIT
    4478 00014d80 00000000!         .LONG   jtpassen4
    4479 00014da0     000a          .WORD   10
    4480 00014db0 00000000!         .LONG   jtpassen1
    4481 00014dd0     0007          .WORD   7
    4482 00014de0 00000000          .LONG   0
    4483                    
    4484 00014e00           PHELPHIT
    4485 00014e00 00000000!         .LONG   jrhelphit
    4486 00014e20     000a          .WORD   10
    4487 00014e30 00000000!         .LONG   jrhelpas
    4488 00014e50     0007          .WORD   7
    4489 00014e60 00000000          .LONG   0
    4490                    
    4491                    *
    4492                    *PLAYER ANIMATION SCRIPT OFFSET TABLE INDICES
TMS340 COFF Macro Assembler Version 6.10     Sat Apr 10 02:19:17 2021
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

 <<< N  A  R  C  -- PLAYER JOYSTICK & IMAGE CONTROL >>>              PAGE  111

    4493              0000  WALKFRM         .EQU    0       ;WALKING SCRIPT(S)
    4494              0001  SQTWFRM         .EQU    1       ;SQUAT WALK SCRIPT(S)
    4495              0002  JUMPFRM         .EQU    2       ;JUMPING SCRIPT(S)
    4496              0003  STANDLEG        .EQU    3       ;STANDING IN PLACE LEG SCRIPT(S)
    4497              0004  RESTORSO        .EQU    4       ;STANDING IN PLACE TORSO SCRIPT(S)
    4498              0005  SQUATLEG        .EQU    5       ;SQUATTING IN PLACE LEG SCRIPT(S)
    4499              0006  SQTORSO         .EQU    6       ;SQUATTING IN PLACE TORSO SCRIPT(S)
    4500              0007  SSLFRM          .EQU    7       ;STAND REST/FIRE LEGS
    4501              0008  SSTFRM          .EQU    8       ;STAND REST/FIRE TORSO
    4502              0009  SQLFRM          .EQU    9       ;SQUAT REST/FIRE LEGS
    4503              000a  SQTFRM          .EQU    10      ;SQUAT REST/FIRE TORSO
    4504              000b  SRBLFRM         .EQU    11      ;STAND REST/ROCKET LEGS
    4505              000c  SRBTFRM         .EQU    12      ;STAND REST/ROCKET TORSO
    4506              000d  SQRBLFRM        .EQU    13      ;SQUAT REST/ROCKET LEGS
    4507              000e  SQRBTFRM        .EQU    14      ;SQUAT REST/ROCKET TORSO
    4508              000f  DRIVLFRM        .EQU    15      ;DRIVING LEG FRAMES
    4509              0010  DRIVTFRM        .EQU    16      ;DRIVING TORSO FRAMES
    4510              0011  PASSLFRM        .EQU    17      ;PASSENGER LEG FRAMES
    4511              0012  PASSTFRM        .EQU    18      ;PASSENGER TORSO FRAMES
    4512              0013  DETHFRM         .EQU    19      ;DEATH SCRIPT(S)
    4513              0014  FRAGFRM         .EQU    20      ;FRAGMENT SCRIPT(S)
    4514              0015  DRIVFIRE        .EQU    21      ;DRIVER FIRING FRAMES
    4515              0016  PASSFIRE        .EQU    22      ;PASSENGER FIRING FRAMES
    4516              0017  JUMPINFR        .EQU    23      ;FRAMES FOR JUMPING INTO A CAR
    4517              0018  PILOTFRM        .EQU    24      ;PILOT LEG AND TORSO FRAMES
    4518              0019  HELPASFRM       .EQU    25      ;CHOPPER PASSENGER LEG AND TORSO FRAMES
    4519              001a  PILOTFIRE       .EQU    26      ;PILOT FIRING FRAMES
    4520              001b  HELPFIRE        .EQU    27      ;CHOPPER PASSENGER FIRING FRAMES
    4521              001c  HELJUMP         .EQU    28      ;CHOPPER JUMP IN FRAMES
    4522                    
    4523              0000  LRFRAME         .EQU    0
    4524              0001  UPFRAME         .EQU    1
    4525              0002  UPQFRAME        .EQU    2
    4526              0003  DNQFRAME        .EQU    3
    4527              0004  DNFRAME         .EQU    4
    4528              0005  TOFFSET         .EQU    5       ;OFFSET FROM LEG FRAMES, TO TORSO
    4529              0005  FOFFSET         .EQU    5       ;OFFSET FROM NORMAL TORSO TO FIRING TORSO
    4530              0005  RBOFFSET        .EQU    5       ;OFFSET FROM FIRING TORSO TO ROCKET BOMB TORSO
    4531              0005  JTOFFSET        .EQU    5       ;OFFSET FROM JUMPING LEGS, TO JUMPING TORSO
    4532              0005  JFOFFSET        .EQU    5       ;OFFSET FROM NORMAL JUMP TO FIRING JUMP
    4533                    
    4534                    
    4535                            .END

 No Errors,  No Warnings
